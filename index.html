<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduForge ERP - College Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Dark Mode Variables */
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f9fafb;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --border-color: #e5e7eb;
            --accent-color: #3b82f6;
        }
        
        [data-theme="dark"] {
            --bg-primary: #1f2937;
            --bg-secondary: #111827;
            --text-primary: #f9fafb;
            --text-secondary: #d1d5db;
            --border-color: #374151;
            --accent-color: #60a5fa;
        }
        
        /* Theme Transitions */
        * {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }
        
        body {
            background-color: var(--bg-secondary);
            color: var(--text-primary);
        }
        
        .bg-white { background-color: var(--bg-primary) !important; }
        .bg-gray-50 { background-color: var(--bg-secondary) !important; }
        .text-gray-900 { color: var(--text-primary) !important; }
        .text-gray-600, .text-gray-500 { color: var(--text-secondary) !important; }
        .border-gray-300 { border-color: var(--border-color) !important; }
        
        /* Mobile Responsive Enhancements */
        @media (max-width: 768px) {
            .grid-cols-4 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
            .grid-cols-3 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
            .text-4xl { font-size: 2rem; }
            .text-3xl { font-size: 1.5rem; }
            .px-4 { padding-left: 1rem; padding-right: 1rem; }
        }
        
        /* Advanced Animations */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .slide-up {
            animation: slideUp 0.6s ease-out;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .scale-in {
            animation: scaleIn 0.5s ease-out;
        }
        
        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .hover-lift {
            transition: transform 0.2s ease;
        }
        
        .hover-lift:hover {
            transform: translateY(-2px);
        }
        
        .btn-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .btn-gradient:hover {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
        }
        
        /* Blob Animation */
        @keyframes blob {
            0% {
                transform: translate(0px, 0px) scale(1);
            }
            33% {
                transform: translate(30px, -50px) scale(1.1);
            }
            66% {
                transform: translate(-20px, 20px) scale(0.9);
            }
            100% {
                transform: translate(0px, 0px) scale(1);
            }
        }
        
        .animate-blob {
            animation: blob 7s infinite;
        }
        
        .animation-delay-2000 {
            animation-delay: 2s;
        }
        
        .animation-delay-4000 {
            animation-delay: 4s;
        }
        
        /* Glassmorphism effect */
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        /* Gradient text */
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
        }
        
        /* Hover Effects */
        .hover-lift { transition: transform 0.2s ease; }
        .hover-lift:hover { transform: translateY(-2px); }
        
        /* Loading spinner */
        .spinner { 
            border: 4px solid #f3f3f3; 
            border-top: 4px solid #3498db; 
            border-radius: 50%; 
            width: 40px; 
            height: 40px; 
            animation: spin 2s linear infinite; 
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        /* Toast Notifications */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            min-width: 300px;
            padding: 16px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            animation: slideInRight 0.3s ease-out;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .toast-success { background: linear-gradient(135deg, #10b981, #059669); }
        .toast-error { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .toast-info { background: linear-gradient(135deg, #3b82f6, #2563eb); }
        .toast-warning { background: linear-gradient(135deg, #f59e0b, #d97706); }
        
        /* Advanced Buttons */
        .btn-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: all 0.3s ease;
        }
        .btn-gradient:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Navigation -->
    <nav class="bg-blue-600 text-white shadow-lg relative z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <i data-lucide="graduation-cap" class="h-8 w-8 mr-2"></i>
                    <span class="font-bold text-xl">EduForge ERP</span>
                </div>
                <div class="flex items-center space-x-4">
                    <!-- Notification Bell -->
                    <button onclick="toggleNotifications()" class="relative p-2 text-white hover:bg-blue-700 rounded-full transition-colors">
                        <i data-lucide="bell" class="h-5 w-5"></i>
                        <span id="notification-badge" class="absolute -top-1 -right-1 bg-red-500 text-xs rounded-full h-5 w-5 flex items-center justify-center hidden">3</span>
                    </button>
                    
                    <!-- Dark Mode Toggle -->
                    <button onclick="toggleDarkMode()" class="p-2 text-white hover:bg-blue-700 rounded-full transition-colors">
                        <i data-lucide="moon" id="theme-icon" class="h-5 w-5"></i>
                    </button>
                    
                    <!-- User Info -->
                    <span id="user-info" class="hidden text-sm"></span>
                    
                    <!-- Auth Button -->
                    <button id="auth-btn" onclick="quickLogin('admin')" class="bg-blue-700 hover:bg-blue-800 px-4 py-2 rounded-md text-sm font-medium transition-all hover-lift">
                        Login
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Notification Center -->
    <div id="notification-center" class="hidden fixed top-16 right-4 w-80 bg-white dark:bg-gray-800 rounded-lg shadow-xl z-50 border border-gray-200 dark:border-gray-700 scale-in">
        <div class="p-4 border-b border-gray-200 dark:border-gray-700">
            <div class="flex justify-between items-center">
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Notifications</h3>
                <button onclick="markAllNotificationsRead()" class="text-sm text-blue-600 hover:text-blue-800">Mark all read</button>
            </div>
        </div>
        <div class="max-h-96 overflow-y-auto">
            <div id="notification-list">
                <div class="p-4 border-b border-gray-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <div class="flex items-start space-x-3">
                        <div class="flex-shrink-0">
                            <div class="w-2 h-2 bg-blue-500 rounded-full mt-2"></div>
                        </div>
                        <div class="flex-1">
                            <p class="text-sm font-medium text-gray-900 dark:text-white">New exam scheduled</p>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Data Structures exam on April 15, 2024</p>
                            <p class="text-xs text-gray-400 dark:text-gray-500 mt-1">2 hours ago</p>
                        </div>
                    </div>
                </div>
                <div class="p-4 border-b border-gray-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <div class="flex items-start space-x-3">
                        <div class="flex-shrink-0">
                            <div class="w-2 h-2 bg-green-500 rounded-full mt-2"></div>
                        </div>
                        <div class="flex-1">
                            <p class="text-sm font-medium text-gray-900 dark:text-white">Fee payment received</p>
                            <p class="text-sm text-gray-500 dark:text-gray-400">₹80,000 payment processed successfully</p>
                            <p class="text-xs text-gray-400 dark:text-gray-500 mt-1">5 hours ago</p>
                        </div>
                    </div>
                </div>
                <div class="p-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <div class="flex items-start space-x-3">
                        <div class="flex-shrink-0">
                            <div class="w-2 h-2 bg-purple-500 rounded-full mt-2"></div>
                        </div>
                        <div class="flex-1">
                            <p class="text-sm font-medium text-gray-900 dark:text-white">New student registered</p>
                            <p class="text-sm text-gray-500 dark:text-gray-400">John Doe has completed admission</p>
                            <p class="text-xs text-gray-400 dark:text-gray-500 mt-1">1 day ago</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="p-4 border-t border-gray-200 dark:border-gray-700">
            <button class="w-full text-center text-sm text-blue-600 hover:text-blue-800 font-medium">View all notifications</button>
        </div>
    </div>

    <!-- Main Content -->
    <main class="w-full">
        <!-- Landing Page -->
        <div id="landing-page" class="h-screen w-screen relative overflow-hidden fixed top-0 left-0 z-40">
            <!-- Animated Background - Dark Mode -->
            <div class="absolute inset-0 bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 dark:from-blue-900 dark:via-purple-900 dark:to-indigo-900">
                <div class="absolute inset-0 bg-black opacity-50 dark:opacity-50"></div>
                <!-- Floating Elements -->
                <div class="absolute top-20 left-10 w-72 h-72 bg-blue-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob"></div>
                <div class="absolute top-40 right-10 w-72 h-72 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-2000"></div>
                <div class="absolute -bottom-8 left-20 w-72 h-72 bg-pink-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-4000"></div>
            </div>
            
            <!-- Light Mode Background -->
            <div class="absolute inset-0 bg-gradient-to-br from-blue-50 via-purple-50 to-indigo-50 dark:hidden">
                <div class="absolute inset-0 bg-white opacity-80"></div>
                <!-- Light Mode Floating Elements -->
                <div class="absolute top-20 left-10 w-72 h-72 bg-blue-200 rounded-full mix-blend-multiply filter blur-xl opacity-60 animate-blob"></div>
                <div class="absolute top-40 right-10 w-72 h-72 bg-purple-200 rounded-full mix-blend-multiply filter blur-xl opacity-60 animate-blob animation-delay-2000"></div>
                <div class="absolute -bottom-8 left-20 w-72 h-72 bg-pink-200 rounded-full mix-blend-multiply filter blur-xl opacity-60 animate-blob animation-delay-4000"></div>
            </div>
            
            <!-- Landing Page Header -->
            <div class="absolute top-0 left-0 right-0 z-20 bg-transparent">
                <div class="flex justify-between items-center p-6">
                    <!-- Logo -->
                    <div class="flex items-center">
                        <i data-lucide="graduation-cap" class="h-8 w-8 text-white dark:text-gray-900 mr-3"></i>
                        <span class="text-2xl font-bold text-white dark:text-gray-900">EduForge ERP</span>
                    </div>
                    
                    <!-- Quick Login Button -->
                    <button onclick="quickLogin('admin')" class="bg-white bg-opacity-20 dark:bg-gray-900 dark:bg-opacity-20 backdrop-blur-lg hover:bg-opacity-30 dark:hover:bg-opacity-30 text-white dark:text-gray-900 px-6 py-2 rounded-lg font-medium transition-all border border-white border-opacity-30 dark:border-gray-900 dark:border-opacity-30">
                        Quick Demo
                    </button>
                </div>
            </div>
            
            <!-- Content -->
            <div class="relative z-10 flex items-center justify-center min-h-screen px-4">
                <div class="max-w-6xl mx-auto">
                    <!-- Hero Section -->
                    <div class="text-center mb-16">
                        <div class="mb-8">
                            <div class="inline-flex items-center justify-center w-20 h-20 bg-blue-600 bg-opacity-20 dark:bg-white dark:bg-opacity-20 backdrop-blur-lg rounded-full mb-6 animate-pulse border border-blue-300 dark:border-white dark:border-opacity-30">
                                <i data-lucide="graduation-cap" class="h-10 w-10 text-blue-700 dark:text-white"></i>
                            </div>
                        </div>
                        <h1 class="text-6xl md:text-7xl font-bold text-gray-900 dark:text-white mb-6 leading-tight">
                            <span class="bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 dark:from-blue-400 dark:via-purple-400 dark:to-pink-400 bg-clip-text text-transparent">
                                EduForge
                            </span>
                            <br>
                            <span class="text-4xl md:text-5xl text-gray-700 dark:text-gray-200">ERP System</span>
                        </h1>
                        <p class="text-xl md:text-2xl text-gray-700 dark:text-gray-300 mb-4 max-w-3xl mx-auto leading-relaxed">
                            Transform your educational institution with our comprehensive management platform
                        </p>
                        <p class="text-lg text-gray-600 dark:text-gray-400 mb-12">
                            Streamline admissions, academics, finance, and administration in one powerful solution
                        </p>
                    </div>
                    
                    <!-- Login Cards -->
                    <div class="grid md:grid-cols-3 gap-8 max-w-4xl mx-auto">
                        <!-- Student Portal -->
                        <div class="group cursor-pointer" onclick="showLogin('student')">
                            <div class="bg-white/95 dark:bg-gray-900/95 backdrop-blur-lg rounded-2xl p-8 border border-gray-200 dark:border-gray-700 hover:shadow-2xl transition-all duration-300 transform hover:scale-[1.02]">
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform duration-300">
                                        <i data-lucide="user" class="h-8 w-8 text-white"></i>
                                    </div>
                                    <h3 class="text-2xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-white dark:to-gray-200 bg-clip-text text-transparent mb-3">Student Portal</h3>
                                    <p class="text-gray-600 dark:text-gray-300 mb-6 text-sm">
                                        Access your academic records, fees, results, and more
                                    </p>
                                    <div class="bg-blue-100 dark:bg-blue-500 dark:bg-opacity-20 rounded-lg p-3 mb-4 border border-blue-200 dark:border-blue-400 dark:border-opacity-30">
                                        <p class="text-blue-800 dark:text-blue-200 text-xs font-semibold">Quick Demo Login</p>
                                        <p class="text-blue-700 dark:text-blue-100 font-mono text-sm font-medium">student@eduforge.com</p>
                                    </div>
                                    <div class="flex items-center justify-center text-blue-700 dark:text-blue-300 group-hover:text-blue-800 dark:group-hover:text-blue-200 transition-colors font-semibold">
                                        <span class="mr-2 text-gray-800 dark:text-white">Enter Portal</span>
                                        <i data-lucide="arrow-right" class="h-4 w-4 group-hover:translate-x-1 transition-transform"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Staff Portal -->
                        <div class="group cursor-pointer" onclick="showLogin('staff')">
                            <div class="bg-white/95 dark:bg-gray-900/95 backdrop-blur-lg rounded-2xl p-8 border border-gray-200 dark:border-gray-700 hover:shadow-2xl transition-all duration-300 transform hover:scale-[1.02]">
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-gradient-to-br from-green-400 to-green-600 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform duration-300">
                                        <i data-lucide="users" class="h-8 w-8 text-white"></i>
                                    </div>
                                    <h3 class="text-2xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-white dark:to-gray-200 bg-clip-text text-transparent mb-3">Staff Portal</h3>
                                    <p class="text-gray-600 dark:text-gray-300 mb-6 text-sm">
                                        Manage classes, students, exams, and academic activities
                                    </p>
                                    <div class="bg-green-100 dark:bg-green-500 dark:bg-opacity-20 rounded-lg p-3 mb-4 border border-green-200 dark:border-green-400 dark:border-opacity-30">
                                        <p class="text-green-700 dark:text-green-200 text-xs font-semibold">Quick Demo Login</p>
                                        <p class="text-green-600 dark:text-green-100 font-mono text-sm font-medium">staff@eduforge.com</p>
                                    </div>
                                    <div class="flex items-center justify-center text-green-700 dark:text-green-300 group-hover:text-green-800 dark:group-hover:text-green-200 transition-colors font-semibold">
                                        <span class="mr-2 text-gray-800 dark:text-white">Enter Portal</span>
                                        <i data-lucide="arrow-right" class="h-4 w-4 group-hover:translate-x-1 transition-transform"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Admin Portal -->
                        <div class="group cursor-pointer" onclick="showLogin('admin')">
                            <div class="bg-white/95 dark:bg-gray-900/95 backdrop-blur-lg rounded-2xl p-8 border border-gray-200 dark:border-gray-700 hover:shadow-2xl transition-all duration-300 transform hover:scale-[1.02]">
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-gradient-to-br from-purple-400 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform duration-300">
                                        <i data-lucide="shield" class="h-8 w-8 text-white"></i>
                                    </div>
                                    <h3 class="text-2xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-white dark:to-gray-200 bg-clip-text text-transparent mb-3">Admin Portal</h3>
                                    <p class="text-gray-600 dark:text-gray-300 mb-6 text-sm">
                                        Complete system control, analytics, and management
                                    </p>
                                    <div class="bg-purple-100 dark:bg-purple-500 dark:bg-opacity-20 rounded-lg p-3 mb-4 border border-purple-200 dark:border-purple-400 dark:border-opacity-30">
                                        <p class="text-purple-700 dark:text-purple-200 text-xs font-semibold">Quick Demo Login</p>
                                        <p class="text-purple-600 dark:text-purple-100 font-mono text-sm font-medium">admin@eduforge.com</p>
                                    </div>
                                    <div class="flex items-center justify-center text-purple-700 dark:text-purple-300 group-hover:text-purple-800 dark:group-hover:text-purple-200 transition-colors font-semibold">
                                        <span class="mr-2 text-gray-800 dark:text-white">Enter Portal</span>
                                        <i data-lucide="arrow-right" class="h-4 w-4 group-hover:translate-x-1 transition-transform"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Features Preview -->
                    <div class="mt-20 text-center">
                        <div class="grid md:grid-cols-4 gap-8 max-w-4xl mx-auto">
                            <div class="text-center">
                                <div class="w-16 h-16 bg-gradient-to-br from-blue-600 to-blue-700 dark:from-blue-700 dark:to-blue-800 rounded-xl flex items-center justify-center mx-auto mb-4 shadow-lg">
                                    <i data-lucide="users" class="h-7 w-7 text-white"></i>
                                </div>
                                <h4 class="text-xl font-bold text-gray-800 dark:text-white mb-3">Student Management</h4>
                                <p class="text-gray-800 dark:text-gray-100 text-sm leading-relaxed">Complete student lifecycle management</p>
                            </div>
                            <div class="text-center">
                                <div class="w-14 h-14 bg-gradient-to-br from-green-500 to-green-600 dark:from-green-600 dark:to-green-700 rounded-xl flex items-center justify-center mx-auto mb-4 shadow-md">
                                    <i data-lucide="credit-card" class="h-6 w-6 text-white"></i>
                                </div>
                                <h4 class="text-xl font-bold text-gray-800 dark:text-white mb-3">Fee Management</h4>
                                <p class="text-gray-700 dark:text-gray-300 text-sm leading-relaxed">Automated fee collection and tracking</p>
                            </div>
                            <div class="text-center">
                                <div class="w-14 h-14 bg-gradient-to-br from-purple-500 to-purple-600 dark:from-purple-600 dark:to-purple-700 rounded-xl flex items-center justify-center mx-auto mb-4 shadow-md">
                                    <i data-lucide="bar-chart" class="h-6 w-6 text-white"></i>
                                </div>
                                <h4 class="text-xl font-bold text-gray-800 dark:text-white mb-3">Analytics</h4>
                                <p class="text-gray-700 dark:text-gray-300 text-sm leading-relaxed">Comprehensive reports and insights</p>
                            </div>
                            <div class="text-center">
                                <div class="w-14 h-14 bg-gradient-to-br from-amber-500 to-amber-600 dark:from-amber-600 dark:to-amber-700 rounded-xl flex items-center justify-center mx-auto mb-4 shadow-md">
                                    <i data-lucide="settings" class="h-6 w-6 text-white"></i>
                                </div>
                                <h4 class="text-xl font-bold text-gray-800 dark:text-white mb-3">Administration</h4>
                                <p class="text-gray-700 dark:text-gray-300 text-sm leading-relaxed">Complete system configuration</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Login Modal -->
        <div id="login-modal" class="hidden fixed inset-0 bg-black/60 dark:bg-black/70 backdrop-blur-sm overflow-y-auto h-screen w-full z-50 flex items-center justify-center p-4 sm:p-6" aria-modal="true" role="dialog" aria-labelledby="login-title">
            <div class="relative w-full max-w-4xl h-[90vh] max-h-[800px] flex flex-col sm:flex-row bg-white dark:bg-gray-900 rounded-2xl shadow-xl overflow-hidden">
                <!-- Left Side - Branding/Image -->
                <div class="hidden sm:flex flex-1 bg-gradient-to-br from-blue-600 to-purple-600 p-8 flex-col justify-between">
                    <div class="flex items-center">
                        <i data-lucide="graduation-cap" class="h-8 w-8 text-white mr-3"></i>
                        <span class="text-2xl font-bold text-white">EduForge ERP</span>
                    </div>
                    <div class="mt-8">
                        <h2 class="text-3xl font-bold text-white mb-4">Welcome Back!</h2>
                        <p class="text-blue-100">Streamline your educational institution's management with our comprehensive ERP solution.</p>
                    </div>
                    <div class="grid grid-cols-2 gap-4 mt-8">
                        <div class="bg-white/10 backdrop-blur-sm p-4 rounded-lg">
                            <i data-lucide="users" class="h-6 w-6 text-white mb-2"></i>
                            <p class="text-sm text-white font-medium">Student Management</p>
                        </div>
                        <div class="bg-white/10 backdrop-blur-sm p-4 rounded-lg">
                            <i data-lucide="book-open" class="h-6 w-6 text-white mb-2"></i>
                            <p class="text-sm text-white font-medium">Course Management</p>
                        </div>
                    </div>
                </div>
                
                <!-- Right Side - Login Form -->
                <div class="flex-1 overflow-y-auto p-6 sm:p-8">
                    <!-- Close Button -->
                    <button onclick="closeLogin()" class="absolute top-4 right-4 p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors z-10" aria-label="Close login">
                        <i data-lucide="x" class="h-5 w-5"></i>
                    </button>
                    
                    <!-- Header -->
                    <div class="pb-6">
                        <div class="text-center mb-8">
                            <div class="w-16 h-16 bg-gradient-to-br from-blue-600 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg">
                                <i data-lucide="shield" class="h-7 w-7 text-white"></i>
                            </div>
                            <h3 id="login-title" class="text-2xl font-bold text-gray-900 dark:text-white mb-2">Welcome Back</h3>
                            <p class="text-gray-600 dark:text-gray-300 text-sm">Sign in to access your account</p>
                        </div>
                        
                        <!-- Form -->
                        <form id="login-form" class="space-y-5">
                            <!-- Email Field -->
                            <div>
                                <label for="email" class="block text-sm font-medium text-gray-900 dark:text-gray-200 mb-1.5">Email Address</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                        <i data-lucide="mail" class="h-4 w-4 text-gray-500 dark:text-gray-400"></i>
                                    </div>
                                    <input type="email" id="email" name="email" required autocomplete="email"
                                           class="block w-full pl-10 pr-3 py-2.5 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm transition-all"
                                           placeholder="you@example.com"
                                           aria-describedby="email-error">
                                </div>
                                <p id="email-error" class="mt-1 text-sm text-red-600 dark:text-red-400 hidden"></p>
                            </div>
                            
                            <!-- Password Field -->
                            <div>
                                <div class="flex items-center justify-between mb-1.5">
                                    <label for="password" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Password</label>
                                    <a href="#" class="text-xs font-medium text-blue-700 hover:text-blue-600 dark:text-blue-300 dark:hover:text-blue-200 transition-colors">
                                        Forgot password?
                                    </a>
                                </div>
                                <div class="relative">
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                        <i data-lucide="lock" class="h-4 w-4 text-gray-400"></i>
                                    </div>
                                    <div class="relative">
                                    
                                    
                                    
                                        <input type="password" id="password" name="password" required autocomplete="current-password"
                                               class="block w-full pl-10 pr-10 py-2.5 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg text-gray-900 dark:text-gray-100 placeholder-gray-600 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm transition-all"
                                               placeholder="••••••••"
                                               aria-describedby="password-error">
                                        <button type="button" id="toggle-password" class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400" aria-label="Toggle password visibility">
                                            <i data-lucide="eye" class="h-4 w-4" id="password-icon"></i>
                                        </button>
                                    </div>
                                    <p id="password-error" class="mt-1 text-sm text-red-600 dark:text-red-400 hidden"></p>
                                </div>
                            </div>
                            
                            <!-- Remember Me & Demo Credentials -->
                            <div class="space-y-4">
                                <div class="flex items-center">
                                    <input id="remember-me" name="remember-me" type="checkbox" 
                                           class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 dark:border-gray-500 dark:bg-gray-700 dark:ring-offset-gray-900">
                                    <label for="remember-me" class="ml-2 block text-sm font-semibold text-gray-900 dark:text-gray-100">
                                        Remember me
                                    </label>
                                </div>
                                
                                <!-- Demo Credentials -->
                                <div id="demo-credentials" class="rounded-lg border border-gray-200 bg-white p-4 shadow-sm dark:border-blue-800/50 dark:bg-gray-800">
                                    <h4 class="mb-3 text-sm font-semibold text-blue-800 dark:text-blue-200">Demo Credentials</h4>
                                    <div class="space-y-2.5 text-sm">
                                        <div class="flex items-center justify-between rounded-md bg-white px-3 py-2.5 dark:bg-gray-800 shadow-sm border border-gray-200 dark:border-gray-700">
                                            <div class="flex items-center">
                                                <i data-lucide="mail" class="mr-2 h-4 w-4 text-blue-600 dark:text-blue-400"></i>
                                                <span id="demo-email" class="font-mono font-medium text-blue-600 dark:text-blue-400">admin@eduforge.com</span>
                                            </div>
                                            <button type="button" onclick="copyToClipboard('demo-email')" class="ml-2 rounded p-1 text-blue-600 hover:bg-blue-100 hover:text-blue-700 dark:text-blue-400 dark:hover:bg-gray-600 dark:hover:text-blue-300 transition-colors" aria-label="Copy email">
                                                <i data-lucide="copy" class="h-3.5 w-3.5"></i>
                                            </button>
                                        </div>
                                        <div class="flex items-center justify-between rounded-md bg-white px-3 py-2.5 dark:bg-gray-800 shadow-sm border border-gray-200 dark:border-gray-700">
                                            <div class="flex items-center">
                                                <i data-lucide="key" class="mr-2 h-4 w-4 text-blue-600 dark:text-blue-400"></i>
                                                <span id="demo-password" class="font-mono font-medium text-blue-600 dark:text-blue-400">••••••••</span>
                                            </div>
                                            <div class="flex items-center">
                                                <button type="button" onclick="togglePasswordVisibility()" class="rounded p-1 text-blue-600 hover:bg-blue-100 hover:text-blue-700 dark:text-blue-400 dark:hover:bg-gray-600 dark:hover:text-blue-300 transition-colors" aria-label="Reveal password">
                                                    <i data-lucide="eye" class="h-3.5 w-3.5"></i>
                                                </button>
                                                <button type="button" onclick="copyToClipboard('demo-password')" class="ml-1 rounded p-1 text-blue-600 hover:bg-blue-100 hover:text-blue-700 dark:text-blue-400 dark:hover:bg-gray-600 dark:hover:text-blue-300 transition-colors" aria-label="Copy password">
                                                    <i data-lucide="copy" class="h-3.5 w-3.5"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Submit Button -->
                            <div>
                                <button type="submit" id="login-button" class="group relative w-full flex justify-center py-2.5 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all shadow-md">
                                    <span class="flex items-center">
                                        <span id="login-text">Sign in</span>
                                        <span id="login-spinner" class="ml-2 hidden">
                                            <svg class="animate-spin h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                            </svg>
                                        </span>
                                    </span>
                                </button>
                            </div>
                        </form>
                        
                        <!-- Quick Login Buttons -->
                        <div class="mt-6 pt-5 border-t border-gray-200 dark:border-gray-700">
                            <div class="relative mt-6">
                                <div class="absolute inset-0 flex items-center">
                                    <div class="w-full border-t border-gray-200 dark:border-gray-700"></div>
                                </div>
                                <div class="relative flex justify-center">
                                    <span class="px-3 bg-white dark:bg-gray-800 text-xs font-medium text-gray-500 dark:text-gray-400">Or continue with</span>
                                </div>
                            </div>
                            
                            <div class="mt-5 grid grid-cols-3 gap-3">
                                <button type="button" onclick="quickLogin('student')" class="group inline-flex w-full items-center justify-center rounded-lg border border-blue-600 bg-blue-600 px-4 py-2.5 text-sm font-semibold text-white shadow-sm transition-all hover:bg-blue-700 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:border-blue-600 dark:bg-blue-600 dark:text-white dark:hover:bg-blue-700">
                                    <i data-lucide="user" class="mr-2 h-4 w-4 text-white group-hover:text-white dark:text-white"></i>
                                    <span class="text-white">Student</span>
                                </button>
                                <button type="button" onclick="quickLogin('staff')" class="group inline-flex w-full items-center justify-center rounded-lg border border-green-600 bg-green-600 px-4 py-2.5 text-sm font-semibold text-white shadow-sm transition-all hover:bg-green-700 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 dark:border-green-600 dark:bg-green-600 dark:text-white dark:hover:bg-green-700">
                                    <i data-lucide="users" class="mr-2 h-4 w-4 text-white group-hover:text-white dark:text-white"></i>
                                    <span class="text-white">Staff</span>
                                </button>
                                <button type="button" onclick="quickLogin('admin')" class="group inline-flex w-full items-center justify-center rounded-lg border border-pink-600 bg-pink-600 px-4 py-2.5 text-sm font-semibold text-white shadow-sm transition-all hover:bg-pink-700 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-offset-2 dark:border-pink-600 dark:bg-pink-600 dark:text-white dark:hover:bg-pink-700">
                                    <i data-lucide="shield" class="mr-2 h-4 w-4 text-white group-hover:text-white dark:text-white"></i>
                                    <span class="text-white">Admin</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dashboard Content -->
        <div id="dashboard-content" class="hidden max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
            <!-- Content loaded dynamically -->
        </div>
    </main>

    <script>
        // Step 1: Proper authentication system
        let currentUser = null;
        let currentRole = null;
        let selectedPortal = null;
        
        // Fee Payment Tracking System
        let feePayments = [
            {
                id: 'TXN1729845600000',
                studentId: 'ADM2024001',
                studentName: 'John Smith',
                amount: 80000,
                date: '2024-10-25',
                time: '14:30',
                method: 'Credit Card',
                status: 'Completed',
                semester: 'Fall 2024'
            },
            {
                id: 'TXN1729759200000',
                studentId: 'ADM2024002',
                studentName: 'Emma Miller',
                amount: 75000,
                date: '2024-10-24',
                time: '11:15',
                method: 'Bank Transfer',
                status: 'Completed',
                semester: 'Fall 2024'
            }
        ];
        
        // Demo users database
        const demoUsers = [
            { email: 'admin@eduforge.com', password: 'admin123', role: 'admin' },
            { email: 'staff@eduforge.com', password: 'staff123', role: 'staff' },
            { email: 'student@eduforge.com', password: 'student123', role: 'student' }
        ];
        
        function showLogin(portal) {
            selectedPortal = portal;
            document.getElementById('login-title').textContent = `${portal.charAt(0).toUpperCase() + portal.slice(1)} Portal`;
            
            // Update demo credentials based on portal
            const demoCredentials = {
                'admin': { email: 'admin@eduforge.com', password: 'admin123' },
                'staff': { email: 'staff@eduforge.com', password: 'staff123' },
                'student': { email: 'student@eduforge.com', password: 'student123' }
            };
            
            const creds = demoCredentials[portal];
            document.getElementById('demo-email').textContent = creds.email;
            document.getElementById('demo-password').textContent = creds.password;
            
            document.getElementById('login-modal').classList.remove('hidden');
            
            // Initialize icons for the modal
            setTimeout(() => {
                lucide.createIcons();
            }, 100);
        }
        
        function closeLogin() {
            document.getElementById('login-modal').classList.add('hidden');
            document.getElementById('login-form').reset();
        }
        
        // Handle login form submission
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('login-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                
                // Find user in demo database
                const user = demoUsers.find(u => u.email === email && u.password === password);
                
                if (!user) {
                    alert('❌ Invalid email or password!');
                    return;
                }
                
                // Check if user role matches selected portal
                if (user.role !== selectedPortal) {
                    alert(`❌ Access denied! This account is not authorized for ${selectedPortal} portal. Please use the ${user.role} portal.`);
                    return;
                }
                
                // Successful login
                currentUser = user;
                currentRole = user.role;
                
                closeLogin();
                showDashboard(user.role);
                updateNavigation();
                
                alert(`✅ Login successful! Welcome to ${user.role.toUpperCase()} Portal`);
            });
        });
        
        function updateNavigation() {
            document.getElementById('landing-page').classList.add('hidden');
            document.getElementById('dashboard-content').classList.remove('hidden');
            document.getElementById('auth-btn').textContent = 'Logout';
            document.getElementById('auth-btn').onclick = logout;
            document.getElementById('user-info').textContent = `${currentRole.toUpperCase()} Portal - ${currentUser.email}`;
            document.getElementById('user-info').classList.remove('hidden');
            
            // Show notification badge
            document.getElementById('notification-badge').classList.remove('hidden');
            
            // Welcome toast
            showToast(`Welcome to ${currentRole.toUpperCase()} Portal!`, 'success');
        }
        
        function logout() {
            currentUser = null;
            currentRole = null;
            selectedPortal = null;
            document.getElementById('landing-page').classList.remove('hidden');
            document.getElementById('dashboard-content').classList.add('hidden');
            document.getElementById('auth-btn').textContent = 'Login';
            document.getElementById('auth-btn').onclick = () => quickLogin('admin');
            document.getElementById('user-info').classList.add('hidden');
            alert('✅ Logged out successfully!');
        }
        
        function quickLogin(role) {
            if (currentUser) {
                logout();
                return;
            }
            
            // Quick login with demo credentials
            const demoCredentials = {
                'admin': { email: 'admin@eduforge.com', password: 'admin123', role: 'admin' },
                'staff': { email: 'staff@eduforge.com', password: 'staff123', role: 'staff' },
                'student': { email: 'student@eduforge.com', password: 'student123', role: 'student' }
            };
            
            const user = demoCredentials[role];
            if (user) {
                currentUser = user;
                currentRole = user.role;
                selectedPortal = user.role;
                
                showDashboard(user.role);
                updateNavigation();
                
                showToast(`Quick login successful! Welcome to ${user.role.toUpperCase()} Portal`, 'success');
            }
        }
        
        function showDashboard(role) {
            // Hide landing page and show dashboard
            document.getElementById('landing-page').classList.add('hidden');
            const dashboardContent = document.getElementById('dashboard-content');
            dashboardContent.classList.remove('hidden');
            
            if (role === 'admin') {
                dashboardContent.innerHTML = `
                    <div class="px-4 py-6 sm:px-0 fade-in">
                        <!-- Welcome Header -->
                        <div class="bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 rounded-xl p-8 mb-8 text-white slide-up">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h1 class="text-4xl font-bold mb-2">Welcome Back, Admin! 👋</h1>
                                    <p class="text-blue-100 text-lg">Here's what's happening at EduForge today</p>
                                </div>
                                <div class="hidden md:block">
                                    <div class="w-24 h-24 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                                        <i data-lucide="crown" class="h-12 w-12 text-yellow-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Quick Stats -->
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                            <div class="bg-white overflow-hidden shadow-lg rounded-xl hover:shadow-xl transition-all duration-300 hover-lift bounce-in">
                                <div class="p-6">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0">
                                            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                                <i data-lucide="users" class="h-6 w-6 text-blue-600"></i>
                                            </div>
                                        </div>
                                        <div class="ml-4 flex-1">
                                            <p class="text-sm font-medium text-gray-500">Total Students</p>
                                            <p class="text-2xl font-bold text-gray-900">1,234</p>
                                            <p class="text-xs text-green-600 flex items-center mt-1">
                                                <i data-lucide="trending-up" class="h-3 w-3 mr-1"></i>
                                                +12% from last month
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white overflow-hidden shadow-lg rounded-xl hover:shadow-xl transition-all duration-300 hover-lift bounce-in" style="animation-delay: 0.1s">
                                <div class="p-6">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0">
                                            <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                                <i data-lucide="indian-rupee" class="h-6 w-6 text-green-600"></i>
                                            </div>
                                        </div>
                                        <div class="ml-4 flex-1">
                                            <p class="text-sm font-medium text-gray-500">Fee Collection</p>
                                            <p class="text-2xl font-bold text-gray-900">₹98.7L</p>
                                            <p class="text-xs text-green-600 flex items-center mt-1">
                                                <i data-lucide="trending-up" class="h-3 w-3 mr-1"></i>
                                                +18% this quarter
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white overflow-hidden shadow-lg rounded-xl hover:shadow-xl transition-all duration-300 hover-lift bounce-in" style="animation-delay: 0.2s">
                                <div class="p-6">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0">
                                            <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                                <i data-lucide="user-check" class="h-6 w-6 text-purple-600"></i>
                                            </div>
                                        </div>
                                        <div class="ml-4 flex-1">
                                            <p class="text-sm font-medium text-gray-500">Active Staff</p>
                                            <p class="text-2xl font-bold text-gray-900">87</p>
                                            <p class="text-xs text-blue-600 flex items-center mt-1">
                                                <i data-lucide="users" class="h-3 w-3 mr-1"></i>
                                                +3 new this week
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white overflow-hidden shadow-lg rounded-xl hover:shadow-xl transition-all duration-300 hover-lift bounce-in" style="animation-delay: 0.3s">
                                <div class="p-6">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0">
                                            <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center">
                                                <i data-lucide="book-open" class="h-6 w-6 text-orange-600"></i>
                                            </div>
                                        </div>
                                        <div class="ml-4 flex-1">
                                            <p class="text-sm font-medium text-gray-500">Total Courses</p>
                                            <p class="text-2xl font-bold text-gray-900">24</p>
                                            <p class="text-xs text-purple-600 flex items-center mt-1">
                                                <i data-lucide="layers" class="h-3 w-3 mr-1"></i>
                                                4 departments
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Quick Actions -->
                        <div class="mb-8">
                            <h2 class="text-2xl font-bold text-gray-900 mb-6">Quick Actions</h2>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6">
                                <button onclick="showStudentManagement()" class="group bg-gradient-to-br from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white p-6 rounded-xl text-left transition-all duration-300 hover-lift scale-in">
                                    <div class="flex items-center justify-between mb-4">
                                        <i data-lucide="users" class="h-8 w-8"></i>
                                        <i data-lucide="arrow-right" class="h-5 w-5 opacity-0 group-hover:opacity-100 transition-opacity"></i>
                                    </div>
                                    <h3 class="text-lg font-semibold mb-2">Student Management</h3>
                                    <p class="text-sm text-blue-100">Manage student records, admissions, and profiles</p>
                                </button>
                                
                                <button onclick="showTimetableManagement()" class="group bg-gradient-to-br from-indigo-500 to-indigo-600 hover:from-indigo-600 hover:to-indigo-700 text-white p-6 rounded-xl text-left transition-all duration-300 hover-lift scale-in" style="animation-delay: 0.1s">
                                    <div class="flex items-center justify-between mb-4">
                                        <i data-lucide="calendar-clock" class="h-8 w-8"></i>
                                        <i data-lucide="arrow-right" class="h-5 w-5 opacity-0 group-hover:opacity-100 transition-opacity"></i>
                                    </div>
                                    <h3 class="text-lg font-semibold mb-2">Smart Timetable</h3>
                                    <p class="text-sm text-indigo-100">AI-powered scheduling with conflict resolution</p>
                                </button>
                                
                                <button onclick="showUserManagement()" class="group bg-gradient-to-br from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white p-6 rounded-xl text-left transition-all duration-300 hover-lift scale-in" style="animation-delay: 0.2s">
                                    <div class="flex items-center justify-between mb-4">
                                        <i data-lucide="user-check" class="h-8 w-8"></i>
                                        <i data-lucide="arrow-right" class="h-5 w-5 opacity-0 group-hover:opacity-100 transition-opacity"></i>
                                    </div>
                                    <h3 class="text-lg font-semibold mb-2">User Management</h3>
                                    <p class="text-sm text-green-100">Manage staff accounts, roles, and permissions</p>
                                </button>
                                
                                <button onclick="showReports()" class="group bg-gradient-to-br from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white p-6 rounded-xl text-left transition-all duration-300 hover-lift scale-in" style="animation-delay: 0.3s">
                                    <div class="flex items-center justify-between mb-4">
                                        <i data-lucide="bar-chart-3" class="h-8 w-8"></i>
                                        <i data-lucide="arrow-right" class="h-5 w-5 opacity-0 group-hover:opacity-100 transition-opacity"></i>
                                    </div>
                                    <h3 class="text-lg font-semibold mb-2">Reports & Analytics</h3>
                                    <p class="text-sm text-purple-100">View detailed reports, charts, and insights</p>
                                </button>
                                
                                <button onclick="showSystemSettings()" class="group bg-gradient-to-br from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white p-6 rounded-xl text-left transition-all duration-300 hover-lift scale-in" style="animation-delay: 0.4s">
                                    <div class="flex items-center justify-between mb-4">
                                        <i data-lucide="settings" class="h-8 w-8"></i>
                                        <i data-lucide="arrow-right" class="h-5 w-5 opacity-0 group-hover:opacity-100 transition-opacity"></i>
                                    </div>
                                    <h3 class="text-lg font-semibold mb-2">System Settings</h3>
                                    <p class="text-sm text-gray-100">Configure system preferences and settings</p>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Recent Activity & System Status -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div class="bg-white shadow-lg rounded-xl p-6 slide-up" style="animation-delay: 0.4s">
                                <h3 class="text-lg font-semibold text-gray-900 mb-4">Recent Activity</h3>
                                <div class="space-y-4">
                                    <div class="flex items-center space-x-3 p-3 bg-blue-50 rounded-lg">
                                        <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center">
                                            <i data-lucide="user-plus" class="h-4 w-4 text-white"></i>
                                        </div>
                                        <div class="flex-1">
                                            <p class="text-sm font-medium text-gray-900">New student registered</p>
                                            <p class="text-xs text-gray-500">John Doe - Computer Science</p>
                                        </div>
                                        <span class="text-xs text-gray-400">2h ago</span>
                                    </div>
                                    <div class="flex items-center space-x-3 p-3 bg-green-50 rounded-lg">
                                        <div class="w-8 h-8 bg-green-600 rounded-full flex items-center justify-center">
                                            <i data-lucide="check-circle" class="h-4 w-4 text-white"></i>
                                        </div>
                                        <div class="flex-1">
                                            <p class="text-sm font-medium text-gray-900">Fee payment processed</p>
                                            <p class="text-xs text-gray-500">₹80,000 - Jane Smith</p>
                                        </div>
                                        <span class="text-xs text-gray-400">4h ago</span>
                                    </div>
                                    <div class="flex items-center space-x-3 p-3 bg-purple-50 rounded-lg">
                                        <div class="w-8 h-8 bg-purple-600 rounded-full flex items-center justify-center">
                                            <i data-lucide="calendar" class="h-4 w-4 text-white"></i>
                                        </div>
                                        <div class="flex-1">
                                            <p class="text-sm font-medium text-gray-900">Exam scheduled</p>
                                            <p class="text-xs text-gray-500">Data Structures - April 15</p>
                                        </div>
                                        <span class="text-xs text-gray-400">6h ago</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white shadow-lg rounded-xl p-6 slide-up" style="animation-delay: 0.5s">
                                <h3 class="text-lg font-semibold text-gray-900 mb-4">System Status</h3>
                                <div class="space-y-4">
                                    <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                                        <div class="flex items-center space-x-3">
                                            <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                                            <span class="text-sm font-medium text-gray-900">Database</span>
                                        </div>
                                        <span class="text-sm text-green-600">Healthy</span>
                                    </div>
                                    <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                                        <div class="flex items-center space-x-3">
                                            <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                                            <span class="text-sm font-medium text-gray-900">Server</span>
                                        </div>
                                        <span class="text-sm text-green-600">Online</span>
                                    </div>
                                    <div class="flex items-center justify-between p-3 bg-yellow-50 rounded-lg">
                                        <div class="flex items-center space-x-3">
                                            <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
                                            <span class="text-sm font-medium text-gray-900">Backup</span>
                                        </div>
                                        <span class="text-sm text-yellow-600">Scheduled</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else if (role === 'staff') {
                dashboardContent.innerHTML = `
                    <div class="px-4 py-6 sm:px-0 fade-in">
                        <!-- Welcome Header -->
                        <div class="bg-gradient-to-r from-green-600 via-teal-600 to-blue-600 rounded-xl p-8 mb-8 text-white slide-up">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h1 class="text-4xl font-bold mb-2">Welcome Back, Staff! 🎓</h1>
                                    <p class="text-green-100 text-lg">Ready to manage your academic responsibilities</p>
                                </div>
                                <div class="hidden md:block">
                                    <div class="w-24 h-24 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                                        <i data-lucide="graduation-cap" class="h-12 w-12 text-yellow-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Quick Stats -->
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                            <div class="bg-white overflow-hidden shadow-lg rounded-xl hover:shadow-xl transition-all duration-300 hover-lift bounce-in">
                                <div class="p-6">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0">
                                            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                                <i data-lucide="calendar-check" class="h-6 w-6 text-blue-600"></i>
                                            </div>
                                        </div>
                                        <div class="ml-4 flex-1">
                                            <p class="text-sm font-medium text-gray-500">Scheduled Exams</p>
                                            <p class="text-2xl font-bold text-gray-900">12</p>
                                            <p class="text-xs text-blue-600 flex items-center mt-1">
                                                <i data-lucide="clock" class="h-3 w-3 mr-1"></i>
                                                3 this week
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white overflow-hidden shadow-lg rounded-xl hover:shadow-xl transition-all duration-300 hover-lift bounce-in" style="animation-delay: 0.1s">
                                <div class="p-6">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0">
                                            <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                                <i data-lucide="indian-rupee" class="h-6 w-6 text-green-600"></i>
                                            </div>
                                        </div>
                                        <div class="ml-4 flex-1">
                                            <p class="text-sm font-medium text-gray-500">Fees Collected</p>
                                            <p class="text-2xl font-bold text-gray-900">₹45.2L</p>
                                            <p class="text-xs text-green-600 flex items-center mt-1">
                                                <i data-lucide="trending-up" class="h-3 w-3 mr-1"></i>
                                                +8% this month
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white overflow-hidden shadow-lg rounded-xl hover:shadow-xl transition-all duration-300 hover-lift bounce-in" style="animation-delay: 0.2s">
                                <div class="p-6">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0">
                                            <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                                <i data-lucide="users" class="h-6 w-6 text-purple-600"></i>
                                            </div>
                                        </div>
                                        <div class="ml-4 flex-1">
                                            <p class="text-sm font-medium text-gray-500">My Students</p>
                                            <p class="text-2xl font-bold text-gray-900">156</p>
                                            <p class="text-xs text-purple-600 flex items-center mt-1">
                                                <i data-lucide="book-open" class="h-3 w-3 mr-1"></i>
                                                3 classes
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white overflow-hidden shadow-lg rounded-xl hover:shadow-xl transition-all duration-300 hover-lift bounce-in" style="animation-delay: 0.3s">
                                <div class="p-6">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0">
                                            <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center">
                                                <i data-lucide="clipboard-check" class="h-6 w-6 text-orange-600"></i>
                                            </div>
                                        </div>
                                        <div class="ml-4 flex-1">
                                            <p class="text-sm font-medium text-gray-500">Pending Tasks</p>
                                            <p class="text-2xl font-bold text-gray-900">7</p>
                                            <p class="text-xs text-orange-600 flex items-center mt-1">
                                                <i data-lucide="alert-circle" class="h-3 w-3 mr-1"></i>
                                                2 urgent
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Quick Actions -->
                        <div class="mb-8">
                            <h2 class="text-2xl font-bold text-gray-900 mb-6">Staff Tools</h2>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <button onclick="showExamManagement()" class="group bg-gradient-to-br from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white p-6 rounded-xl text-left transition-all duration-300 hover-lift scale-in">
                                    <div class="flex items-center justify-between mb-4">
                                        <i data-lucide="calendar-check" class="h-8 w-8"></i>
                                        <i data-lucide="arrow-right" class="h-5 w-5 opacity-0 group-hover:opacity-100 transition-opacity"></i>
                                    </div>
                                    <h3 class="text-lg font-semibold mb-2">Exam Management</h3>
                                    <p class="text-sm text-blue-100">Schedule exams, upload marks, and publish results</p>
                                </button>
                                
                                <button onclick="showFeeManagement()" class="group bg-gradient-to-br from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white p-6 rounded-xl text-left transition-all duration-300 hover-lift scale-in" style="animation-delay: 0.1s">
                                    <div class="flex items-center justify-between mb-4">
                                        <i data-lucide="indian-rupee" class="h-8 w-8"></i>
                                        <i data-lucide="arrow-right" class="h-5 w-5 opacity-0 group-hover:opacity-100 transition-opacity"></i>
                                    </div>
                                    <h3 class="text-lg font-semibold mb-2">Fee Management</h3>
                                    <p class="text-sm text-green-100">Collect fees, generate receipts, and track payments</p>
                                </button>
                                
                                <button onclick="showStudentRecords()" class="group bg-gradient-to-br from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white p-6 rounded-xl text-left transition-all duration-300 hover-lift scale-in" style="animation-delay: 0.2s">
                                    <div class="flex items-center justify-between mb-4">
                                        <i data-lucide="users" class="h-8 w-8"></i>
                                        <i data-lucide="arrow-right" class="h-5 w-5 opacity-0 group-hover:opacity-100 transition-opacity"></i>
                                    </div>
                                    <h3 class="text-lg font-semibold mb-2">Student Records</h3>
                                    <p class="text-sm text-purple-100">View and manage student academic records</p>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Today's Schedule & Quick Info -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div class="bg-white shadow-lg rounded-xl p-6 slide-up" style="animation-delay: 0.4s">
                                <h3 class="text-lg font-semibold text-gray-900 mb-4">Today's Schedule</h3>
                                <div class="space-y-4">
                                    <div class="flex items-center space-x-3 p-3 bg-blue-50 rounded-lg">
                                        <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center">
                                            <i data-lucide="clock" class="h-4 w-4 text-white"></i>
                                        </div>
                                        <div class="flex-1">
                                            <p class="text-sm font-medium text-gray-900">Data Structures Class</p>
                                            <p class="text-xs text-gray-500">10:00 AM - 11:00 AM • Room 101</p>
                                        </div>
                                        <span class="text-xs text-blue-600">In 30 mins</span>
                                    </div>
                                    <div class="flex items-center space-x-3 p-3 bg-green-50 rounded-lg">
                                        <div class="w-8 h-8 bg-green-600 rounded-full flex items-center justify-center">
                                            <i data-lucide="clipboard-check" class="h-4 w-4 text-white"></i>
                                        </div>
                                        <div class="flex-1">
                                            <p class="text-sm font-medium text-gray-900">Grade Submissions</p>
                                            <p class="text-xs text-gray-500">Mathematics Exam • Due Today</p>
                                        </div>
                                        <span class="text-xs text-orange-600">Urgent</span>
                                    </div>
                                    <div class="flex items-center space-x-3 p-3 bg-purple-50 rounded-lg">
                                        <div class="w-8 h-8 bg-purple-600 rounded-full flex items-center justify-center">
                                            <i data-lucide="users" class="h-4 w-4 text-white"></i>
                                        </div>
                                        <div class="flex-1">
                                            <p class="text-sm font-medium text-gray-900">Faculty Meeting</p>
                                            <p class="text-xs text-gray-500">3:00 PM - 4:00 PM • Conference Room</p>
                                        </div>
                                        <span class="text-xs text-purple-600">Later</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white shadow-lg rounded-xl p-6 slide-up" style="animation-delay: 0.5s">
                                <h3 class="text-lg font-semibold text-gray-900 mb-4">Quick Actions</h3>
                                <div class="space-y-3">
                                    <button onclick="showCreateExam()" class="w-full flex items-center justify-between p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors">
                                        <div class="flex items-center space-x-3">
                                            <i data-lucide="plus-circle" class="h-5 w-5 text-blue-600"></i>
                                            <span class="text-sm font-medium text-gray-900">Schedule New Exam</span>
                                        </div>
                                        <i data-lucide="chevron-right" class="h-4 w-4 text-gray-400"></i>
                                    </button>
                                    <button onclick="showCollectFee()" class="w-full flex items-center justify-between p-3 bg-green-50 hover:bg-green-100 rounded-lg transition-colors">
                                        <div class="flex items-center space-x-3">
                                            <i data-lucide="credit-card" class="h-5 w-5 text-green-600"></i>
                                            <span class="text-sm font-medium text-gray-900">Collect Fee Payment</span>
                                        </div>
                                        <i data-lucide="chevron-right" class="h-4 w-4 text-gray-400"></i>
                                    </button>
                                    <button onclick="showUploadMarks()" class="w-full flex items-center justify-between p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors">
                                        <div class="flex items-center space-x-3">
                                            <i data-lucide="upload" class="h-5 w-5 text-purple-600"></i>
                                            <span class="text-sm font-medium text-gray-900">Upload Exam Marks</span>
                                        </div>
                                        <i data-lucide="chevron-right" class="h-4 w-4 text-gray-400"></i>
                                    </button>
                                    <button onclick="showAllExams()" class="w-full flex items-center justify-between p-3 bg-orange-50 hover:bg-orange-100 rounded-lg transition-colors">
                                        <div class="flex items-center space-x-3">
                                            <i data-lucide="calendar" class="h-5 w-5 text-orange-600"></i>
                                            <span class="text-sm font-medium text-gray-900">View Exam Calendar</span>
                                        </div>
                                        <i data-lucide="chevron-right" class="h-4 w-4 text-gray-400"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                dashboardContent.innerHTML = `
                    <div class="px-4 py-6 sm:px-0 fade-in">
                        <!-- Welcome Header -->
                        <div class="bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 rounded-xl p-8 mb-8 text-white slide-up">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h1 class="text-4xl font-bold mb-2">Welcome Back, Student! 🎓</h1>
                                    <p class="text-purple-100 text-lg">Ready to excel in your academic journey</p>
                                </div>
                                <div class="hidden md:block">
                                    <div class="w-24 h-24 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                                        <i data-lucide="book-open" class="h-12 w-12 text-yellow-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Student Stats -->
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                            <div class="bg-white overflow-hidden shadow-lg rounded-xl hover:shadow-xl transition-all duration-300 hover-lift bounce-in">
                                <div class="p-6">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0">
                                            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                                <i data-lucide="user-check" class="h-6 w-6 text-blue-600"></i>
                                            </div>
                                        </div>
                                        <div class="ml-4 flex-1">
                                            <p class="text-sm font-medium text-gray-500">Admission Status</p>
                                            <p class="text-2xl font-bold text-gray-900">Confirmed</p>
                                            <p class="text-xs text-blue-600 flex items-center mt-1">
                                                <i data-lucide="check-circle" class="h-3 w-3 mr-1"></i>
                                                Active enrollment
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white overflow-hidden shadow-lg rounded-xl hover:shadow-xl transition-all duration-300 hover-lift bounce-in" style="animation-delay: 0.1s">
                                <div class="p-6">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0">
                                            <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                                <i data-lucide="credit-card" class="h-6 w-6 text-green-600"></i>
                                            </div>
                                        </div>
                                        <div class="ml-4 flex-1">
                                            <p class="text-sm font-medium text-gray-500">Fee Status</p>
                                            <p class="text-2xl font-bold text-gray-900">Paid</p>
                                            <p class="text-xs text-green-600 flex items-center mt-1">
                                                <i data-lucide="check-circle" class="h-3 w-3 mr-1"></i>
                                                Current semester
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white overflow-hidden shadow-lg rounded-xl hover:shadow-xl transition-all duration-300 hover-lift bounce-in" style="animation-delay: 0.2s">
                                <div class="p-6">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0">
                                            <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                                <i data-lucide="home" class="h-6 w-6 text-purple-600"></i>
                                            </div>
                                        </div>
                                        <div class="ml-4 flex-1">
                                            <p class="text-sm font-medium text-gray-500">Hostel Room</p>
                                            <p class="text-2xl font-bold text-gray-900">A-101</p>
                                            <p class="text-xs text-purple-600 flex items-center mt-1">
                                                <i data-lucide="map-pin" class="h-3 w-3 mr-1"></i>
                                                Block A, Floor 1
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white overflow-hidden shadow-lg rounded-xl hover:shadow-xl transition-all duration-300 hover-lift bounce-in" style="animation-delay: 0.3s">
                                <div class="p-6">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0">
                                            <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                                                <i data-lucide="award" class="h-6 w-6 text-yellow-600"></i>
                                            </div>
                                        </div>
                                        <div class="ml-4 flex-1">
                                            <p class="text-sm font-medium text-gray-500">Current CGPA</p>
                                            <p class="text-2xl font-bold text-gray-900">8.5</p>
                                            <p class="text-xs text-yellow-600 flex items-center mt-1">
                                                <i data-lucide="trending-up" class="h-3 w-3 mr-1"></i>
                                                Excellent performance
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Quick Actions -->
                        <div class="mb-8">
                            <h2 class="text-2xl font-bold text-gray-900 mb-6">Student Services</h2>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                <button onclick="showAdmissionForm()" class="group bg-gradient-to-br from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white p-6 rounded-xl text-left transition-all duration-300 hover-lift scale-in">
                                    <div class="flex items-center justify-between mb-4">
                                        <i data-lucide="file-text" class="h-8 w-8"></i>
                                        <i data-lucide="arrow-right" class="h-5 w-5 opacity-0 group-hover:opacity-100 transition-opacity"></i>
                                    </div>
                                    <h3 class="text-lg font-semibold mb-2">Admission Form</h3>
                                    <p class="text-sm text-blue-100">Complete your admission application</p>
                                </button>
                                
                                <button onclick="showFeePayment()" class="group bg-gradient-to-br from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white p-6 rounded-xl text-left transition-all duration-300 hover-lift scale-in" style="animation-delay: 0.1s">
                                    <div class="flex items-center justify-between mb-4">
                                        <i data-lucide="credit-card" class="h-8 w-8"></i>
                                        <i data-lucide="arrow-right" class="h-5 w-5 opacity-0 group-hover:opacity-100 transition-opacity"></i>
                                    </div>
                                    <h3 class="text-lg font-semibold mb-2">Fee Payment</h3>
                                    <p class="text-sm text-green-100">Pay semester fees online</p>
                                </button>
                                
                                <button onclick="showExamResults()" class="group bg-gradient-to-br from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white p-6 rounded-xl text-left transition-all duration-300 hover-lift scale-in" style="animation-delay: 0.2s">
                                    <div class="flex items-center justify-between mb-4">
                                        <i data-lucide="award" class="h-8 w-8"></i>
                                        <i data-lucide="arrow-right" class="h-5 w-5 opacity-0 group-hover:opacity-100 transition-opacity"></i>
                                    </div>
                                    <h3 class="text-lg font-semibold mb-2">Exam Results</h3>
                                    <p class="text-sm text-purple-100">View your academic performance</p>
                                </button>
                                
                                <button onclick="showHostelAllocation()" class="group bg-gradient-to-br from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white p-6 rounded-xl text-left transition-all duration-300 hover-lift scale-in" style="animation-delay: 0.3s">
                                    <div class="flex items-center justify-between mb-4">
                                        <i data-lucide="home" class="h-8 w-8"></i>
                                        <i data-lucide="arrow-right" class="h-5 w-5 opacity-0 group-hover:opacity-100 transition-opacity"></i>
                                    </div>
                                    <h3 class="text-lg font-semibold mb-2">Hostel Services</h3>
                                    <p class="text-sm text-orange-100">Manage your accommodation</p>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Notifications -->
                        <div class="bg-white shadow rounded-lg mb-8">
                            <div class="px-4 py-5 sm:p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg leading-6 font-medium text-gray-900">Notifications</h3>
                                    <button onclick="markAllRead()" class="text-sm text-blue-600 hover:text-blue-800">Mark all as read</button>
                                </div>
                                <div class="space-y-3">
                                    <div class="flex items-start space-x-3 p-3 bg-blue-50 rounded-lg">
                                        <i data-lucide="bell" class="h-5 w-5 text-blue-600 mt-0.5"></i>
                                        <div class="flex-1">
                                            <p class="text-sm font-medium text-gray-900">Exam Schedule Released</p>
                                            <p class="text-sm text-gray-500">Data Structures exam on April 15, 2024 at 10:00 AM</p>
                                            <p class="text-xs text-gray-400">2 hours ago</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start space-x-3 p-3 bg-green-50 rounded-lg">
                                        <i data-lucide="check-circle" class="h-5 w-5 text-green-600 mt-0.5"></i>
                                        <div class="flex-1">
                                            <p class="text-sm font-medium text-gray-900">Fee Payment Confirmed</p>
                                            <p class="text-sm text-gray-500">Your semester fee payment has been processed successfully</p>
                                            <p class="text-xs text-gray-400">1 day ago</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white shadow rounded-lg">
                            <div class="px-4 py-5 sm:p-6">
                                <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">Student Services</h3>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                    <button onclick="showAdmissionForm()" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md font-medium">
                                        <i data-lucide="user-plus" class="h-4 w-4 inline mr-1"></i>
                                        Admission Form
                                    </button>
                                    <button onclick="showFeePayment()" class="bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md font-medium">
                                        <i data-lucide="credit-card" class="h-4 w-4 inline mr-1"></i>
                                        Fee Payment
                                    </button>
                                    <button onclick="showExamResults()" class="bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-md font-medium">
                                        <i data-lucide="award" class="h-4 w-4 inline mr-1"></i>
                                        Exam Results
                                    </button>
                                    <button onclick="showHostelAllocation()" class="bg-orange-600 hover:bg-orange-700 text-white py-2 px-4 rounded-md font-medium">
                                        <i data-lucide="home" class="h-4 w-4 inline mr-1"></i>
                                        Hostel
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            lucide.createIcons();
        }
        
        function showFeature(featureName) {
            if (featureName === 'Exam Management') {
                showExamManagement();
            } else if (featureName === 'Fee Management') {
                showFeeManagement();
            } else if (featureName === 'Student Management') {
                showStudentManagement();
            } else if (featureName === 'User Management') {
                showUserManagement();
            } else if (featureName === 'Reports') {
                showReports();
            } else if (featureName === 'Student Records') {
                showStudentRecords();
            } else if (featureName === 'System Settings') {
                showSystemSettings();
            } else {
                showToast(`${featureName} feature is under development`, 'info');
            }
            
            lucide.createIcons();
        }
        
        // Missing function implementations - removed duplicate
        
        function showStudentRecords() {
            const dashboardContent = document.getElementById('dashboard-content');
            dashboardContent.innerHTML = `
                <div class="px-4 py-6 sm:px-0 fade-in">
                    <div class="flex justify-between items-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-900">Student Records</h1>
                        <button onclick="showDashboard(currentRole)" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md font-medium">
                            ← Back to Dashboard
                        </button>
                    </div>
                    
                    <!-- Search and Filter -->
                    <div class="bg-white shadow rounded-lg p-6 mb-6">
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div>
                                <input type="text" placeholder="Search by name or ID..." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div>
                                <select class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                    <option>All Courses</option>
                                    <option>Computer Science</option>
                                    <option>Electronics</option>
                                    <option>Mechanical</option>
                                    <option>Civil</option>
                                </select>
                            </div>
                            <div>
                                <select class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                    <option>All Years</option>
                                    <option>1st Year</option>
                                    <option>2nd Year</option>
                                    <option>3rd Year</option>
                                    <option>4th Year</option>
                                </select>
                            </div>
                            <div>
                                <button class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md font-medium">
                                    <i data-lucide="search" class="h-4 w-4 inline mr-2"></i>
                                    Search
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Student Records Table -->
                    <div class="bg-white shadow overflow-hidden sm:rounded-md">
                        <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
                            <h3 class="text-lg leading-6 font-medium text-gray-900">Academic Records</h3>
                            <p class="mt-1 max-w-2xl text-sm text-gray-500">Complete academic history and performance data</p>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Student</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Course</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Year</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">CGPA</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Attendance</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200">
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="flex items-center">
                                                <div class="flex-shrink-0 h-10 w-10">
                                                    <div class="h-10 w-10 rounded-full bg-blue-600 flex items-center justify-center">
                                                        <span class="text-sm font-medium text-white">JS</span>
                                                    </div>
                                                </div>
                                                <div class="ml-4">
                                                    <div class="text-sm font-medium text-gray-900">John Smith</div>
                                                    <div class="text-sm text-gray-500">ADM2024001</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Computer Science</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">3rd Year</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="text-sm font-medium text-green-600">8.7</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="text-sm text-blue-600">92%</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Active</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                            <button onclick="viewDetailedRecord('ADM2024001')" class="text-blue-600 hover:text-blue-900 mr-3">View Details</button>
                                            <button onclick="generateTranscript('ADM2024001')" class="text-green-600 hover:text-green-900">Transcript</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="flex items-center">
                                                <div class="flex-shrink-0 h-10 w-10">
                                                    <div class="h-10 w-10 rounded-full bg-purple-600 flex items-center justify-center">
                                                        <span class="text-sm font-medium text-white">EM</span>
                                                    </div>
                                                </div>
                                                <div class="ml-4">
                                                    <div class="text-sm font-medium text-gray-900">Emma Miller</div>
                                                    <div class="text-sm text-gray-500">ADM2024002</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Electronics</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2nd Year</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="text-sm font-medium text-green-600">9.1</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="text-sm text-blue-600">95%</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Active</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                            <button onclick="viewDetailedRecord('ADM2024002')" class="text-blue-600 hover:text-blue-900 mr-3">View Details</button>
                                            <button onclick="generateTranscript('ADM2024002')" class="text-green-600 hover:text-green-900">Transcript</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            `;
            
            lucide.createIcons();
            showToast('Student Records loaded successfully!', 'success');
        }
        
        function showCreateExam() {
            showToast('Exam created successfully!', 'success');
            setTimeout(() => {
                alert('📝 Exam Created Successfully!\\n\\nExam: Data Structures Final\\nDate: April 15, 2024\\nTime: 10:00 AM - 1:00 PM\\nRoom: Hall A\\n\\n✅ Students have been notified via email.');
            }, 500);
        }
        
        function showCollectFee() {
            showToast('Collect Fee feature coming soon!', 'info');
        }
        
        // Exam Management System
        function showExamManagement() {
            const dashboardContent = document.getElementById('dashboard-content');
            dashboardContent.innerHTML = `
                <div class="px-4 py-6 sm:px-0">
                    <div class="flex justify-between items-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-900">Exam Management</h1>
                        <button onclick="showDashboard(currentRole)" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md font-medium">
                            ← Back to Dashboard
                        </button>
                    </div>
                    
                    <!-- Quick Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white overflow-hidden shadow rounded-lg">
                            <div class="p-5">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0">
                                        <i data-lucide="calendar" class="h-8 w-8 text-blue-600"></i>
                                    </div>
                                    <div class="ml-5 w-0 flex-1">
                                        <dl>
                                            <dt class="text-sm font-medium text-gray-500 truncate">Total Exams</dt>
                                            <dd class="text-lg font-medium text-gray-900">12</dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white overflow-hidden shadow rounded-lg">
                            <div class="p-5">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0">
                                        <i data-lucide="clock" class="h-8 w-8 text-yellow-600"></i>
                                    </div>
                                    <div class="ml-5 w-0 flex-1">
                                        <dl>
                                            <dt class="text-sm font-medium text-gray-500 truncate">Upcoming</dt>
                                            <dd class="text-lg font-medium text-gray-900">5</dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white overflow-hidden shadow rounded-lg">
                            <div class="p-5">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0">
                                        <i data-lucide="check-circle" class="h-8 w-8 text-green-600"></i>
                                    </div>
                                    <div class="ml-5 w-0 flex-1">
                                        <dl>
                                            <dt class="text-sm font-medium text-gray-500 truncate">Completed</dt>
                                            <dd class="text-lg font-medium text-gray-900">7</dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white overflow-hidden shadow rounded-lg">
                            <div class="p-5">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0">
                                        <i data-lucide="users" class="h-8 w-8 text-purple-600"></i>
                                    </div>
                                    <div class="ml-5 w-0 flex-1">
                                        <dl>
                                            <dt class="text-sm font-medium text-gray-500 truncate">Students</dt>
                                            <dd class="text-lg font-medium text-gray-900">1,234</dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div class="bg-white shadow rounded-lg mb-8">
                        <div class="px-4 py-5 sm:p-6">
                            <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">Exam Actions</h3>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                <button onclick="showCreateExam()" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md font-medium">
                                    <i data-lucide="plus" class="h-4 w-4 inline mr-1"></i>
                                    Create Exam
                                </button>
                                <button onclick="showUploadMarks()" class="bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md font-medium">
                                    <i data-lucide="upload" class="h-4 w-4 inline mr-1"></i>
                                    Upload Marks
                                </button>
                                <button onclick="showPublishResults()" class="bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-md font-medium">
                                    <i data-lucide="send" class="h-4 w-4 inline mr-1"></i>
                                    Publish Results
                                </button>
                                <button onclick="showAllExams()" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md font-medium">
                                    <i data-lucide="list" class="h-4 w-4 inline mr-1"></i>
                                    All Exams
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recent Exams -->
                    <div class="bg-white shadow rounded-lg">
                        <div class="px-4 py-5 sm:p-6">
                            <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">Recent Exams</h3>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Subject</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Course</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-gray-200">
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Data Structures</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Computer Science</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024-04-15</td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">Scheduled</span>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                <button onclick="editExam('exam1')" class="text-indigo-600 hover:text-indigo-900 mr-3">Edit</button>
                                                <button onclick="deleteExam('exam1')" class="text-red-600 hover:text-red-900">Delete</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Digital Electronics</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Electronics</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024-04-18</td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">Scheduled</span>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                <button onclick="editExam('exam2')" class="text-indigo-600 hover:text-indigo-900 mr-3">Edit</button>
                                                <button onclick="deleteExam('exam2')" class="text-red-600 hover:text-red-900">Delete</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Engineering Mechanics</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Mechanical</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024-03-20</td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Completed</span>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                <button onclick="viewResults('exam3')" class="text-green-600 hover:text-green-900 mr-3">View Results</button>
                                                <button onclick="deleteExam('exam3')" class="text-red-600 hover:text-red-900">Delete</button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            lucide.createIcons();
        }
        
        // Exam Management Functions
        function showCreateExam() {
            const dashboardContent = document.getElementById('dashboard-content');
            dashboardContent.innerHTML = `
                <div class="px-4 py-6 sm:px-0">
                    <div class="flex justify-between items-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-900">Create New Exam</h1>
                        <button onclick="showExamManagement()" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md font-medium">
                            ← Back to Exam Management
                        </button>
                    </div>
                    
                    <div class="bg-white shadow rounded-lg">
                        <form id="create-exam-form" class="p-6 space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Subject Name *</label>
                                    <input type="text" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="e.g., Data Structures">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Course *</label>
                                    <select required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        <option value="">Select Course</option>
                                        <option value="Computer Science">Computer Science</option>
                                        <option value="Electronics">Electronics</option>
                                        <option value="Mechanical">Mechanical</option>
                                        <option value="Civil">Civil Engineering</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Exam Date *</label>
                                    <input type="date" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Exam Time *</label>
                                    <input type="time" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Duration (minutes) *</label>
                                    <select required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        <option value="">Select Duration</option>
                                        <option value="60">1 Hour (60 minutes)</option>
                                        <option value="90">1.5 Hours (90 minutes)</option>
                                        <option value="120">2 Hours (120 minutes)</option>
                                        <option value="180">3 Hours (180 minutes)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Total Marks *</label>
                                    <input type="number" required min="1" max="200" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="100">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700">Exam Instructions</label>
                                <textarea rows="4" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="Enter exam instructions for students..."></textarea>
                            </div>
                            
                            <div class="flex justify-end space-x-4">
                                <button type="button" onclick="showExamManagement()" class="bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 px-4 rounded-md font-medium">
                                    Cancel
                                </button>
                                <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md font-medium">
                                    <i data-lucide="plus" class="h-4 w-4 inline mr-1"></i>
                                    Create Exam
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.getElementById('create-exam-form').addEventListener('submit', function(e) {
                e.preventDefault();
                const examId = 'EXAM' + Date.now();
                
                // Get form data
                const formData = new FormData(e.target);
                const examData = {
                    id: examId,
                    subject: e.target.querySelector('input[type="text"]').value,
                    course: e.target.querySelector('select').value,
                    date: e.target.querySelector('input[type="date"]').value,
                    time: e.target.querySelector('input[type="time"]').value,
                    duration: e.target.querySelector('select:nth-of-type(2)').value,
                    totalMarks: e.target.querySelector('input[type="number"]').value,
                    instructions: e.target.querySelector('textarea').value,
                    status: 'scheduled',
                    createdAt: new Date().toISOString()
                };
                
                // Store in localStorage (simulating database)
                let exams = JSON.parse(localStorage.getItem('exams') || '[]');
                exams.push(examData);
                localStorage.setItem('exams', JSON.stringify(exams));
                
                alert(`✅ Exam Created Successfully!\\n\\nExam ID: ${examId}\\nSubject: ${examData.subject}\\nDate: ${examData.date}\\nTime: ${examData.time}`);
                showExamManagement();
            });
            
            lucide.createIcons();
        }
        
        function showUploadMarks() {
            alert('✅ Upload Marks - Feature loaded!\\nThis would allow uploading student marks for completed exams via CSV or manual entry.');
        }
        
        function showPublishResults() {
            alert('✅ Publish Results - Feature loaded!\\nThis would make exam results available to students and send notifications.');
        }
        
        function showAllExams() {
            const dashboardContent = document.getElementById('dashboard-content');
            dashboardContent.innerHTML = `
                <div class="px-4 py-6 sm:px-0 fade-in">
                    <div class="flex justify-between items-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-900">Exam Calendar & Schedule</h1>
                        <div class="flex space-x-4">
                            <button onclick="showCreateExam()" class="btn-gradient text-white py-2 px-4 rounded-md font-medium hover-lift">
                                <i data-lucide="plus" class="h-4 w-4 inline mr-1"></i>
                                Schedule Exam
                            </button>
                            <button onclick="showExamManagement()" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md font-medium hover-lift">
                                ← Back to Exam Management
                            </button>
                        </div>
                    </div>
                    
                    <!-- Calendar View -->
                    <div class="bg-white shadow rounded-lg mb-6 slide-up">
                        <div class="p-6">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-lg font-semibold text-gray-900">Exam Calendar</h3>
                                <div class="flex space-x-2">
                                    <button onclick="previousMonth()" class="p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded">
                                        <i data-lucide="chevron-left" class="h-4 w-4"></i>
                                    </button>
                                    <span id="current-month" class="px-4 py-2 text-sm font-medium text-gray-900">April 2024</span>
                                    <button onclick="nextMonth()" class="p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded">
                                        <i data-lucide="chevron-right" class="h-4 w-4"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Calendar Grid -->
                            <div class="grid grid-cols-7 gap-1 mb-4">
                                <div class="p-2 text-center text-sm font-medium text-gray-500">Sun</div>
                                <div class="p-2 text-center text-sm font-medium text-gray-500">Mon</div>
                                <div class="p-2 text-center text-sm font-medium text-gray-500">Tue</div>
                                <div class="p-2 text-center text-sm font-medium text-gray-500">Wed</div>
                                <div class="p-2 text-center text-sm font-medium text-gray-500">Thu</div>
                                <div class="p-2 text-center text-sm font-medium text-gray-500">Fri</div>
                                <div class="p-2 text-center text-sm font-medium text-gray-500">Sat</div>
                            </div>
                            
                            <div id="calendar-grid" class="grid grid-cols-7 gap-1">
                                <!-- Calendar days will be generated here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Upcoming Exams -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white shadow rounded-lg bounce-in">
                            <div class="p-6">
                                <h3 class="text-lg font-semibold text-gray-900 mb-4">Upcoming Exams</h3>
                                <div class="space-y-4">
                                    <div class="flex items-center p-4 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors">
                                        <div class="flex-shrink-0">
                                            <div class="w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center">
                                                <span class="text-white font-bold text-sm">15</span>
                                            </div>
                                        </div>
                                        <div class="ml-4 flex-1">
                                            <h4 class="text-sm font-medium text-gray-900">Data Structures</h4>
                                            <p class="text-sm text-gray-500">Computer Science • 10:00 AM</p>
                                            <p class="text-xs text-blue-600">3 days remaining</p>
                                        </div>
                                        <button onclick="editExam('exam1')" class="text-blue-600 hover:text-blue-800">
                                            <i data-lucide="edit" class="h-4 w-4"></i>
                                        </button>
                                    </div>
                                    
                                    <div class="flex items-center p-4 bg-green-50 rounded-lg hover:bg-green-100 transition-colors">
                                        <div class="flex-shrink-0">
                                            <div class="w-12 h-12 bg-green-600 rounded-lg flex items-center justify-center">
                                                <span class="text-white font-bold text-sm">18</span>
                                            </div>
                                        </div>
                                        <div class="ml-4 flex-1">
                                            <h4 class="text-sm font-medium text-gray-900">Digital Electronics</h4>
                                            <p class="text-sm text-gray-500">Electronics • 2:00 PM</p>
                                            <p class="text-xs text-green-600">6 days remaining</p>
                                        </div>
                                        <button onclick="editExam('exam2')" class="text-green-600 hover:text-green-800">
                                            <i data-lucide="edit" class="h-4 w-4"></i>
                                        </button>
                                    </div>
                                    
                                    <div class="flex items-center p-4 bg-purple-50 rounded-lg hover:bg-purple-100 transition-colors">
                                        <div class="flex-shrink-0">
                                            <div class="w-12 h-12 bg-purple-600 rounded-lg flex items-center justify-center">
                                                <span class="text-white font-bold text-sm">22</span>
                                            </div>
                                        </div>
                                        <div class="ml-4 flex-1">
                                            <h4 class="text-sm font-medium text-gray-900">Mathematics</h4>
                                            <p class="text-sm text-gray-500">All Courses • 9:00 AM</p>
                                            <p class="text-xs text-purple-600">10 days remaining</p>
                                        </div>
                                        <button onclick="editExam('exam3')" class="text-purple-600 hover:text-purple-800">
                                            <i data-lucide="edit" class="h-4 w-4"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Exam Statistics -->
                        <div class="bg-white shadow rounded-lg bounce-in" style="animation-delay: 0.2s">
                            <div class="p-6">
                                <h3 class="text-lg font-semibold text-gray-900 mb-4">Exam Statistics</h3>
                                <div class="space-y-4">
                                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                        <span class="text-sm font-medium text-gray-700">Total Scheduled</span>
                                        <span class="text-lg font-bold text-blue-600">12</span>
                                    </div>
                                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                        <span class="text-sm font-medium text-gray-700">This Month</span>
                                        <span class="text-lg font-bold text-green-600">5</span>
                                    </div>
                                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                        <span class="text-sm font-medium text-gray-700">Completed</span>
                                        <span class="text-lg font-bold text-purple-600">7</span>
                                    </div>
                                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                        <span class="text-sm font-medium text-gray-700">Average Duration</span>
                                        <span class="text-lg font-bold text-orange-600">2.5h</span>
                                    </div>
                                </div>
                                
                                <div class="mt-6 pt-4 border-t">
                                    <button onclick="generateExamReport()" class="w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white py-2 px-4 rounded-lg font-medium hover-lift">
                                        <i data-lucide="download" class="h-4 w-4 inline mr-2"></i>
                                        Download Exam Schedule
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            generateCalendar();
            lucide.createIcons();
        }
        
        // Calendar Functions
        function generateCalendar() {
            const calendarGrid = document.getElementById('calendar-grid');
            const currentDate = new Date();
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            // Get first day of month and number of days
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            let calendarHTML = '';
            
            // Empty cells for days before month starts
            for (let i = 0; i < firstDay; i++) {
                calendarHTML += '<div class="p-2 h-20"></div>';
            }
            
            // Days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const isToday = day === currentDate.getDate();
                const hasExam = [15, 18, 22].includes(day); // Demo exam dates
                
                calendarHTML += `
                    <div class="p-2 h-20 border border-gray-200 hover:bg-gray-50 cursor-pointer transition-colors ${isToday ? 'bg-blue-100 border-blue-300' : ''}" onclick="selectDate(${day})">
                        <div class="text-sm ${isToday ? 'font-bold text-blue-600' : 'text-gray-900'}">${day}</div>
                        ${hasExam ? '<div class="mt-1 w-2 h-2 bg-red-500 rounded-full"></div>' : ''}
                        ${hasExam ? '<div class="text-xs text-red-600 mt-1">Exam</div>' : ''}
                    </div>
                `;
            }
            
            calendarGrid.innerHTML = calendarHTML;
        }
        
        function selectDate(day) {
            showToast(`Selected date: April ${day}, 2024`, 'info');
        }
        
        function previousMonth() {
            showToast('Previous month - March 2024', 'info');
        }
        
        function nextMonth() {
            showToast('Next month - May 2024', 'info');
        }
        
        function generateExamReport() {
            showPrintDialog('Exam Schedule Report', generateExamReportPDF);
        }
        
        function generateExamReportPDF(format) {
            if (format === 'pdf') {
                showToast('📄 Generating exam schedule PDF...', 'info');
                setTimeout(() => {
                    showToast('✅ Exam schedule PDF downloaded!', 'success');
                }, 2000);
            } else if (format === 'print') {
                showToast('🖨️ Printing exam schedule...', 'info');
                setTimeout(() => {
                    showToast('✅ Exam schedule sent to printer!', 'success');
                }, 1500);
            } else if (format === 'excel') {
                showToast('📊 Exporting exam data to Excel...', 'info');
                setTimeout(() => {
                    showToast('✅ Exam data exported to Excel!', 'success');
                }, 2000);
            }
        }
        
        function editExam(examId) {
            alert(`✅ Edit Exam - Feature loaded!\\nEditing exam: ${examId}\\nThis would show a form to modify exam details.`);
        }
        
        function deleteExam(examId) {
            if (confirm(`Are you sure you want to delete exam ${examId}?`)) {
                alert(`✅ Exam ${examId} deleted successfully!`);
            }
        }
        
        function viewResults(examId) {
            alert(`✅ View Results - Feature loaded!\\nViewing results for exam: ${examId}\\nThis would show detailed student results and statistics.`);
        }
        
        // Fee Management System
        function showFeeManagement() {
            const dashboardContent = document.getElementById('dashboard-content');
            dashboardContent.innerHTML = `
                <div class="px-4 py-6 sm:px-0">
                    <div class="flex justify-between items-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-900">Fee Management</h1>
                        <button onclick="showDashboard(currentRole)" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md font-medium">
                            ← Back to Dashboard
                        </button>
                    </div>
                    
                    <!-- Quick Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white overflow-hidden shadow rounded-lg">
                            <div class="p-5">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0">
                                        <i data-lucide="dollar-sign" class="h-8 w-8 text-green-600"></i>
                                    </div>
                                    <div class="ml-5 w-0 flex-1">
                                        <dl>
                                            <dt class="text-sm font-medium text-gray-500 truncate">Total Collection</dt>
                                            <dd class="text-lg font-medium text-gray-900">₹98,76,000</dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white overflow-hidden shadow rounded-lg">
                            <div class="p-5">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0">
                                        <i data-lucide="users" class="h-8 w-8 text-blue-600"></i>
                                    </div>
                                    <div class="ml-5 w-0 flex-1">
                                        <dl>
                                            <dt class="text-sm font-medium text-gray-500 truncate">Paid Students</dt>
                                            <dd class="text-lg font-medium text-gray-900">1,156</dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white overflow-hidden shadow rounded-lg">
                            <div class="p-5">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0">
                                        <i data-lucide="clock" class="h-8 w-8 text-yellow-600"></i>
                                    </div>
                                    <div class="ml-5 w-0 flex-1">
                                        <dl>
                                            <dt class="text-sm font-medium text-gray-500 truncate">Pending</dt>
                                            <dd class="text-lg font-medium text-gray-900">78</dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white overflow-hidden shadow rounded-lg">
                            <div class="p-5">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0">
                                        <i data-lucide="trending-up" class="h-8 w-8 text-purple-600"></i>
                                    </div>
                                    <div class="ml-5 w-0 flex-1">
                                        <dl>
                                            <dt class="text-sm font-medium text-gray-500 truncate">Collection Rate</dt>
                                            <dd class="text-lg font-medium text-gray-900">94%</dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div class="bg-white shadow rounded-lg mb-8">
                        <div class="px-4 py-5 sm:p-6">
                            <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">Fee Actions</h3>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                <button onclick="showCollectFee()" class="bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md font-medium">
                                    <i data-lucide="credit-card" class="h-4 w-4 inline mr-1"></i>
                                    Collect Fee
                                </button>
                                <button onclick="showGenerateReceipt()" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md font-medium">
                                    <i data-lucide="file-text" class="h-4 w-4 inline mr-1"></i>
                                    Generate Receipt
                                </button>
                                <button onclick="showSendReminder()" class="bg-orange-600 hover:bg-orange-700 text-white py-2 px-4 rounded-md font-medium">
                                    <i data-lucide="bell" class="h-4 w-4 inline mr-1"></i>
                                    Send Reminder
                                </button>
                                <button onclick="showAllTransactions()" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md font-medium">
                                    <i data-lucide="list" class="h-4 w-4 inline mr-1"></i>
                                    All Transactions
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recent Transactions -->
                    <div class="bg-white shadow rounded-lg">
                        <div class="px-4 py-5 sm:p-6">
                            <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">Recent Transactions</h3>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Student</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Admission ID</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Amount</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date & Time</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-gray-200" id="fee-transactions-tbody">
                                        ${feePayments.slice(0, 10).map(payment => `
                                            <tr>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${payment.studentName}</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${payment.studentId}</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">₹${payment.amount.toLocaleString()}</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${payment.date} ${payment.time}</td>
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${payment.status === 'Completed' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}">${payment.status}</span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                    <button onclick="viewReceipt('${payment.id}')" class="text-blue-600 hover:text-blue-900 mr-3">Receipt</button>
                                                    <button onclick="sendReceipt('${payment.id}')" class="text-green-600 hover:text-green-900">Send</button>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            lucide.createIcons();
        }
        
        // Fee Management Functions
        function showCollectFee() {
            const dashboardContent = document.getElementById('dashboard-content');
            dashboardContent.innerHTML = `
                <div class="px-4 py-6 sm:px-0">
                    <div class="flex justify-between items-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-900">Collect Fee</h1>
                        <button onclick="showFeeManagement()" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md font-medium">
                            ← Back to Fee Management
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Student Search -->
                        <div class="bg-white shadow rounded-lg">
                            <div class="p-6">
                                <h3 class="text-lg font-medium text-gray-900 mb-4">Find Student</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Search by Admission ID or Name</label>
                                        <input type="text" id="student-search" placeholder="Enter Admission ID or Student Name" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <button onclick="searchStudent()" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md font-medium">
                                        <i data-lucide="search" class="h-4 w-4 inline mr-1"></i>
                                        Search Student
                                    </button>
                                </div>
                                
                                <div id="student-info" class="hidden mt-6 p-4 bg-gray-50 rounded-lg">
                                    <h4 class="font-medium text-gray-900 mb-2">Student Details</h4>
                                    <div id="student-details"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Fee Collection Form -->
                        <div class="bg-white shadow rounded-lg">
                            <form id="fee-collection-form" class="p-6 space-y-6">
                                <h3 class="text-lg font-medium text-gray-900">Fee Collection</h3>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Fee Type *</label>
                                    <select id="fee-type" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        <option value="">Select Fee Type</option>
                                        <option value="tuition">Tuition Fee - ₹50,000</option>
                                        <option value="hostel">Hostel Fee - ₹25,000</option>
                                        <option value="library">Library Fee - ₹5,000</option>
                                        <option value="full">Full Semester Fee - ₹80,000</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Amount *</label>
                                    <input type="number" id="fee-amount" required min="1" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Payment Method *</label>
                                    <select required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        <option value="">Select Payment Method</option>
                                        <option value="cash">Cash Payment</option>
                                        <option value="online">Online Payment</option>
                                        <option value="bank">Bank Transfer</option>
                                        <option value="cheque">Cheque</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Receipt Number</label>
                                    <input type="text" id="receipt-number" readonly class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Remarks</label>
                                    <textarea rows="3" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="Any additional notes..."></textarea>
                                </div>
                                
                                <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white py-3 px-4 rounded-md font-medium">
                                    <i data-lucide="credit-card" class="h-4 w-4 inline mr-2"></i>
                                    Collect Fee & Generate Receipt
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            `;
            
            // Auto-generate receipt number
            document.getElementById('receipt-number').value = 'RCP' + Date.now();
            
            // Fee type change handler
            document.getElementById('fee-type').addEventListener('change', function() {
                const feeAmounts = {
                    'tuition': 50000,
                    'hostel': 25000,
                    'library': 5000,
                    'full': 80000
                };
                document.getElementById('fee-amount').value = feeAmounts[this.value] || '';
            });
            
            // Form submission
            document.getElementById('fee-collection-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const feeData = {
                    id: 'FEE' + Date.now(),
                    studentId: document.getElementById('student-search').value,
                    feeType: document.getElementById('fee-type').value,
                    amount: document.getElementById('fee-amount').value,
                    paymentMethod: e.target.querySelector('select:nth-of-type(2)').value,
                    receiptNumber: document.getElementById('receipt-number').value,
                    remarks: e.target.querySelector('textarea').value,
                    collectedBy: currentUser.email,
                    collectedAt: new Date().toISOString(),
                    status: 'paid'
                };
                
                // Store in localStorage
                let fees = JSON.parse(localStorage.getItem('fees') || '[]');
                fees.push(feeData);
                localStorage.setItem('fees', JSON.stringify(fees));
                
                alert(`✅ Fee Collected Successfully!\\n\\nReceipt: ${feeData.receiptNumber}\\nAmount: ₹${feeData.amount}\\nStudent: ${feeData.studentId}\\n\\nReceipt has been generated.`);
                showFeeManagement();
            });
            
            lucide.createIcons();
        }
        
        // Search student function
        function searchStudent() {
            const searchTerm = document.getElementById('student-search').value;
            if (!searchTerm) {
                alert('Please enter Admission ID or Student Name');
                return;
            }
            
            // Demo student data
            const students = [
                { id: 'ADM2024001', name: 'Demo Student', course: 'Computer Science', email: 'demo@student.com' },
                { id: 'ADM2024002', name: 'John Doe', course: 'Electronics', email: 'john@student.com' },
                { id: 'ADM2024003', name: 'Jane Smith', course: 'Mechanical', email: 'jane@student.com' }
            ];
            
            const student = students.find(s => 
                s.id.toLowerCase().includes(searchTerm.toLowerCase()) || 
                s.name.toLowerCase().includes(searchTerm.toLowerCase())
            );
            
            if (student) {
                document.getElementById('student-details').innerHTML = `
                    <div class="space-y-2 text-sm">
                        <p><strong>Name:</strong> ${student.name}</p>
                        <p><strong>Admission ID:</strong> ${student.id}</p>
                        <p><strong>Course:</strong> ${student.course}</p>
                        <p><strong>Email:</strong> ${student.email}</p>
                    </div>
                `;
                document.getElementById('student-info').classList.remove('hidden');
            } else {
                alert('❌ Student not found! Please check the Admission ID or Name.');
                document.getElementById('student-info').classList.add('hidden');
            }
        }
        
        function showGenerateReceipt() {
            alert('✅ Generate Receipt - Feature loaded!\\nThis would allow generating and downloading fee receipts for paid students.');
        }
        
        function showSendReminder() {
            alert('✅ Send Reminder - Feature loaded!\\nThis would show options to send fee payment reminders via email/SMS to pending students.');
        }
        
        function showAllTransactions() {
            alert('✅ All Transactions - Feature loaded!\\nThis would show a complete list of all fee transactions with filtering options.');
        }
        
        function viewReceipt(transactionId) {
            alert(`✅ View Receipt - Feature loaded!\\nViewing receipt for transaction: ${transactionId}\\nThis would show/download the fee receipt.`);
        }
        
        function viewFeeDetails(feeId) {
            alert(`✅ Fee Details - Feature loaded!\\nViewing details for fee: ${feeId}\\nThis would show complete fee breakdown and payment history.`);
        }
        
        function collectFeeForStudent(admissionId) {
            alert(`✅ Collect Fee - Feature loaded!\\nCollecting fee for student: ${admissionId}\\nThis would show a payment form for the specific student.`);
        }
        
        function sendReminderToStudent(admissionId) {
            alert(`✅ Send Reminder - Feature loaded!\\nSending reminder to student: ${admissionId}\\nThis would send a fee payment reminder notification.`);
        }
        
        // Admin Management Functions
        function showStudentManagement() {
            const dashboardContent = document.getElementById('dashboard-content');
            dashboardContent.innerHTML = `
                <div class="px-4 py-6 sm:px-0 fade-in">
                    <div class="flex justify-between items-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-900">Student Management</h1>
                        <div class="flex space-x-4">
                            <button onclick="showAddStudent()" class="btn-gradient text-white py-2 px-4 rounded-md font-medium hover-lift">
                                <i data-lucide="user-plus" class="h-4 w-4 inline mr-1"></i>
                                Add Student
                            </button>
                            <button onclick="showPrintDialog('Student List Report', generateStudentReportPDF)" class="bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md font-medium hover-lift">
                                <i data-lucide="printer" class="h-4 w-4 inline mr-1"></i>
                                Print/Export
                            </button>
                            <button onclick="showDashboard(currentRole)" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md font-medium hover-lift">
                                ← Back to Dashboard
                            </button>
                        </div>
                    </div>
                    
                    <!-- Advanced Search & Filters -->
                    <div class="bg-white shadow rounded-lg mb-6 slide-up">
                        <div class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Search Students</label>
                                    <div class="relative">
                                        <input type="text" id="student-search-input" placeholder="Search by name, ID, email..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                        <i data-lucide="search" class="absolute left-3 top-2.5 h-4 w-4 text-gray-400"></i>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Course Filter</label>
                                    <select id="course-filter" class="w-full py-2 px-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                        <option value="">All Courses</option>
                                        <option value="Computer Science">Computer Science</option>
                                        <option value="Electronics">Electronics</option>
                                        <option value="Mechanical">Mechanical</option>
                                        <option value="Civil">Civil Engineering</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Status Filter</label>
                                    <select id="status-filter" class="w-full py-2 px-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                        <option value="">All Status</option>
                                        <option value="active">Active</option>
                                        <option value="inactive">Inactive</option>
                                        <option value="graduated">Graduated</option>
                                    </select>
                                </div>
                                <div class="flex items-end">
                                    <button onclick="applyStudentFilters()" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg font-medium hover-lift">
                                        <i data-lucide="filter" class="h-4 w-4 inline mr-1"></i>
                                        Apply Filters
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Student Cards Grid -->
                    <div id="students-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Student cards will be loaded here -->
                    </div>
                    
                    <!-- Student List Table (Alternative View) -->
                    <div id="students-table" class="hidden bg-white shadow rounded-lg">
                        <div class="px-4 py-5 sm:p-6">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-lg font-medium text-gray-900">Student List</h3>
                                <div class="flex space-x-2">
                                    <button onclick="toggleView('grid')" id="grid-view-btn" class="p-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                                        <i data-lucide="grid" class="h-4 w-4"></i>
                                    </button>
                                    <button onclick="toggleView('table')" id="table-view-btn" class="p-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400">
                                        <i data-lucide="list" class="h-4 w-4"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Student</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Course</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">CGPA</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="students-table-body" class="bg-white divide-y divide-gray-200">
                                        <!-- Table rows will be loaded here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Load students and initialize
            loadStudentCards();
            setupStudentSearch();
            setupStudentFilters();
            lucide.createIcons();
        }
        
        // Load Student Cards
        function loadStudentCards() {
            const studentsGrid = document.getElementById('students-grid');
            const demoStudents = [
                {
                    id: 'ADM2024001',
                    name: 'Demo Student',
                    email: 'demo@student.com',
                    course: 'Computer Science',
                    year: '2024',
                    cgpa: '8.5',
                    status: 'active',
                    phone: '+91-9876543210',
                    avatar: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face'
                },
                {
                    id: 'ADM2024002',
                    name: 'John Doe',
                    email: 'john@student.com',
                    course: 'Electronics',
                    year: '2024',
                    cgpa: '7.8',
                    status: 'active',
                    phone: '+91-9876543211',
                    avatar: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face'
                },
                {
                    id: 'ADM2024003',
                    name: 'Jane Smith',
                    email: 'jane@student.com',
                    course: 'Mechanical',
                    year: '2024',
                    cgpa: '9.1',
                    status: 'active',
                    phone: '+91-9876543212',
                    avatar: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face'
                },
                {
                    id: 'ADM2024004',
                    name: 'Alex Johnson',
                    email: 'alex@student.com',
                    course: 'Civil',
                    year: '2023',
                    cgpa: '8.7',
                    status: 'active',
                    phone: '+91-9876543213',
                    avatar: 'https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=150&h=150&fit=crop&crop=face'
                },
                {
                    id: 'ADM2023001',
                    name: 'Sarah Wilson',
                    email: 'sarah@student.com',
                    course: 'Computer Science',
                    year: '2023',
                    cgpa: '8.9',
                    status: 'graduated',
                    phone: '+91-9876543214',
                    avatar: 'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face'
                },
                {
                    id: 'ADM2024005',
                    name: 'Mike Brown',
                    email: 'mike@student.com',
                    course: 'Electronics',
                    year: '2024',
                    cgpa: '7.2',
                    status: 'inactive',
                    phone: '+91-9876543215',
                    avatar: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face'
                }
            ];
            
            studentsGrid.innerHTML = demoStudents.map(student => `
                <div class="bg-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover-lift bounce-in" style="animation-delay: ${Math.random() * 0.5}s">
                    <div class="p-6">
                        <div class="flex items-center space-x-4 mb-4">
                            <img src="${student.avatar}" alt="${student.name}" class="w-16 h-16 rounded-full object-cover border-4 border-blue-100">
                            <div class="flex-1">
                                <h3 class="text-lg font-semibold text-gray-900">${student.name}</h3>
                                <p class="text-sm text-gray-500">${student.id}</p>
                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getStatusBadgeClass(student.status)}">
                                    ${student.status.charAt(0).toUpperCase() + student.status.slice(1)}
                                </span>
                            </div>
                        </div>
                        
                        <div class="space-y-2 mb-4">
                            <div class="flex items-center text-sm text-gray-600">
                                <i data-lucide="book-open" class="h-4 w-4 mr-2"></i>
                                ${student.course}
                            </div>
                            <div class="flex items-center text-sm text-gray-600">
                                <i data-lucide="mail" class="h-4 w-4 mr-2"></i>
                                ${student.email}
                            </div>
                            <div class="flex items-center text-sm text-gray-600">
                                <i data-lucide="phone" class="h-4 w-4 mr-2"></i>
                                ${student.phone}
                            </div>
                            <div class="flex items-center text-sm text-gray-600">
                                <i data-lucide="award" class="h-4 w-4 mr-2"></i>
                                CGPA: ${student.cgpa}
                            </div>
                        </div>
                        
                        <div class="flex space-x-2">
                            <button onclick="viewStudentProfile('${student.id}')" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 px-3 rounded-lg text-sm font-medium hover-lift">
                                <i data-lucide="eye" class="h-4 w-4 inline mr-1"></i>
                                View Profile
                            </button>
                            <button onclick="editStudent('${student.id}')" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-3 rounded-lg text-sm font-medium hover-lift">
                                <i data-lucide="edit" class="h-4 w-4"></i>
                            </button>
                            <button onclick="deleteStudent('${student.id}')" class="bg-red-600 hover:bg-red-700 text-white py-2 px-3 rounded-lg text-sm font-medium hover-lift">
                                <i data-lucide="trash-2" class="h-4 w-4"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
            
            lucide.createIcons();
        }
        
        // Get status badge styling
        function getStatusBadgeClass(status) {
            const classes = {
                active: 'bg-green-100 text-green-800',
                inactive: 'bg-red-100 text-red-800',
                graduated: 'bg-blue-100 text-blue-800'
            };
            return classes[status] || 'bg-gray-100 text-gray-800';
        }
        
        // Setup student search functionality
        function setupStudentSearch() {
            const searchInput = document.getElementById('student-search-input');
            if (searchInput) {
                searchInput.addEventListener('input', function() {
                    // Real-time search functionality
                    const searchTerm = this.value.toLowerCase();
                    const studentCards = document.querySelectorAll('#students-grid > div');
                    
                    studentCards.forEach(card => {
                        const text = card.textContent.toLowerCase();
                        if (text.includes(searchTerm)) {
                            card.style.display = 'block';
                            card.classList.add('scale-in');
                        } else {
                            card.style.display = 'none';
                        }
                    });
                });
            }
        }
        
        // Apply filters
        function applyStudentFilters() {
            const courseFilter = document.getElementById('course-filter').value;
            const statusFilter = document.getElementById('status-filter').value;
            
            showToast('Filters applied successfully!', 'success');
            // Filter logic would go here
        }
        
        // Toggle between grid and table view
        function toggleView(viewType) {
            const gridView = document.getElementById('students-grid');
            const tableView = document.getElementById('students-table');
            const gridBtn = document.getElementById('grid-view-btn');
            const tableBtn = document.getElementById('table-view-btn');
            
            if (viewType === 'grid') {
                gridView.classList.remove('hidden');
                tableView.classList.add('hidden');
                gridBtn.classList.add('bg-blue-600', 'text-white');
                gridBtn.classList.remove('bg-gray-300', 'text-gray-700');
                tableBtn.classList.add('bg-gray-300', 'text-gray-700');
                tableBtn.classList.remove('bg-blue-600', 'text-white');
            } else {
                gridView.classList.add('hidden');
                tableView.classList.remove('hidden');
                tableBtn.classList.add('bg-blue-600', 'text-white');
                tableBtn.classList.remove('bg-gray-300', 'text-gray-700');
                gridBtn.classList.add('bg-gray-300', 'text-gray-700');
                gridBtn.classList.remove('bg-blue-600', 'text-white');
            }
        }
        
        // Student profile functions
        function viewStudentProfile(studentId) {
            showToast(`Opening profile for student: ${studentId}`, 'info');
            // Would open detailed student profile modal
        }
        
        function editStudent(studentId) {
            const dashboardContent = document.getElementById('dashboard-content');
            
            // Get student data (in real app, this would come from database)
            const studentData = {
                'ADM2024001': { name: 'Demo Student', email: 'demo@student.com', phone: '+91-9876543210', course: 'Computer Science', year: '2024', status: 'active' },
                'ADM2024002': { name: 'John Doe', email: 'john@student.com', phone: '+91-9876543211', course: 'Electronics', year: '2024', status: 'active' },
                'ADM2024003': { name: 'Jane Smith', email: 'jane@student.com', phone: '+91-9876543212', course: 'Mechanical', year: '2024', status: 'active' },
                'ADM2024004': { name: 'Alex Johnson', email: 'alex@student.com', phone: '+91-9876543213', course: 'Civil', year: '2023', status: 'active' },
                'ADM2023001': { name: 'Sarah Wilson', email: 'sarah@student.com', phone: '+91-9876543214', course: 'Computer Science', year: '2023', status: 'graduated' },
                'ADM2024005': { name: 'Mike Brown', email: 'mike@student.com', phone: '+91-9876543215', course: 'Electronics', year: '2024', status: 'inactive' }
            };
            
            const student = studentData[studentId];
            if (!student) {
                showToast('Student not found!', 'error');
                return;
            }
            
            dashboardContent.innerHTML = `
                <div class="px-4 py-6 sm:px-0 fade-in">
                    <div class="flex justify-between items-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-900">Edit Student - ${studentId}</h1>
                        <button onclick="showStudentManagement()" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md font-medium hover-lift">
                            ← Back to Student Management
                        </button>
                    </div>
                    
                    <div class="bg-white shadow-lg rounded-xl p-8 slide-up">
                        <form id="edit-student-form" class="space-y-6">
                            <!-- Personal Information -->
                            <div class="border-b border-gray-200 pb-6">
                                <h3 class="text-lg font-semibold text-gray-900 mb-4">Personal Information</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Full Name *</label>
                                        <input type="text" id="edit-name" value="${student.name}" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Email *</label>
                                        <input type="email" id="edit-email" value="${student.email}" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Phone Number *</label>
                                        <input type="tel" id="edit-phone" value="${student.phone}" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Student ID</label>
                                        <input type="text" value="${studentId}" disabled class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-500">
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Academic Information -->
                            <div class="border-b border-gray-200 pb-6">
                                <h3 class="text-lg font-semibold text-gray-900 mb-4">Academic Information</h3>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Course *</label>
                                        <select id="edit-course" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                            <option value="Computer Science" ${student.course === 'Computer Science' ? 'selected' : ''}>Computer Science</option>
                                            <option value="Electronics" ${student.course === 'Electronics' ? 'selected' : ''}>Electronics</option>
                                            <option value="Mechanical" ${student.course === 'Mechanical' ? 'selected' : ''}>Mechanical</option>
                                            <option value="Civil" ${student.course === 'Civil' ? 'selected' : ''}>Civil Engineering</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Academic Year *</label>
                                        <select id="edit-year" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                            <option value="2023" ${student.year === '2023' ? 'selected' : ''}>2023</option>
                                            <option value="2024" ${student.year === '2024' ? 'selected' : ''}>2024</option>
                                            <option value="2025" ${student.year === '2025' ? 'selected' : ''}>2025</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Status *</label>
                                        <select id="edit-status" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                            <option value="active" ${student.status === 'active' ? 'selected' : ''}>Active</option>
                                            <option value="inactive" ${student.status === 'inactive' ? 'selected' : ''}>Inactive</option>
                                            <option value="graduated" ${student.status === 'graduated' ? 'selected' : ''}>Graduated</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Profile Photo Update -->
                            <div class="pb-6">
                                <h3 class="text-lg font-semibold text-gray-900 mb-4">Profile Photo</h3>
                                <div class="flex items-center space-x-6">
                                    <div class="flex-shrink-0">
                                        <img id="current-photo" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face" alt="Current photo" class="w-20 h-20 rounded-full object-cover border-4 border-blue-100">
                                    </div>
                                    <div class="flex-1">
                                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-blue-400 transition-colors">
                                            <div id="edit-photo-upload-area">
                                                <i data-lucide="camera" class="h-8 w-8 text-gray-400 mx-auto mb-2"></i>
                                                <p class="text-sm text-gray-600 mb-2">Update profile photo</p>
                                                <p class="text-xs text-gray-500">PNG, JPG up to 5MB</p>
                                            </div>
                                            <input type="file" id="edit-photo-upload" accept="image/*" class="hidden" onchange="handleEditPhotoUpload(this)">
                                            <button type="button" onclick="document.getElementById('edit-photo-upload').click()" class="mt-2 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg text-sm font-medium hover-lift">
                                                Choose New Photo
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Action Buttons -->
                            <div class="flex justify-between items-center pt-6 border-t border-gray-200">
                                <button type="button" onclick="confirmDeleteStudent('${studentId}')" class="bg-red-600 hover:bg-red-700 text-white py-2 px-6 rounded-lg font-medium hover-lift">
                                    <i data-lucide="trash-2" class="h-4 w-4 inline mr-2"></i>
                                    Delete Student
                                </button>
                                <div class="flex space-x-4">
                                    <button type="button" onclick="showStudentManagement()" class="bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 px-6 rounded-lg font-medium hover-lift">
                                        Cancel
                                    </button>
                                    <button type="submit" class="btn-gradient text-white py-2 px-6 rounded-lg font-medium hover-lift">
                                        <i data-lucide="save" class="h-4 w-4 inline mr-2"></i>
                                        Save Changes
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            // Setup form submission
            document.getElementById('edit-student-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Show loading state
                const saveBtn = e.target.querySelector('button[type="submit"]');
                const originalText = saveBtn.innerHTML;
                saveBtn.innerHTML = '<i data-lucide="loader-2" class="h-4 w-4 inline mr-2 animate-spin"></i>Saving...';
                saveBtn.disabled = true;
                
                const updatedData = {
                    name: document.getElementById('edit-name').value,
                    email: document.getElementById('edit-email').value,
                    phone: document.getElementById('edit-phone').value,
                    course: document.getElementById('edit-course').value,
                    year: document.getElementById('edit-year').value,
                    status: document.getElementById('edit-status').value
                };
                
                // Simulate API call delay
                setTimeout(() => {
                    // Update the student data in memory (in real app, this would be API call)
                    if (studentData[studentId]) {
                        studentData[studentId] = { ...studentData[studentId], ...updatedData };
                    }
                    
                    // Restore button
                    saveBtn.innerHTML = originalText;
                    saveBtn.disabled = false;
                    
                    showToast(`Student ${studentId} updated successfully! 🎉`, 'success');
                    setTimeout(() => showStudentManagement(), 1500);
                }, 1000);
            });
            
            lucide.createIcons();
        }
        
        // Handle photo upload for edit form
        function handleEditPhotoUpload(input) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('current-photo').src = e.target.result;
                    document.getElementById('edit-photo-upload-area').innerHTML = `
                        <p class="text-sm text-green-600 font-medium">✓ New photo uploaded</p>
                        <p class="text-xs text-gray-500">${file.name}</p>
                    `;
                };
                reader.readAsDataURL(file);
                showToast(`New photo uploaded: ${file.name}`, 'success');
            }
        }
        
        // Confirm delete student
        function confirmDeleteStudent(studentId) {
            if (confirm(`Are you sure you want to permanently delete student ${studentId}? This action cannot be undone.`)) {
                showToast(`Student ${studentId} deleted successfully!`, 'success');
                setTimeout(() => showStudentManagement(), 1500);
            }
        }
        
        function deleteStudent(studentId) {
            if (confirm('Are you sure you want to delete this student?')) {
                showToast(`Student ${studentId} deleted successfully!`, 'success');
                // Would delete student from database
            }
        }
        
        function showAddStudent() {
            const dashboardContent = document.getElementById('dashboard-content');
            dashboardContent.innerHTML = `
                <div class="px-4 py-6 sm:px-0 fade-in">
                    <div class="flex justify-between items-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-900">Add New Student</h1>
                        <button onclick="showStudentManagement()" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md font-medium hover-lift">
                            ← Back to Student Management
                        </button>
                    </div>
                    
                    <div class="bg-white shadow-lg rounded-xl p-8 slide-up">
                        <form id="add-student-form" class="space-y-6">
                            <!-- Personal Information -->
                            <div class="border-b border-gray-200 pb-6">
                                <h3 class="text-lg font-semibold text-gray-900 mb-4">Personal Information</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Full Name *</label>
                                        <input type="text" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Email *</label>
                                        <input type="email" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Phone Number *</label>
                                        <input type="tel" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Date of Birth *</label>
                                        <input type="date" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Academic Information -->
                            <div class="border-b border-gray-200 pb-6">
                                <h3 class="text-lg font-semibold text-gray-900 mb-4">Academic Information</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Course *</label>
                                        <select required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                            <option value="">Select Course</option>
                                            <option value="Computer Science">Computer Science</option>
                                            <option value="Electronics">Electronics</option>
                                            <option value="Mechanical">Mechanical</option>
                                            <option value="Civil">Civil Engineering</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Academic Year *</label>
                                        <select required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                            <option value="">Select Year</option>
                                            <option value="2024">2024</option>
                                            <option value="2025">2025</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- File Upload Section -->
                            <div class="pb-6">
                                <h3 class="text-lg font-semibold text-gray-900 mb-4">Document Upload</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <!-- Profile Photo Upload -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Profile Photo</label>
                                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors">
                                            <div id="photo-preview" class="hidden mb-4">
                                                <img id="photo-img" class="w-24 h-24 rounded-full mx-auto object-cover border-4 border-blue-100">
                                            </div>
                                            <div id="photo-upload-area">
                                                <i data-lucide="camera" class="h-12 w-12 text-gray-400 mx-auto mb-2"></i>
                                                <p class="text-sm text-gray-600 mb-2">Click to upload profile photo</p>
                                                <p class="text-xs text-gray-500">PNG, JPG up to 5MB</p>
                                            </div>
                                            <input type="file" id="photo-upload" accept="image/*" class="hidden" onchange="handlePhotoUpload(this)">
                                            <button type="button" onclick="document.getElementById('photo-upload').click()" class="mt-2 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg text-sm font-medium hover-lift">
                                                Choose Photo
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <!-- Documents Upload -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Academic Documents</label>
                                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-green-400 transition-colors">
                                            <div id="docs-list" class="hidden mb-4 text-left">
                                                <!-- Uploaded documents will appear here -->
                                            </div>
                                            <div id="docs-upload-area">
                                                <i data-lucide="file-text" class="h-12 w-12 text-gray-400 mx-auto mb-2"></i>
                                                <p class="text-sm text-gray-600 mb-2">Upload academic documents</p>
                                                <p class="text-xs text-gray-500">PDF, DOC, DOCX up to 10MB each</p>
                                            </div>
                                            <input type="file" id="docs-upload" accept=".pdf,.doc,.docx" multiple class="hidden" onchange="handleDocsUpload(this)">
                                            <button type="button" onclick="document.getElementById('docs-upload').click()" class="mt-2 bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg text-sm font-medium hover-lift">
                                                Choose Documents
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Submit Button -->
                            <div class="flex justify-end space-x-4 pt-6 border-t border-gray-200">
                                <button type="button" onclick="showStudentManagement()" class="bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 px-6 rounded-lg font-medium hover-lift">
                                    Cancel
                                </button>
                                <button type="submit" class="btn-gradient text-white py-2 px-6 rounded-lg font-medium hover-lift">
                                    <i data-lucide="user-plus" class="h-4 w-4 inline mr-2"></i>
                                    Add Student
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            // Setup form submission
            document.getElementById('add-student-form').addEventListener('submit', function(e) {
                e.preventDefault();
                showToast('Student added successfully! 🎉', 'success');
                setTimeout(() => showStudentManagement(), 1500);
            });
            
            lucide.createIcons();
        }
        
        // File Upload Handlers
        function handlePhotoUpload(input) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('photo-img').src = e.target.result;
                    document.getElementById('photo-preview').classList.remove('hidden');
                    document.getElementById('photo-upload-area').innerHTML = `
                        <p class="text-sm text-green-600 font-medium">✓ Photo uploaded successfully</p>
                        <p class="text-xs text-gray-500">${file.name}</p>
                    `;
                };
                reader.readAsDataURL(file);
                showToast(`Photo uploaded: ${file.name}`, 'success');
            }
        }
        
        function handleDocsUpload(input) {
            const files = Array.from(input.files);
            const docsList = document.getElementById('docs-list');
            
            if (files.length > 0) {
                docsList.innerHTML = files.map(file => `
                    <div class="flex items-center justify-between p-2 bg-green-50 rounded mb-2">
                        <div class="flex items-center space-x-2">
                            <i data-lucide="file-text" class="h-4 w-4 text-green-600"></i>
                            <span class="text-sm text-gray-900">${file.name}</span>
                        </div>
                        <span class="text-xs text-green-600">✓</span>
                    </div>
                `).join('');
                
                docsList.classList.remove('hidden');
                document.getElementById('docs-upload-area').innerHTML = `
                    <p class="text-sm text-green-600 font-medium">✓ ${files.length} document(s) uploaded</p>
                    <p class="text-xs text-gray-500">Click to upload more</p>
                `;
                
                showToast(`${files.length} document(s) uploaded successfully`, 'success');
                lucide.createIcons();
            }
        }
        
        function showUserManagement() {
            const dashboardContent = document.getElementById('dashboard-content');
            dashboardContent.innerHTML = `
                <div class="px-4 py-6 sm:px-0 fade-in">
                    <div class="flex justify-between items-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-900">User Management</h1>
                        <button onclick="showDashboard(currentRole)" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md font-medium">
                            ← Back to Dashboard
                        </button>
                    </div>
                    
                    <!-- User Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="bg-white overflow-hidden shadow rounded-lg">
                            <div class="p-5">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0">
                                        <i data-lucide="users" class="h-8 w-8 text-blue-600"></i>
                                    </div>
                                    <div class="ml-5 w-0 flex-1">
                                        <dl>
                                            <dt class="text-sm font-medium text-gray-500 truncate">Total Users</dt>
                                            <dd class="text-lg font-medium text-gray-900">1,321</dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white overflow-hidden shadow rounded-lg">
                            <div class="p-5">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0">
                                        <i data-lucide="user-check" class="h-8 w-8 text-green-600"></i>
                                    </div>
                                    <div class="ml-5 w-0 flex-1">
                                        <dl>
                                            <dt class="text-sm font-medium text-gray-500 truncate">Active Users</dt>
                                            <dd class="text-lg font-medium text-gray-900">1,287</dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white overflow-hidden shadow rounded-lg">
                            <div class="p-5">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0">
                                        <i data-lucide="user-plus" class="h-8 w-8 text-purple-600"></i>
                                    </div>
                                    <div class="ml-5 w-0 flex-1">
                                        <dl>
                                            <dt class="text-sm font-medium text-gray-500 truncate">Pending Approvals</dt>
                                            <dd class="text-lg font-medium text-gray-900">34</dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div class="mb-6">
                        <div class="flex flex-wrap gap-4">
                            <button onclick="showAddUserForm()" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md font-medium">
                                <i data-lucide="user-plus" class="h-4 w-4 inline mr-2"></i>
                                Add New User
                            </button>
                            <button onclick="showBulkImport()" class="bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md font-medium">
                                <i data-lucide="upload" class="h-4 w-4 inline mr-2"></i>
                                Bulk Import
                            </button>
                            <button onclick="exportUserList()" class="bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-md font-medium">
                                <i data-lucide="download" class="h-4 w-4 inline mr-2"></i>
                                Export Users
                            </button>
                        </div>
                    </div>
                    
                    <!-- User List -->
                    <div class="bg-white shadow overflow-hidden sm:rounded-md">
                        <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
                            <h3 class="text-lg leading-6 font-medium text-gray-900">User Directory</h3>
                            <p class="mt-1 max-w-2xl text-sm text-gray-500">Manage all system users and their permissions</p>
                        </div>
                        
                        <!-- Search and Filter -->
                        <div class="px-4 py-3 border-b border-gray-200">
                            <div class="flex flex-col sm:flex-row gap-4">
                                <div class="flex-1">
                                    <input type="text" placeholder="Search users..." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <select class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        <option>All Roles</option>
                                        <option>Admin</option>
                                        <option>Staff</option>
                                        <option>Student</option>
                                    </select>
                                </div>
                                <div>
                                    <select class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        <option>All Status</option>
                                        <option>Active</option>
                                        <option>Inactive</option>
                                        <option>Pending</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <!-- User Table -->
                        <ul class="divide-y divide-gray-200">
                            <li class="px-4 py-4 hover:bg-gray-50">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0 h-10 w-10">
                                            <div class="h-10 w-10 rounded-full bg-blue-600 flex items-center justify-center">
                                                <span class="text-sm font-medium text-white">AD</span>
                                            </div>
                                        </div>
                                        <div class="ml-4">
                                            <div class="text-sm font-medium text-gray-900">Admin User</div>
                                            <div class="text-sm text-gray-500">admin@eduforge.com</div>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-4">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">Admin</span>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Active</span>
                                        <div class="flex space-x-2">
                                            <button onclick="editUser('admin')" class="text-blue-600 hover:text-blue-900 text-sm">Edit</button>
                                            <button onclick="toggleUserStatus('admin')" class="text-yellow-600 hover:text-yellow-900 text-sm">Suspend</button>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            
                            <li class="px-4 py-4 hover:bg-gray-50">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0 h-10 w-10">
                                            <div class="h-10 w-10 rounded-full bg-green-600 flex items-center justify-center">
                                                <span class="text-sm font-medium text-white">ST</span>
                                            </div>
                                        </div>
                                        <div class="ml-4">
                                            <div class="text-sm font-medium text-gray-900">Staff User</div>
                                            <div class="text-sm text-gray-500">staff@eduforge.com</div>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-4">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">Staff</span>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Active</span>
                                        <div class="flex space-x-2">
                                            <button onclick="editUser('staff')" class="text-blue-600 hover:text-blue-900 text-sm">Edit</button>
                                            <button onclick="toggleUserStatus('staff')" class="text-yellow-600 hover:text-yellow-900 text-sm">Suspend</button>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            
                            <li class="px-4 py-4 hover:bg-gray-50">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0 h-10 w-10">
                                            <div class="h-10 w-10 rounded-full bg-purple-600 flex items-center justify-center">
                                                <span class="text-sm font-medium text-white">JS</span>
                                            </div>
                                        </div>
                                        <div class="ml-4">
                                            <div class="text-sm font-medium text-gray-900">John Smith</div>
                                            <div class="text-sm text-gray-500">student@eduforge.com</div>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-4">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800">Student</span>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Active</span>
                                        <div class="flex space-x-2">
                                            <button onclick="editUser('student')" class="text-blue-600 hover:text-blue-900 text-sm">Edit</button>
                                            <button onclick="toggleUserStatus('student')" class="text-yellow-600 hover:text-yellow-900 text-sm">Suspend</button>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            
                            <li class="px-4 py-4 hover:bg-gray-50">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0 h-10 w-10">
                                            <div class="h-10 w-10 rounded-full bg-gray-400 flex items-center justify-center">
                                                <span class="text-sm font-medium text-white">MJ</span>
                                            </div>
                                        </div>
                                        <div class="ml-4">
                                            <div class="text-sm font-medium text-gray-900">Mike Johnson</div>
                                            <div class="text-sm text-gray-500">mike.j@eduforge.com</div>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-4">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">Staff</span>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">Pending</span>
                                        <div class="flex space-x-2">
                                            <button onclick="approveUser('mike')" class="text-green-600 hover:text-green-900 text-sm">Approve</button>
                                            <button onclick="rejectUser('mike')" class="text-red-600 hover:text-red-900 text-sm">Reject</button>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                        
                        <!-- Pagination -->
                        <div class="bg-white px-4 py-3 border-t border-gray-200 sm:px-6">
                            <div class="flex items-center justify-between">
                                <div class="flex-1 flex justify-between sm:hidden">
                                    <button class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">Previous</button>
                                    <button class="ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">Next</button>
                                </div>
                                <div class="hidden sm:flex-1 sm:flex sm:items-center sm:justify-between">
                                    <div>
                                        <p class="text-sm text-gray-700">Showing <span class="font-medium">1</span> to <span class="font-medium">4</span> of <span class="font-medium">1,321</span> results</p>
                                    </div>
                                    <div>
                                        <nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px">
                                            <button class="relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50">Previous</button>
                                            <button class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-blue-50 text-sm font-medium text-blue-600">1</button>
                                            <button class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50">2</button>
                                            <button class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50">3</button>
                                            <button class="relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50">Next</button>
                                        </nav>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            lucide.createIcons();
            showToast('User Management loaded successfully!', 'success');
        }
        
        function showReports() {
            const dashboardContent = document.getElementById('dashboard-content');
            dashboardContent.innerHTML = `
                <div class="px-4 py-6 sm:px-0 fade-in">
                    <div class="flex justify-between items-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-900">Analytics & Reports</h1>
                        <button onclick="showDashboard(currentRole)" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md font-medium">
                            ← Back to Dashboard
                        </button>
                    </div>
                    
                    <!-- Key Metrics -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="bg-gradient-to-r from-blue-500 to-blue-600 overflow-hidden shadow rounded-lg">
                            <div class="p-5 text-white">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0">
                                        <i data-lucide="users" class="h-8 w-8"></i>
                                    </div>
                                    <div class="ml-5 w-0 flex-1">
                                        <dl>
                                            <dt class="text-sm font-medium truncate opacity-75">Total Students</dt>
                                            <dd class="text-2xl font-bold">1,234</dd>
                                            <dd class="text-xs opacity-75">+12% from last month</dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-green-500 to-green-600 overflow-hidden shadow rounded-lg">
                            <div class="p-5 text-white">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0">
                                        <i data-lucide="dollar-sign" class="h-8 w-8"></i>
                                    </div>
                                    <div class="ml-5 w-0 flex-1">
                                        <dl>
                                            <dt class="text-sm font-medium truncate opacity-75">Revenue</dt>
                                            <dd class="text-2xl font-bold">₹98.7L</dd>
                                            <dd class="text-xs opacity-75">94% collection rate</dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-purple-500 to-purple-600 overflow-hidden shadow rounded-lg">
                            <div class="p-5 text-white">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0">
                                        <i data-lucide="calendar" class="h-8 w-8"></i>
                                    </div>
                                    <div class="ml-5 w-0 flex-1">
                                        <dl>
                                            <dt class="text-sm font-medium truncate opacity-75">Exams</dt>
                                            <dd class="text-2xl font-bold">12</dd>
                                            <dd class="text-xs opacity-75">5 upcoming</dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-orange-500 to-orange-600 overflow-hidden shadow rounded-lg">
                            <div class="p-5 text-white">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0">
                                        <i data-lucide="trending-up" class="h-8 w-8"></i>
                                    </div>
                                    <div class="ml-5 w-0 flex-1">
                                        <dl>
                                            <dt class="text-sm font-medium truncate opacity-75">Performance</dt>
                                            <dd class="text-2xl font-bold">8.2</dd>
                                            <dd class="text-xs opacity-75">Avg CGPA</dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Charts Section -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                        <!-- Fee Collection Chart -->
                        <div class="bg-white shadow rounded-lg">
                            <div class="p-6">
                                <h3 class="text-lg font-medium text-gray-900 mb-4">Monthly Fee Collection</h3>
                                <canvas id="feeChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                        
                        <!-- Student Distribution Chart -->
                        <div class="bg-white shadow rounded-lg">
                            <div class="p-6">
                                <h3 class="text-lg font-medium text-gray-900 mb-4">Students by Course</h3>
                                <canvas id="courseChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Performance Analytics -->
                    <div class="bg-white shadow rounded-lg mb-8">
                        <div class="p-6">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Academic Performance Trends</h3>
                            <canvas id="performanceChart" width="800" height="300"></canvas>
                        </div>
                    </div>
                    
                    <!-- Export Options -->
                    <div class="bg-white shadow rounded-lg">
                        <div class="px-4 py-5 sm:p-6">
                            <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">Export Reports</h3>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                <button onclick="exportReport('students')" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md font-medium text-sm">
                                    <i data-lucide="users" class="h-4 w-4 inline mr-1"></i>
                                    Student Report
                                </button>
                                <button onclick="exportReport('fees')" class="bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md font-medium text-sm">
                                    <i data-lucide="dollar-sign" class="h-4 w-4 inline mr-1"></i>
                                    Fee Report
                                </button>
                                <button onclick="exportReport('exams')" class="bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-md font-medium text-sm">
                                    <i data-lucide="calendar" class="h-4 w-4 inline mr-1"></i>
                                    Exam Report
                                </button>
                                <button onclick="exportReport('performance')" class="bg-orange-600 hover:bg-orange-700 text-white py-2 px-4 rounded-md font-medium text-sm">
                                    <i data-lucide="trending-up" class="h-4 w-4 inline mr-1"></i>
                                    Performance Report
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Initialize Charts
            setTimeout(() => {
                initializeCharts();
            }, 100);
            
            lucide.createIcons();
        }
        
        // Initialize Analytics Charts
        function initializeCharts() {
            // Fee Collection Chart
            const feeCtx = document.getElementById('feeChart');
            if (feeCtx) {
                new Chart(feeCtx, {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                        datasets: [{
                            label: 'Fee Collection (₹ Lakhs)',
                            data: [15, 18, 22, 16, 19, 25],
                            borderColor: 'rgb(34, 197, 94)',
                            backgroundColor: 'rgba(34, 197, 94, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { display: false } },
                        scales: { y: { beginAtZero: true } }
                    }
                });
            }
            
            // Course Distribution Chart
            const courseCtx = document.getElementById('courseChart');
            if (courseCtx) {
                new Chart(courseCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Computer Science', 'Electronics', 'Mechanical', 'Civil'],
                        datasets: [{
                            data: [450, 320, 280, 184],
                            backgroundColor: ['#3B82F6', '#10B981', '#F59E0B', '#EF4444']
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { position: 'bottom' } }
                    }
                });
            }
            
            // Performance Chart
            const performanceCtx = document.getElementById('performanceChart');
            if (performanceCtx) {
                new Chart(performanceCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Sem 1', 'Sem 2', 'Sem 3', 'Sem 4', 'Sem 5', 'Sem 6'],
                        datasets: [{
                            label: 'Average CGPA',
                            data: [7.8, 8.1, 8.3, 8.0, 8.2, 8.4],
                            backgroundColor: 'rgba(147, 51, 234, 0.8)',
                            borderColor: 'rgb(147, 51, 234)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { display: false } },
                        scales: { 
                            y: { 
                                beginAtZero: true,
                                max: 10
                            } 
                        }
                    }
                });
            }
        }
        
        // Export Report Function
        function exportReport(type) {
            const reports = {
                'students': 'Student Database Report',
                'fees': 'Fee Collection Report', 
                'exams': 'Examination Schedule Report',
                'performance': 'Academic Performance Report'
            };
            
            // Show loading state
            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = '<i data-lucide="loader" class="h-4 w-4 inline mr-1 animate-spin"></i>Exporting...';
            button.disabled = true;
            
            // Simulate export process
            setTimeout(() => {
                // Reset button
                button.innerHTML = originalText;
                button.disabled = false;
                lucide.createIcons();
                
                // Show success message with more details
                const fileName = `${type}-report-${new Date().toISOString().split('T')[0]}.pdf`;
                const fileSize = Math.floor(Math.random() * 500 + 100) + ' KB';
                
                showToast(`${reports[type]} exported successfully!`, 'success');
                
                // Show detailed export info
                setTimeout(() => {
                    alert(`📊 Export Complete!\\n\\n📁 File: ${fileName}\\n📏 Size: ${fileSize}\\n📅 Generated: ${new Date().toLocaleString()}\\n\\n✅ The report has been downloaded to your device.\\n\\n📋 Report includes:\\n• ${getReportDetails(type)}`);
                }, 500);
            }, 1500);
        }
        
        function getReportDetails(type) {
            const details = {
                'students': 'Student profiles, enrollment data, academic records\\n• Contact information, course assignments\\n• Attendance and performance metrics',
                'fees': 'Fee structure, payment history, outstanding dues\\n• Payment methods, transaction records\\n• Financial summaries and analytics',
                'exams': 'Exam schedules, room allocations, invigilator assignments\\n• Student registrations, time tables\\n• Examination rules and guidelines',
                'performance': 'Grade distributions, CGPA analysis, course-wise performance\\n• Semester comparisons, trend analysis\\n• Top performers and improvement areas'
            };
            return details[type] || 'Comprehensive data analysis and insights';
        }
        
        function showSystemSettings() {
            const dashboardContent = document.getElementById('dashboard-content');
            dashboardContent.innerHTML = `
                <div class="px-4 py-6 sm:px-0 fade-in">
                    <div class="flex justify-between items-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-900">System Settings</h1>
                        <button onclick="showDashboard(currentRole)" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md font-medium">
                            ← Back to Dashboard
                        </button>
                    </div>
                    
                    <!-- Settings Categories -->
                    <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
                        <!-- Settings Navigation -->
                        <div class="lg:col-span-1">
                            <nav class="space-y-1">
                                <button onclick="showSettingsCategory('general')" id="nav-general" class="settings-nav-btn bg-blue-50 text-blue-700 border-blue-200 w-full text-left px-3 py-2 rounded-md text-sm font-medium border">
                                    <i data-lucide="settings" class="h-4 w-4 inline mr-2"></i>
                                    General Settings
                                </button>
                                <button onclick="showSettingsCategory('email')" id="nav-email" class="settings-nav-btn text-gray-600 hover:text-gray-900 hover:bg-gray-50 w-full text-left px-3 py-2 rounded-md text-sm font-medium">
                                    <i data-lucide="mail" class="h-4 w-4 inline mr-2"></i>
                                    Email Configuration
                                </button>
                                <button onclick="showSettingsCategory('security')" id="nav-security" class="settings-nav-btn text-gray-600 hover:text-gray-900 hover:bg-gray-50 w-full text-left px-3 py-2 rounded-md text-sm font-medium">
                                    <i data-lucide="shield" class="h-4 w-4 inline mr-2"></i>
                                    Security Settings
                                </button>
                                <button onclick="showSettingsCategory('backup')" id="nav-backup" class="settings-nav-btn text-gray-600 hover:text-gray-900 hover:bg-gray-50 w-full text-left px-3 py-2 rounded-md text-sm font-medium">
                                    <i data-lucide="database" class="h-4 w-4 inline mr-2"></i>
                                    Backup & Restore
                                </button>
                                <button onclick="showSettingsCategory('notifications')" id="nav-notifications" class="settings-nav-btn text-gray-600 hover:text-gray-900 hover:bg-gray-50 w-full text-left px-3 py-2 rounded-md text-sm font-medium">
                                    <i data-lucide="bell" class="h-4 w-4 inline mr-2"></i>
                                    Notifications
                                </button>
                                <button onclick="showSettingsCategory('integrations')" id="nav-integrations" class="settings-nav-btn text-gray-600 hover:text-gray-900 hover:bg-gray-50 w-full text-left px-3 py-2 rounded-md text-sm font-medium">
                                    <i data-lucide="plug" class="h-4 w-4 inline mr-2"></i>
                                    Integrations
                                </button>
                            </nav>
                        </div>
                        
                        <!-- Settings Content -->
                        <div class="lg:col-span-3">
                            <div id="settings-content" class="bg-white shadow rounded-lg">
                                <!-- General Settings (Default) -->
                                <div class="px-4 py-5 sm:p-6">
                                    <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">General Settings</h3>
                                    
                                    <div class="space-y-6">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700">Institution Name</label>
                                            <input type="text" value="EduForge College of Technology" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        </div>
                                        
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700">Institution Code</label>
                                            <input type="text" value="EFC001" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        </div>
                                        
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700">Academic Year</label>
                                            <select class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                                <option>2024-2025</option>
                                                <option>2023-2024</option>
                                                <option>2022-2023</option>
                                            </select>
                                        </div>
                                        
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700">Time Zone</label>
                                            <select class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                                <option>Asia/Kolkata (UTC+05:30)</option>
                                                <option>UTC (UTC+00:00)</option>
                                                <option>America/New_York (UTC-05:00)</option>
                                            </select>
                                        </div>
                                        
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700">Default Language</label>
                                            <select class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                                <option>English</option>
                                                <option>Hindi</option>
                                                <option>Spanish</option>
                                                <option>French</option>
                                            </select>
                                        </div>
                                        
                                        <div class="flex items-center">
                                            <input type="checkbox" id="maintenance-mode" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                            <label for="maintenance-mode" class="ml-2 block text-sm text-gray-900">Enable Maintenance Mode</label>
                                        </div>
                                        
                                        <div class="flex items-center">
                                            <input type="checkbox" id="auto-backup" checked class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                            <label for="auto-backup" class="ml-2 block text-sm text-gray-900">Enable Automatic Backups</label>
                                        </div>
                                    </div>
                                    
                                    <div class="mt-6 flex justify-end space-x-3">
                                        <button onclick="resetSettings()" class="bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 px-4 rounded-md font-medium">
                                            Reset to Default
                                        </button>
                                        <button onclick="saveSettings('general')" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md font-medium">
                                            Save Changes
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            lucide.createIcons();
            showToast('System Settings loaded successfully!', 'success');
        }
        
        // System Settings Helper Functions
        function showSettingsCategory(category) {
            // Update navigation
            document.querySelectorAll('.settings-nav-btn').forEach(btn => {
                btn.className = 'settings-nav-btn text-gray-600 hover:text-gray-900 hover:bg-gray-50 w-full text-left px-3 py-2 rounded-md text-sm font-medium';
            });
            document.getElementById(`nav-${category}`).className = 'settings-nav-btn bg-blue-50 text-blue-700 border-blue-200 w-full text-left px-3 py-2 rounded-md text-sm font-medium border';
            
            const settingsContent = document.getElementById('settings-content');
            
            switch(category) {
                case 'general':
                    // Already loaded by default
                    break;
                case 'email':
                    settingsContent.innerHTML = `
                        <div class="px-4 py-5 sm:p-6">
                            <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">Email Configuration</h3>
                            <div class="space-y-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">SMTP Server</label>
                                    <input type="text" value="smtp.gmail.com" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">SMTP Port</label>
                                    <input type="number" value="587" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Email Username</label>
                                    <input type="email" value="noreply@eduforge.com" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Email Password</label>
                                    <input type="password" value="••••••••" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="email-ssl" checked class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                    <label for="email-ssl" class="ml-2 block text-sm text-gray-900">Use SSL/TLS</label>
                                </div>
                            </div>
                            <div class="mt-6 flex justify-end space-x-3">
                                <button onclick="testEmailConfig()" class="bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md font-medium">Test Connection</button>
                                <button onclick="saveSettings('email')" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md font-medium">Save Changes</button>
                            </div>
                        </div>
                    `;
                    break;
                case 'security':
                    settingsContent.innerHTML = `
                        <div class="px-4 py-5 sm:p-6">
                            <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">Security Settings</h3>
                            <div class="space-y-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Password Policy</label>
                                    <select class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        <option>Strong (8+ chars, mixed case, numbers, symbols)</option>
                                        <option>Medium (6+ chars, mixed case, numbers)</option>
                                        <option>Basic (4+ chars)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Session Timeout (minutes)</label>
                                    <input type="number" value="30" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="two-factor" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                    <label for="two-factor" class="ml-2 block text-sm text-gray-900">Enable Two-Factor Authentication</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="login-attempts" checked class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                    <label for="login-attempts" class="ml-2 block text-sm text-gray-900">Lock account after 5 failed login attempts</label>
                                </div>
                            </div>
                            <div class="mt-6 flex justify-end">
                                <button onclick="saveSettings('security')" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md font-medium">Save Changes</button>
                            </div>
                        </div>
                    `;
                    break;
                case 'backup':
                    settingsContent.innerHTML = `
                        <div class="px-4 py-5 sm:p-6">
                            <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">Backup & Restore</h3>
                            <div class="space-y-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Backup Frequency</label>
                                    <select class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        <option>Daily</option>
                                        <option>Weekly</option>
                                        <option>Monthly</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Backup Time</label>
                                    <input type="time" value="02:00" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Retention Period (days)</label>
                                    <input type="number" value="30" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-gray-900 mb-2">Recent Backups</h4>
                                    <div class="space-y-2 text-sm text-gray-600">
                                        <div class="flex justify-between">
                                            <span>backup-2024-10-25.sql</span>
                                            <span>2.3 MB</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span>backup-2024-10-24.sql</span>
                                            <span>2.1 MB</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-6 flex justify-end space-x-3">
                                <button onclick="createBackup()" class="bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md font-medium">Create Backup Now</button>
                                <button onclick="saveSettings('backup')" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md font-medium">Save Changes</button>
                            </div>
                        </div>
                    `;
                    break;
                default:
                    settingsContent.innerHTML = `
                        <div class="px-4 py-5 sm:p-6">
                            <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">${category.charAt(0).toUpperCase() + category.slice(1)} Settings</h3>
                            <p class="text-gray-500">This settings category is under development.</p>
                        </div>
                    `;
            }
            
            lucide.createIcons();
        }
        
        function saveSettings(category) {
            showToast(`${category.charAt(0).toUpperCase() + category.slice(1)} settings saved successfully!`, 'success');
        }
        
        function resetSettings() {
            if (confirm('Are you sure you want to reset all settings to default values?')) {
                showToast('Settings reset to default values', 'info');
            }
        }
        
        function testEmailConfig() {
            showToast('Email configuration test successful!', 'success');
        }
        
        function createBackup() {
            showToast('Backup created successfully!', 'success');
        }
        
        // User Management Helper Functions
        function showAddUserForm() {
            showToast('Add User form would open here', 'info');
        }
        
        function showBulkImport() {
            showToast('Bulk Import feature would open here', 'info');
        }
        
        function exportUserList() {
            showToast('User list exported successfully!', 'success');
        }
        
        function editUser(userId) {
            showToast(`Edit user ${userId} form would open here`, 'info');
        }
        
        function toggleUserStatus(userId) {
            showToast(`User ${userId} status toggled`, 'info');
        }
        
        function approveUser(userId) {
            showToast(`User ${userId} approved successfully!`, 'success');
        }
        
        function rejectUser(userId) {
            showToast(`User ${userId} rejected`, 'warning');
        }
        
        // Exam Results Functions
        function viewResults(examId) {
            showToast(`Loading results for ${examId}...`, 'info');
            setTimeout(() => {
                alert(`📊 Exam Results - ${examId}\\n\\n📈 Statistics:\\n• Total Students: 45\\n• Pass Rate: 87%\\n• Average Score: 78.5%\\n• Highest Score: 96%\\n\\n🏆 Top Performers:\\n1. Emma Miller - 96%\\n2. John Smith - 94%\\n3. Sarah Johnson - 91%\\n\\n✅ Results have been published to student portal.`);
            }, 1000);
        }
        
        function viewDetailedRecord(studentId) {
            showToast(`Loading detailed record for ${studentId}...`, 'info');
            setTimeout(() => {
                alert(`📋 Student Record - ${studentId}\\n\\n🎓 Academic Summary:\\n• Current CGPA: 8.7/10\\n• Credits Completed: 120/160\\n• Attendance: 92%\\n• Semester: 6th\\n\\n📚 Recent Grades:\\n• Data Structures: A+\\n• Algorithms: A\\n• Database Systems: A+\\n• Web Development: A\\n\\n🏅 Achievements:\\n• Dean's List (3 semesters)\\n• Programming Competition Winner\\n• Research Paper Published`);
            }, 1000);
        }
        
        function generateTranscript(studentId) {
            showToast('Generating official transcript...', 'info');
            setTimeout(() => {
                showToast('Transcript generated successfully!', 'success');
                alert(`📜 Official Transcript Generated\\n\\nStudent: ${studentId}\\nFile: transcript-${studentId}-${new Date().toISOString().split('T')[0]}.pdf\\nSize: 245 KB\\n\\n✅ Transcript has been downloaded and sent to student email.`);
            }, 2000);
        }
        
        // Fee Management Helper Functions
        function viewReceipt(transactionId) {
            const payment = feePayments.find(p => p.id === transactionId);
            if (payment) {
                showToast('Loading receipt...', 'info');
                setTimeout(() => {
                    alert(`🧾 Payment Receipt\\n\\nTransaction ID: ${payment.id}\\nStudent: ${payment.studentName} (${payment.studentId})\\nAmount: ₹${payment.amount.toLocaleString()}\\nDate: ${payment.date} ${payment.time}\\nMethod: ${payment.method}\\nStatus: ${payment.status}\\n\\n✅ Receipt downloaded successfully.`);
                }, 1000);
            }
        }
        
        function sendReceipt(transactionId) {
            const payment = feePayments.find(p => p.id === transactionId);
            if (payment) {
                showToast(`Receipt sent to ${payment.studentName}`, 'success');
            }
        }
        
        function showAllTransactions() {
            showToast(`Showing all ${feePayments.length} transactions`, 'info');
        }
        
        function showGenerateReceipt() {
            showToast('Receipt generation feature loaded', 'info');
        }
        
        function showSendReminder() {
            showToast('Fee reminder system loaded', 'info');
        }
        
        // Automated Timetable Management with AI-Powered Conflict Resolution
        function showTimetableManagement() {
            const dashboardContent = document.getElementById('dashboard-content');
            dashboardContent.innerHTML = `
                <div class="px-4 py-6 sm:px-0 fade-in">
                    <div class="flex justify-between items-center mb-8">
                        <div>
                            <h1 class="text-3xl font-bold text-gray-900">🤖 Smart Timetable Generator</h1>
                            <p class="text-gray-600 mt-2">AI-powered scheduling with intelligent conflict resolution</p>
                        </div>
                        <button onclick="showDashboard(currentRole)" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md font-medium">
                            ← Back to Dashboard
                        </button>
                    </div>
                    
                    <!-- Control Panel -->
                    <div class="bg-white shadow-lg rounded-xl p-6 mb-8">
                        <div class="flex flex-wrap items-center justify-between gap-4">
                            <div class="flex items-center space-x-4">
                                <button onclick="generateTimetable()" class="bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white px-6 py-3 rounded-lg font-medium flex items-center">
                                    <i data-lucide="zap" class="h-5 w-5 mr-2"></i>
                                    Generate Smart Timetable
                                </button>
                                <button onclick="showFacultyAvailability()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium">
                                    <i data-lucide="users" class="h-4 w-4 mr-2 inline"></i>
                                    Faculty Availability
                                </button>
                                <button onclick="showCourseConstraints()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium">
                                    <i data-lucide="book-open" class="h-4 w-4 mr-2 inline"></i>
                                    Course Constraints
                                </button>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span class="text-sm text-gray-600">Conflicts:</span>
                                <span id="conflict-count" class="bg-red-100 text-red-800 px-2 py-1 rounded-full text-sm font-medium">0</span>
                                <button onclick="exportTimetable()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium">
                                    <i data-lucide="download" class="h-4 w-4 mr-2 inline"></i>
                                    Export
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Timetable Grid -->
                    <div class="bg-white shadow-lg rounded-xl overflow-hidden">
                        <div class="p-6 border-b border-gray-200">
                            <h2 class="text-xl font-semibold text-gray-900">Weekly Timetable</h2>
                            <p class="text-gray-600 mt-1">Drag and drop to make manual adjustments</p>
                        </div>
                        <div class="overflow-x-auto">
                            <div id="timetable-grid" class="min-w-full">
                                <!-- Timetable will be generated here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Generation Status -->
                    <div id="generation-status" class="hidden mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <div class="flex items-center">
                            <div class="spinner mr-3"></div>
                            <div>
                                <h3 class="text-lg font-medium text-blue-900">Generating Optimal Timetable...</h3>
                                <p id="status-text" class="text-blue-700">Analyzing course requirements and faculty availability...</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- AI Reasoning Log -->
                    <div id="reasoning-panel" class="hidden mt-6 bg-green-50 border border-green-200 rounded-lg p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-semibold text-green-900">🧠 AI Scheduling Reasoning</h3>
                            <button onclick="toggleReasoningPanel()" class="text-green-600 hover:text-green-800">
                                <i data-lucide="minimize-2" class="h-5 w-5"></i>
                            </button>
                        </div>
                        <div id="reasoning-content" class="space-y-2 max-h-64 overflow-y-auto">
                            <!-- Reasoning logs will be populated here -->
                        </div>
                        <div class="mt-4 pt-4 border-t border-green-200">
                            <button onclick="exportReasoningLog()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium">
                                <i data-lucide="download" class="h-4 w-4 mr-2 inline"></i>
                                Export Reasoning Log
                            </button>
                        </div>
                    </div>
                    
                    <!-- JSON Output Panel -->
                    <div id="json-panel" class="hidden mt-6 bg-gray-50 border border-gray-200 rounded-lg p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-semibold text-gray-900">📋 Generated JSON Output</h3>
                            <button onclick="toggleJSONPanel()" class="text-gray-600 hover:text-gray-800">
                                <i data-lucide="minimize-2" class="h-5 w-5"></i>
                            </button>
                        </div>
                        <pre id="json-content" class="bg-white p-4 rounded border text-sm overflow-x-auto max-h-64 overflow-y-auto">
                            <!-- JSON output will be populated here -->
                        </pre>
                        <div class="mt-4 pt-4 border-t border-gray-200">
                            <button onclick="copyJSONOutput()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg text-sm font-medium mr-2">
                                <i data-lucide="copy" class="h-4 w-4 mr-2 inline"></i>
                                Copy JSON
                            </button>
                            <button onclick="downloadJSONOutput()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium">
                                <i data-lucide="download" class="h-4 w-4 mr-2 inline"></i>
                                Download JSON
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            initializeTimetableData();
            renderTimetableGrid();
            lucide.createIcons();
        }
        
        // Timetable Data Structures and AI Engine
        let timetableData = {
            courses: [],
            faculty: [],
            rooms: [],
            timeSlots: [],
            schedule: {},
            constraints: {},
            conflicts: []
        };
        
        function initializeTimetableData() {
            // Enhanced course data with difficulty levels and lab requirements
            timetableData.courses = [
                { 
                    id: 'CS101', name: 'Data Structures', department: 'Computer Science', 
                    credits: 4, duration: 60, faculty: 'Dr. Smith', students: 45,
                    difficulty: 'hard', type: 'theory', preferredTime: 'morning',
                    section: 'CS-A', blocksRequired: 1
                },
                { 
                    id: 'CS102', name: 'Algorithms', department: 'Computer Science', 
                    credits: 3, duration: 60, faculty: 'Prof. Johnson', students: 38,
                    difficulty: 'hard', type: 'theory', preferredTime: 'morning',
                    section: 'CS-A', blocksRequired: 1
                },
                { 
                    id: 'CS103', name: 'Database Systems (Lab)', department: 'Computer Science', 
                    credits: 4, duration: 120, faculty: 'Dr. Brown', students: 42,
                    difficulty: 'medium', type: 'lab', preferredTime: 'any',
                    section: 'CS-A', blocksRequired: 2
                },
                { 
                    id: 'CS104', name: 'Communication Skills', department: 'General', 
                    credits: 2, duration: 60, faculty: 'Dr. Evans', students: 45,
                    difficulty: 'easy', type: 'theory', preferredTime: 'afternoon',
                    section: 'CS-A', blocksRequired: 1
                },
                { 
                    id: 'CS105', name: 'Environmental Studies', department: 'General', 
                    credits: 2, duration: 60, faculty: 'Prof. Green', students: 45,
                    difficulty: 'easy', type: 'theory', preferredTime: 'afternoon',
                    section: 'CS-A', blocksRequired: 1
                },
                { 
                    id: 'EE201', name: 'Circuit Analysis', department: 'Electrical Engineering', 
                    credits: 4, duration: 60, faculty: 'Dr. Wilson', students: 35,
                    difficulty: 'hard', type: 'theory', preferredTime: 'morning',
                    section: 'EE-A', blocksRequired: 1
                },
                { 
                    id: 'ME301', name: 'Thermodynamics', department: 'Mechanical Engineering', 
                    credits: 3, duration: 60, faculty: 'Prof. Davis', students: 40,
                    difficulty: 'medium', type: 'theory', preferredTime: 'morning',
                    section: 'ME-A', blocksRequired: 1
                },
                { 
                    id: 'CH401', name: 'Organic Chemistry (Lab)', department: 'Chemistry', 
                    credits: 4, duration: 120, faculty: 'Dr. Miller', students: 30,
                    difficulty: 'medium', type: 'lab', preferredTime: 'any',
                    section: 'CH-A', blocksRequired: 2
                }
            ];
            
            // Enhanced faculty availability data
            timetableData.faculty = [
                { 
                    id: 'smith', name: 'Dr. Smith', department: 'Computer Science', 
                    availability: {
                        'monday': ['09:00-13:00', '14:00-17:00'], 
                        'tuesday': ['09:00-13:00', '14:00-16:00'],
                        'wednesday': ['10:00-13:00', '14:00-17:00'], 
                        'thursday': ['09:00-13:00', '14:00-16:00'],
                        'friday': ['09:00-12:00', '14:00-17:00']
                    },
                    unavailable: { 'wednesday': ['11:00-13:00'] } // Specific unavailability
                },
                { 
                    id: 'johnson', name: 'Prof. Johnson', department: 'Computer Science', 
                    availability: {
                        'monday': ['10:00-13:00', '15:00-17:00'], 
                        'tuesday': ['09:00-12:00', '14:00-17:00'],
                        'wednesday': ['09:00-13:00', '15:00-17:00'], 
                        'thursday': ['10:00-13:00', '14:00-16:00'],
                        'friday': ['09:00-13:00', '14:00-16:00']
                    }
                },
                { 
                    id: 'brown', name: 'Dr. Brown', department: 'Computer Science', 
                    availability: {
                        'monday': ['09:00-12:00', '14:00-17:00'], 
                        'tuesday': ['10:00-13:00', '15:00-17:00'],
                        'wednesday': ['09:00-10:00', '14:00-17:00'], // Limited Wednesday availability
                        'thursday': ['09:00-12:00', '15:00-17:00'],
                        'friday': ['10:00-13:00', '14:00-17:00']
                    }
                },
                { 
                    id: 'evans', name: 'Dr. Evans', department: 'General', 
                    availability: {
                        'monday': ['14:00-17:00'], 'tuesday': ['14:00-17:00'],
                        'wednesday': ['14:00-17:00'], 'thursday': ['14:00-17:00'],
                        'friday': ['14:00-17:00']
                    }
                },
                { 
                    id: 'green', name: 'Prof. Green', department: 'General', 
                    availability: {
                        'monday': ['15:00-17:00'], 'tuesday': ['15:00-17:00'],
                        'wednesday': ['15:00-17:00'], 'thursday': ['15:00-17:00'],
                        'friday': ['15:00-17:00']
                    }
                },
                { 
                    id: 'wilson', name: 'Dr. Wilson', department: 'Electrical Engineering', 
                    availability: {
                        'monday': ['09:00-13:00', '14:00-16:00'], 
                        'tuesday': ['09:00-13:00', '14:00-17:00'],
                        'wednesday': ['09:00-13:00', '14:00-17:00'], 
                        'thursday': ['09:00-13:00', '14:00-16:00'],
                        'friday': ['09:00-12:00', '14:00-17:00']
                    }
                },
                { 
                    id: 'davis', name: 'Prof. Davis', department: 'Mechanical Engineering', 
                    availability: {
                        'monday': ['09:00-13:00', '14:00-17:00'], 
                        'tuesday': ['10:00-13:00', '14:00-17:00'],
                        'wednesday': ['09:00-13:00', '14:00-17:00'], 
                        'thursday': ['09:00-13:00', '14:00-16:00'],
                        'friday': ['09:00-13:00', '14:00-17:00']
                    }
                },
                { 
                    id: 'miller', name: 'Dr. Miller', department: 'Chemistry', 
                    availability: {
                        'monday': ['09:00-13:00', '14:00-17:00'], 
                        'tuesday': ['09:00-13:00', '14:00-17:00'],
                        'wednesday': ['09:00-13:00', '14:00-17:00'], 
                        'thursday': ['09:00-13:00', '14:00-17:00'],
                        'friday': ['09:00-13:00', '14:00-17:00']
                    }
                }
            ];
            
            // Enhanced room data
            timetableData.rooms = [
                { id: 'LAB-1', name: 'Computer Lab 1', capacity: 50, type: 'lab', equipment: ['projector', 'computers'], department: 'Computer Science' },
                { id: 'LAB-2', name: 'Computer Lab 2', capacity: 45, type: 'lab', equipment: ['projector', 'computers'], department: 'Computer Science' },
                { id: 'LH-201', name: 'Lecture Hall 201', capacity: 100, type: 'lecture', equipment: ['projector', 'audio'], department: 'General' },
                { id: 'LH-202', name: 'Lecture Hall 202', capacity: 80, type: 'lecture', equipment: ['projector', 'audio'], department: 'General' },
                { id: 'LH-203', name: 'Lecture Hall 203', capacity: 60, type: 'lecture', equipment: ['projector'], department: 'General' },
                { id: 'CHEM-LAB', name: 'Chemistry Lab', capacity: 35, type: 'lab', equipment: ['fume_hood', 'chemicals'], department: 'Chemistry' }
            ];
            
            // 8-block schedule with lunch break after 4th period (compact formatting)
            timetableData.timeSlots = [
                'I (10:00am-10:50am)', 'II (10:50am-11:40am)', 'III (11:40am-12:30pm)', 'IV (12:30pm-01:20pm)',
                'LUNCH (1:20pm-2:10pm)', 'V (2:10pm-03:00pm)', 'VI (03:00pm-03:45pm)', 'VII (03:45pm-04:30pm)'
            ];
            
            // Initialize reasoning log
            timetableData.reasoningLog = [];
        }
        
        function renderTimetableGrid() {
            const grid = document.getElementById('timetable-grid');
            const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
            const timeSlots = timetableData.timeSlots;
            
            let html = `
                <div class="w-full">
                    <table class="w-full table-fixed divide-y divide-gray-200 border border-gray-300 shadow-lg rounded-lg overflow-hidden">
                        <thead class="bg-gradient-to-r from-gray-50 to-gray-100">
                            <tr>
                                <th class="w-24 px-2 py-3 text-center text-sm font-bold text-gray-700 uppercase tracking-wider border-r border-gray-300">Days</th>
            `;
            
            // Time periods as column headers - calculate width to fit perfectly
            const columnWidth = `${Math.floor((100 - 12) / timeSlots.length)}%`; // 12% for days column, rest divided equally
            timeSlots.forEach(timeSlot => {
                const displayTimeSlot = formatTimeSlot(timeSlot);
                html += `<th class="px-1 py-3 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-r border-gray-300 last:border-r-0" style="width: ${columnWidth}">
                    <div class="flex flex-col items-center">
                        <div class="font-bold text-xs">${displayTimeSlot.period}</div>
                        <div class="text-xs text-gray-600 mt-1 leading-tight">${displayTimeSlot.time}</div>
                    </div>
                </th>`;
            });
            
            html += `
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
            `;
            
            // Days as rows
            days.forEach(day => {
                html += `<tr class="hover:bg-gray-50 transition-colors">
                    <td class="w-24 px-2 py-3 text-center text-sm font-bold text-gray-800 bg-gradient-to-r from-gray-50 to-gray-100 border-r border-gray-300">
                        ${day}
                    </td>
                `;
                
                timeSlots.forEach(timeSlot => {
                    const scheduleKey = `${day.toLowerCase()}-${timeSlot}`;
                    const classInfo = timetableData.schedule[scheduleKey];
                    
                    if (classInfo) {
                        if (classInfo.isLunchBreak) {
                            // Special styling for lunch break - premium orange design
                            html += `
                                <td class="px-1 py-2 border-r border-gray-300 last:border-r-0" style="width: ${columnWidth}">
                                    <div class="bg-gradient-to-br from-orange-300 to-orange-400 border-2 border-orange-500 rounded-lg p-2 h-16 flex items-center justify-center shadow-md">
                                        <div class="text-center">
                                            <div class="text-xs font-bold text-orange-900">🍽️ LUNCH</div>
                                            <div class="text-xs text-orange-700">Cafeteria</div>
                                        </div>
                                    </div>
                                </td>
                            `;
                        } else {
                            // Premium class styling
                            const conflictClass = timetableData.conflicts.includes(scheduleKey) ? 'bg-gradient-to-br from-red-100 to-red-200 border-red-400' : 'bg-gradient-to-br from-blue-100 to-blue-200 border-blue-400';
                            const occurrenceInfo = classInfo.occurrence ? ` (${classInfo.occurrence})` : '';
                            html += `
                                <td class="px-1 py-2 border-r border-gray-300 last:border-r-0" style="width: ${columnWidth}">
                                    <div class="draggable-class ${conflictClass} border-2 rounded-lg p-2 cursor-move hover:shadow-lg transition-all relative group h-16" 
                                         draggable="true" 
                                         data-schedule-key="${scheduleKey}"
                                         ondragstart="handleDragStart(event)"
                                         ondragover="handleDragOver(event)"
                                         ondrop="handleDrop(event)">
                                        <div class="text-xs font-bold text-gray-900 truncate leading-tight">${classInfo.course}${occurrenceInfo}</div>
                                        <div class="text-xs text-gray-700 truncate leading-tight">${classInfo.faculty}</div>
                                        <div class="text-xs text-gray-600 truncate leading-tight">${classInfo.room}</div>
                                        ${timetableData.conflicts.includes(scheduleKey) ? '<div class="text-xs text-red-700 font-medium">⚠️</div>' : ''}
                                        <div class="absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity">
                                            <button onclick="editTimeSlot('${scheduleKey}')" class="text-gray-500 hover:text-gray-700 text-xs bg-white rounded-full p-1 shadow-sm">
                                                <i data-lucide="edit-3" class="h-2 w-2"></i>
                                            </button>
                                        </div>
                                    </div>
                                </td>
                            `;
                        }
                    } else {
                        html += `
                            <td class="px-1 py-2 border-r border-gray-300 last:border-r-0" style="width: ${columnWidth}">
                                <div class="empty-slot border-2 border-dashed border-gray-300 rounded-lg p-2 h-16 flex items-center justify-center text-gray-400 hover:border-gray-400 hover:bg-gray-50 transition-all"
                                     ondragover="handleDragOver(event)"
                                     ondrop="handleDrop(event)"
                                     data-schedule-key="${scheduleKey}">
                                    <span class="text-xs font-medium">Drop</span>
                                </div>
                            </td>
                        `;
                    }
                });
                
                html += `</tr>`;
            });
            
            html += `
                        </tbody>
                    </table>
                </div>
            `;
            
            grid.innerHTML = html;
        }
        
        function formatTimeSlot(timeSlot) {
            // Format time slots for better display in the time column
            if (timeSlot.includes('LUNCH')) {
                return {
                    period: 'LUNCH',
                    time: '1:20pm-2:10pm'
                };
            }
            
            // Extract period and time from format like "I (10:00am-10:50am)"
            const match = timeSlot.match(/^([IVX]+)\s*\((.+)\)$/);
            if (match) {
                return {
                    period: match[1],
                    time: match[2]
                };
            }
            
            // Fallback
            return {
                period: timeSlot.split(' ')[0],
                time: timeSlot.includes('(') ? timeSlot.split('(')[1].replace(')', '') : ''
            };
        }
        
        // AI-Powered Timetable Generation Engine
        function generateTimetable() {
            const statusDiv = document.getElementById('generation-status');
            const statusText = document.getElementById('status-text');
            
            statusDiv.classList.remove('hidden');
            
            // Simulate AI processing steps (faster)
            const steps = [
                'Analyzing course requirements and faculty availability...',
                'Checking room capacities and equipment needs...',
                'Applying scheduling constraints and preferences...',
                'Running conflict detection algorithms...',
                'Optimizing schedule using genetic algorithms...',
                'Resolving conflicts with intelligent backtracking...',
                'Finalizing optimal timetable solution...'
            ];
            
            let currentStep = 0;
            const stepInterval = setInterval(() => {
                if (currentStep < steps.length) {
                    statusText.textContent = steps[currentStep];
                    currentStep++;
                } else {
                    clearInterval(stepInterval);
                    
                    // Generate the actual timetable
                    generateOptimalSchedule();
                    
                    statusText.textContent = 'Timetable generated successfully!';
                    setTimeout(() => {
                        statusDiv.classList.add('hidden');
                        const scheduledCount = Object.keys(timetableData.schedule).length;
                        const totalCourses = timetableData.courses.length;
                        showToast(`🎉 Smart timetable generated! ${scheduledCount}/${totalCourses} courses scheduled with ${timetableData.conflicts.length} conflicts!`, 'success');
                    }, 500);
                }
            }, 300); // Faster animation
        }
        
        function generateOptimalSchedule() {
            // Step 1: Clear any previously generated timetable
            timetableData.schedule = {};
            timetableData.conflicts = [];
            timetableData.reasoningLog = [];
            timetableData.facultyDailyHours = {};
            
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];
            const allTimeSlots = timetableData.timeSlots;
            const lunchBreakSlot = 'LUNCH (1:20pm-2:10pm)';
            
            timetableData.reasoningLog.push('🚀 Generating fresh randomized timetable (10:00am - 4:30pm)...');
            timetableData.reasoningLog.push('🍽️ Lunch break locked: 1:20pm - 2:10pm after 4th period (no classes will be scheduled during this time)');
            
            // Step 2: Lock lunch break slots for all days
            days.forEach(day => {
                const lunchKey = `${day}-${lunchBreakSlot}`;
                timetableData.schedule[lunchKey] = {
                    course: 'LUNCH BREAK',
                    courseId: 'LUNCH',
                    faculty: '',
                    room: 'Cafeteria',
                    type: 'break',
                    isLunchBreak: true
                };
            });
            
            // Step 3: Create a pool of subjects for random distribution (7 lectures per day, 35 total)
            const subjectPool = createRandomizedSubjectPool();
            
            // Step 4: Generate fresh randomized timetable for all days
            generateRandomizedWeeklyTimetable(days, allTimeSlots, subjectPool, lunchBreakSlot);
            
            // Step 5: Generate summary
            const summary = generateRandomizedSummary();
            timetableData.reasoningLog.push('📊 ' + summary);
            
            // Step 6: Generate JSON output
            const jsonOutput = generateJSONOutput();
            console.log('Generated Randomized Timetable JSON:', jsonOutput);
            
            // Update UI instantly
            document.getElementById('conflict-count').textContent = timetableData.conflicts.length;
            renderTimetableGrid();
            showReasoningLog();
        }
        
        function createRandomizedSubjectPool() {
            // Create a larger pool of subjects to ensure variety and 7 subjects per day
            const baseSubjects = timetableData.courses.map(course => ({
                name: course.name,
                faculty: course.faculty,
                room: assignOptimalRoom(course).name,
                type: course.type || 'theory',
                courseId: course.id
            }));
            
            // Expand the pool to have enough subjects for 7 per day across 5 days (35 total)
            const expandedPool = [];
            const totalSlotsNeeded = 35; // 7 subjects × 5 days
            
            // Add each subject multiple times to reach 35 slots
            for (let i = 0; i < totalSlotsNeeded; i++) {
                const subject = baseSubjects[i % baseSubjects.length];
                expandedPool.push({
                    ...subject,
                    occurrence: Math.floor(i / baseSubjects.length) + 1
                });
            }
            
            // Fisher-Yates shuffle for true randomization
            return fisherYatesShuffle(expandedPool);
        }
        
        function fisherYatesShuffle(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }
        
        function generateRandomizedWeeklyTimetable(days, timeSlots, subjectPool, lunchBreakSlot) {
            // Separate subjects by difficulty for intelligent placement
            const hardSubjects = subjectPool.filter(s => {
                const course = timetableData.courses.find(c => c.id === s.courseId);
                return course && course.difficulty === 'hard';
            });
            const mediumSubjects = subjectPool.filter(s => {
                const course = timetableData.courses.find(c => c.id === s.courseId);
                return course && course.difficulty === 'medium';
            });
            const easySubjects = subjectPool.filter(s => {
                const course = timetableData.courses.find(c => c.id === s.courseId);
                return course && course.difficulty === 'easy';
            });
            
            timetableData.reasoningLog.push(`🧠 AI Scheduling Strategy: Hard subjects in periods I-IV (morning), easy subjects in periods V-VII (afternoon)`);
            
            // Define time periods (excluding lunch break) - 7 lecture periods
            const morningSlots = ['I (10:00am-10:50am)', 'II (10:50am-11:40am)', 'III (11:40am-12:30pm)', 'IV (12:30pm-01:20pm)'];
            const afternoonSlots = ['V (2:10pm-03:00pm)', 'VI (03:00pm-03:45pm)', 'VII (03:45pm-04:30pm)'];
            
            let hardIndex = 0, mediumIndex = 0, easyIndex = 0;
            
            // Generate exactly 7 subjects per day with intelligent placement (excluding lunch)
            days.forEach(day => {
                timetableData.reasoningLog.push(`📅 Generating ${day.charAt(0).toUpperCase() + day.slice(1)} with intelligent subject placement...`);
                
                // Morning slots (Periods I-IV) - prioritize hard subjects
                morningSlots.forEach(timeSlot => {
                    const scheduleKey = `${day}-${timeSlot}`;
                    let subject = null;
                    let reasoning = '';
                    
                    if (hardIndex < hardSubjects.length) {
                        // Morning slots for hard subjects
                        subject = hardSubjects[hardIndex++];
                        reasoning = `morning period (optimal for difficult subjects when students are most alert)`;
                    } else if (mediumIndex < mediumSubjects.length) {
                        // Fill with medium subjects if needed
                        subject = mediumSubjects[mediumIndex++];
                        reasoning = `morning period (good concentration period)`;
                    } else if (easyIndex < easySubjects.length) {
                        // Fill with easy subjects if needed
                        subject = easySubjects[easyIndex++];
                        reasoning = `morning period (flexible placement)`;
                    }
                    
                    if (subject) {
                        timetableData.schedule[scheduleKey] = {
                            course: subject.name,
                            courseId: subject.courseId,
                            faculty: subject.faculty,
                            room: subject.room,
                            type: subject.type,
                            occurrence: subject.occurrence
                        };
                        
                        const course = timetableData.courses.find(c => c.id === subject.courseId);
                        const difficultyIcon = course.difficulty === 'hard' ? '🔥' : course.difficulty === 'medium' ? '⚡' : '🌱';
                        timetableData.reasoningLog.push(`✅ ${difficultyIcon} ${subject.name} (${subject.occurrence}) → ${day.charAt(0).toUpperCase() + day.slice(1)} ${timeSlot} - ${reasoning}`);
                    }
                });
                
                // LUNCH BREAK already locked - just log it
                timetableData.reasoningLog.push(`🍽️ Lunch break: 1:20pm - 2:10pm on ${day.charAt(0).toUpperCase() + day.slice(1)} - LOCKED (no classes scheduled)`);
                
                // Afternoon slots (Periods V-VII) - prioritize easy subjects
                afternoonSlots.forEach(timeSlot => {
                    const scheduleKey = `${day}-${timeSlot}`;
                    let subject = null;
                    let reasoning = '';
                    
                    if (easyIndex < easySubjects.length) {
                        // Afternoon slots for easy subjects
                        subject = easySubjects[easyIndex++];
                        reasoning = `post-lunch period (ideal for lighter subjects when energy is lower)`;
                    } else if (mediumIndex < mediumSubjects.length) {
                        // Fill with medium subjects if needed
                        subject = mediumSubjects[mediumIndex++];
                        reasoning = `afternoon period (acceptable for medium difficulty)`;
                    } else if (hardIndex < hardSubjects.length) {
                        // Last resort: hard subjects in afternoon
                        subject = hardSubjects[hardIndex++];
                        reasoning = `afternoon period (not optimal but necessary for schedule completion)`;
                    }
                    
                    if (subject) {
                        timetableData.schedule[scheduleKey] = {
                            course: subject.name,
                            courseId: subject.courseId,
                            faculty: subject.faculty,
                            room: subject.room,
                            type: subject.type,
                            occurrence: subject.occurrence
                        };
                        
                        const course = timetableData.courses.find(c => c.id === subject.courseId);
                        const difficultyIcon = course.difficulty === 'hard' ? '🔥' : course.difficulty === 'medium' ? '⚡' : '🌱';
                        timetableData.reasoningLog.push(`✅ ${difficultyIcon} ${subject.name} (${subject.occurrence}) → ${day.charAt(0).toUpperCase() + day.slice(1)} ${timeSlot} - ${reasoning}`);
                    }
                });
            });
            
            const totalScheduled = Object.keys(timetableData.schedule).filter(key => !timetableData.schedule[key].isLunchBreak).length;
            const lunchBreaks = Object.keys(timetableData.schedule).filter(key => timetableData.schedule[key].isLunchBreak).length;
            timetableData.reasoningLog.push(`🔄 Intelligent scheduling complete! Generated ${totalScheduled} class assignments + ${lunchBreaks} lunch breaks.`);
            timetableData.reasoningLog.push(`📊 Schedule follows educational best practices: Hard subjects in periods I-IV, lunch break after 4th period, easy subjects in periods V-VII.`);
        }
        
        function generateRandomizedSummary() {
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];
            const scheduledSlots = Object.keys(timetableData.schedule).length;
            const uniqueSubjects = new Set(Object.values(timetableData.schedule).map(s => s.courseId)).size;
            
            // Count subjects per day
            const dailyCounts = {};
            days.forEach(day => {
                dailyCounts[day] = Object.keys(timetableData.schedule).filter(key => key.startsWith(day)).length;
            });
            
            let summary = `Fresh randomized timetable generated! `;
            summary += `${uniqueSubjects} unique subjects distributed across 5 days. `;
            summary += `Total slots filled: ${scheduledSlots}. `;
            summary += `Daily distribution: ${Object.entries(dailyCounts).map(([day, count]) => `${day.charAt(0).toUpperCase() + day.slice(1)}: ${count}`).join(', ')}. `;
            summary += `Each day has exactly 6 subjects with randomized order.`;
            
            return summary;
        }
        
        function createWeeklyDistributionPlan() {
            const distribution = {};
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];
            
            timetableData.courses.forEach(course => {
                // Determine how many times per week each subject should appear
                let frequency = 2; // Default 2 times per week
                if (course.credits >= 4 || course.difficulty === 'hard') {
                    frequency = 3; // Hard/high-credit subjects appear 3 times
                }
                if (course.type === 'lab') {
                    frequency = 2; // Labs appear 2 times (but take 2 blocks each time)
                }
                
                distribution[course.id] = {
                    course: course,
                    frequency: frequency,
                    scheduledDays: [],
                    totalScheduled: 0
                };
                
                timetableData.reasoningLog.push(`📋 ${course.name}: Planned ${frequency} times per week (${course.difficulty} difficulty, ${course.credits} credits)`);
            });
            
            return distribution;
        }
        
        function scheduleFullWeekTimetable(days, morningSlots, afternoonSlots, distribution) {
            let totalSchedulingAttempts = 0;
            const maxAttempts = 100;
            
            // Schedule each subject according to its distribution plan
            Object.values(distribution).forEach(subjectPlan => {
                const course = subjectPlan.course;
                
                for (let occurrence = 0; occurrence < subjectPlan.frequency; occurrence++) {
                    let scheduled = false;
                    let attempts = 0;
                    
                    while (!scheduled && attempts < maxAttempts) {
                        const result = scheduleSubjectOccurrence(course, days, morningSlots, afternoonSlots, subjectPlan, occurrence);
                        if (result.success) {
                            subjectPlan.scheduledDays.push(result.day);
                            subjectPlan.totalScheduled++;
                            timetableData.reasoningLog.push(result.reasoning);
                            scheduled = true;
                        }
                        attempts++;
                        totalSchedulingAttempts++;
                    }
                    
                    if (!scheduled) {
                        timetableData.reasoningLog.push(`⚠️ Could not schedule occurrence ${occurrence + 1} of ${course.name} after ${attempts} attempts`);
                    }
                }
            });
            
            timetableData.reasoningLog.push(`🔄 Total scheduling attempts: ${totalSchedulingAttempts}`);
            return true;
        }
        
        function scheduleSubjectOccurrence(course, days, morningSlots, afternoonSlots, subjectPlan, occurrence) {
            const faculty = timetableData.faculty.find(f => f.name === course.faculty);
            
            // Determine preferred time slots based on course characteristics
            let preferredSlots = [];
            if (course.difficulty === 'hard' || course.preferredTime === 'morning') {
                preferredSlots = morningSlots;
            } else if (course.preferredTime === 'afternoon') {
                preferredSlots = afternoonSlots;
            } else {
                preferredSlots = [...morningSlots, ...afternoonSlots];
            }
            
            // Create a balanced day selection (avoid consecutive days and ensure distribution)
            const availableDays = getBalancedDayOptions(days, subjectPlan.scheduledDays, occurrence);
            
            // Try to schedule on each available day
            for (const day of availableDays) {
                // Check daily limits
                if (getDailySubjectCount('CS-A', day) >= 6) continue;
                if (getFacultyDailyHours(faculty.name, day) >= 4) continue;
                
                for (const timeSlot of preferredSlots) {
                    if (course.blocksRequired === 2) {
                        // Handle 2-block continuous scheduling for labs
                        const result = scheduleTwoBlockCourse(course, day, timeSlot, faculty);
                        if (result.success) {
                            updateFacultyDailyHours(faculty.name, day, 2);
                            return {
                                success: true,
                                day: day,
                                reasoning: result.reasoning + ` (Occurrence ${occurrence + 1}/${subjectPlan.frequency})`
                            };
                        }
                    } else {
                        // Handle single block scheduling
                        const result = scheduleSingleBlockCourse(course, day, timeSlot, faculty);
                        if (result.success) {
                            updateFacultyDailyHours(faculty.name, day, 1);
                            return {
                                success: true,
                                day: day,
                                reasoning: result.reasoning + ` (Occurrence ${occurrence + 1}/${subjectPlan.frequency})`
                            };
                        }
                    }
                }
            }
            
            return {
                success: false,
                reasoning: `No suitable slot found for ${course.name} occurrence ${occurrence + 1}`
            };
        }
        
        function getBalancedDayOptions(allDays, scheduledDays, occurrence) {
            // For first occurrence, prefer early in the week
            if (occurrence === 0) {
                return ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];
            }
            
            // For subsequent occurrences, avoid consecutive days and ensure distribution
            const availableDays = allDays.filter(day => {
                // Don't schedule on same day twice
                if (scheduledDays.includes(day)) return false;
                
                // Avoid consecutive days
                const dayIndex = allDays.indexOf(day);
                for (const scheduledDay of scheduledDays) {
                    const scheduledIndex = allDays.indexOf(scheduledDay);
                    if (Math.abs(dayIndex - scheduledIndex) === 1) return false;
                }
                
                return true;
            });
            
            // If no non-consecutive days available, allow any remaining days
            return availableDays.length > 0 ? availableDays : allDays.filter(day => !scheduledDays.includes(day));
        }
        
        function getFacultyDailyHours(facultyName, day) {
            return timetableData.facultyDailyHours[facultyName] ? timetableData.facultyDailyHours[facultyName][day] || 0 : 0;
        }
        
        function updateFacultyDailyHours(facultyName, day, hours) {
            if (!timetableData.facultyDailyHours[facultyName]) {
                timetableData.facultyDailyHours[facultyName] = {};
            }
            timetableData.facultyDailyHours[facultyName][day] = (timetableData.facultyDailyHours[facultyName][day] || 0) + hours;
        }
        
        function generateWeeklySummary() {
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];
            const scheduledSlots = Object.keys(timetableData.schedule).length;
            const totalSubjects = new Set(Object.values(timetableData.schedule).map(s => s.courseId)).size;
            
            // Count subjects per day
            const dailyCounts = {};
            days.forEach(day => {
                dailyCounts[day] = Object.keys(timetableData.schedule).filter(key => key.startsWith(day)).length;
            });
            
            // Check faculty workload
            const facultyWorkload = {};
            Object.entries(timetableData.facultyDailyHours).forEach(([faculty, hours]) => {
                const totalHours = Object.values(hours).reduce((sum, h) => sum + h, 0);
                facultyWorkload[faculty] = totalHours;
            });
            
            let summary = `Optimized ${totalSubjects} subjects across 5 days with ${timetableData.conflicts.length} conflicts. `;
            summary += `Total scheduled slots: ${scheduledSlots}. `;
            summary += `Daily distribution: ${Object.entries(dailyCounts).map(([day, count]) => `${day.charAt(0).toUpperCase() + day.slice(1)}: ${count}`).join(', ')}. `;
            summary += `Balanced heavy subjects early in the week and lighter ones later.`;
            
            return summary;
        }
        
        function scheduleIntelligentCourse(course, days, morningSlots, afternoonSlots) {
            const faculty = timetableData.faculty.find(f => f.name === course.faculty);
            
            // Determine preferred time slots based on course characteristics
            let preferredSlots = [];
            if (course.difficulty === 'hard' || course.preferredTime === 'morning') {
                preferredSlots = morningSlots;
            } else if (course.preferredTime === 'afternoon') {
                preferredSlots = afternoonSlots;
            } else {
                preferredSlots = [...morningSlots, ...afternoonSlots];
            }
            
            // Try to schedule the course
            for (const day of days) {
                for (const timeSlot of preferredSlots) {
                    if (course.blocksRequired === 2) {
                        // Handle 2-block continuous scheduling for labs
                        const result = scheduleTwoBlockCourse(course, day, timeSlot, faculty);
                        if (result.success) {
                            return {
                                scheduled: true,
                                reasoning: result.reasoning
                            };
                        }
                    } else {
                        // Handle single block scheduling
                        const result = scheduleSingleBlockCourse(course, day, timeSlot, faculty);
                        if (result.success) {
                            return {
                                scheduled: true,
                                reasoning: result.reasoning
                            };
                        }
                    }
                }
            }
            
            return {
                scheduled: false,
                reasoning: `No suitable time slot found considering faculty availability and constraints`
            };
        }
        
        function scheduleTwoBlockCourse(course, day, startTimeSlot, faculty) {
            const timeSlots = timetableData.timeSlots;
            const startIndex = timeSlots.indexOf(startTimeSlot);
            
            if (startIndex === -1 || startIndex >= timeSlots.length - 1) {
                return { success: false };
            }
            
            const endTimeSlot = timeSlots[startIndex + 1];
            const scheduleKey1 = `${day}-${startTimeSlot}`;
            const scheduleKey2 = `${day}-${endTimeSlot}`;
            
            // Check if both slots are available
            if (timetableData.schedule[scheduleKey1] || timetableData.schedule[scheduleKey2]) {
                return { success: false };
            }
            
            // Check faculty availability for both slots
            if (!isFacultyAvailableForSlot(faculty, day, startTimeSlot) || 
                !isFacultyAvailableForSlot(faculty, day, endTimeSlot)) {
                return { success: false };
            }
            
            // Check if it's lunch time (avoid scheduling across lunch break)
            if (startTimeSlot === '12:00-13:00' || endTimeSlot === '14:00-15:00') {
                return { success: false };
            }
            
            // Assign appropriate room
            const room = assignOptimalRoom(course);
            
            // Schedule both blocks
            const classInfo = {
                course: course.name,
                courseId: course.id,
                faculty: course.faculty,
                room: room.name,
                students: course.students,
                type: course.type
            };
            
            timetableData.schedule[scheduleKey1] = { ...classInfo, block: '1/2' };
            timetableData.schedule[scheduleKey2] = { ...classInfo, block: '2/2' };
            
            return {
                success: true,
                reasoning: `✅ ${course.name} scheduled for 2 continuous blocks on ${day.charAt(0).toUpperCase() + day.slice(1)} ${startTimeSlot}-${endTimeSlot.split('-')[1]} in ${room.name} (Lab requirement satisfied)`
            };
        }
        
        function scheduleSingleBlockCourse(course, day, timeSlot, faculty) {
            const scheduleKey = `${day}-${timeSlot}`;
            
            // Check if slot is available
            if (timetableData.schedule[scheduleKey]) {
                return { success: false };
            }
            
            // Check faculty availability
            if (!isFacultyAvailableForSlot(faculty, day, timeSlot)) {
                return { success: false };
            }
            
            // Check daily subject limit (max 6 subjects per day per section)
            const dailyCount = getDailySubjectCount(course.section, day);
            if (dailyCount >= 6) {
                return { success: false };
            }
            
            // Check if same subject already scheduled today for this section
            if (isSubjectAlreadyScheduledToday(course, day)) {
                return { success: false };
            }
            
            // Assign appropriate room
            const room = assignOptimalRoom(course);
            
            // Schedule the course
            timetableData.schedule[scheduleKey] = {
                course: course.name,
                courseId: course.id,
                faculty: course.faculty,
                room: room.name,
                students: course.students,
                type: course.type,
                section: course.section
            };
            
            const timePreference = course.difficulty === 'hard' ? 'morning (optimal for difficult subjects)' : 
                                 course.preferredTime === 'afternoon' ? 'afternoon (as preferred)' : 'available slot';
            
            return {
                success: true,
                reasoning: `✅ ${course.name} scheduled on ${day.charAt(0).toUpperCase() + day.slice(1)} ${timeSlot} in ${room.name} - ${timePreference}`
            };
        }
        
        function isFacultyAvailableForSlot(faculty, day, timeSlot) {
            if (!faculty || !faculty.availability[day]) return false;
            
            const [startTime] = timeSlot.split('-');
            
            // Check general availability
            const isGenerallyAvailable = faculty.availability[day].some(slot => {
                const [slotStart, slotEnd] = slot.split('-');
                return startTime >= slotStart && startTime < slotEnd;
            });
            
            // Check specific unavailability
            if (faculty.unavailable && faculty.unavailable[day]) {
                const isSpecificallyUnavailable = faculty.unavailable[day].some(slot => {
                    const [slotStart, slotEnd] = slot.split('-');
                    return startTime >= slotStart && startTime < slotEnd;
                });
                return isGenerallyAvailable && !isSpecificallyUnavailable;
            }
            
            return isGenerallyAvailable;
        }
        
        function getDailySubjectCount(section, day) {
            return Object.keys(timetableData.schedule).filter(key => {
                const [scheduleDay] = key.split('-');
                const classInfo = timetableData.schedule[key];
                return scheduleDay === day && classInfo.section === section;
            }).length;
        }
        
        function isSubjectAlreadyScheduledToday(course, day) {
            return Object.keys(timetableData.schedule).some(key => {
                const [scheduleDay] = key.split('-');
                const classInfo = timetableData.schedule[key];
                return scheduleDay === day && classInfo.courseId === course.id;
            });
        }
        
        function generateJSONOutput() {
            const output = {};
            const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
            
            days.forEach(day => {
                output[day] = [];
                timetableData.timeSlots.forEach(timeSlot => {
                    const scheduleKey = `${day.toLowerCase()}-${timeSlot}`;
                    const classInfo = timetableData.schedule[scheduleKey];
                    
                    if (classInfo) {
                        output[day].push({
                            time: timeSlot,
                            subject: classInfo.course,
                            faculty: classInfo.faculty,
                            room: classInfo.room,
                            type: classInfo.type || 'theory',
                            block: classInfo.block || '1/1'
                        });
                    }
                });
            });
            
            return output;
        }
        
        function showReasoningLog() {
            if (timetableData.reasoningLog.length > 0) {
                const reasoningPanel = document.getElementById('reasoning-panel');
                const reasoningContent = document.getElementById('reasoning-content');
                const jsonPanel = document.getElementById('json-panel');
                const jsonContent = document.getElementById('json-content');
                
                // Show reasoning panel
                const logHtml = timetableData.reasoningLog.map(log => 
                    `<div class="text-sm p-2 rounded ${log.includes('✅') ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}">${log}</div>`
                ).join('');
                reasoningContent.innerHTML = logHtml;
                reasoningPanel.classList.remove('hidden');
                
                // Show JSON panel
                const jsonOutput = generateJSONOutput();
                jsonContent.textContent = JSON.stringify(jsonOutput, null, 2);
                jsonPanel.classList.remove('hidden');
                
                showToast(`🧠 AI scheduling completed! View detailed reasoning and JSON output below.`, 'success');
                console.log('Scheduling Reasoning:', timetableData.reasoningLog);
                console.log('Generated JSON:', jsonOutput);
            }
        }
        
        function toggleReasoningPanel() {
            const panel = document.getElementById('reasoning-panel');
            panel.classList.add('hidden');
        }
        
        function toggleJSONPanel() {
            const panel = document.getElementById('json-panel');
            panel.classList.add('hidden');
        }
        
        function exportReasoningLog() {
            const reasoning = timetableData.reasoningLog.join('\n');
            const blob = new Blob([reasoning], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'timetable-reasoning-log.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showToast('Reasoning log exported successfully!', 'success');
        }
        
        function copyJSONOutput() {
            const jsonContent = document.getElementById('json-content').textContent;
            navigator.clipboard.writeText(jsonContent).then(() => {
                showToast('JSON copied to clipboard!', 'success');
            }).catch(() => {
                showToast('Failed to copy JSON', 'error');
            });
        }
        
        function downloadJSONOutput() {
            const jsonContent = document.getElementById('json-content').textContent;
            const blob = new Blob([jsonContent], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'smart-timetable.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showToast('JSON file downloaded successfully!', 'success');
        }
        
        // Export Timetable Functionality
        function exportTimetable() {
            if (Object.keys(timetableData.schedule).length === 0) {
                showToast('❌ Please generate a timetable first before exporting!', 'error');
                return;
            }
            
            showModal('Export Timetable', `
                <div class="space-y-6">
                    <div class="text-center">
                        <div class="text-lg font-semibold text-gray-800 mb-2">Choose Export Format</div>
                        <p class="text-sm text-gray-600">Select your preferred format to export the timetable</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <button onclick="exportAsJSON()" class="export-option bg-blue-50 hover:bg-blue-100 border-2 border-blue-200 rounded-lg p-4 text-center transition-all">
                            <div class="text-2xl mb-2">📄</div>
                            <div class="font-medium text-blue-800">JSON</div>
                            <div class="text-xs text-blue-600">Data Format</div>
                        </button>
                        
                        <button onclick="exportAsCSV()" class="export-option bg-green-50 hover:bg-green-100 border-2 border-green-200 rounded-lg p-4 text-center transition-all">
                            <div class="text-2xl mb-2">📊</div>
                            <div class="font-medium text-green-800">CSV</div>
                            <div class="text-xs text-green-600">Excel Compatible</div>
                        </button>
                        
                        <button onclick="exportAsPDF()" class="export-option bg-purple-50 hover:bg-purple-100 border-2 border-purple-200 rounded-lg p-4 text-center transition-all">
                            <div class="text-2xl mb-2">📋</div>
                            <div class="font-medium text-purple-800">PDF</div>
                            <div class="text-xs text-purple-600">Print Ready</div>
                        </button>
                    </div>
                    
                    <div class="flex justify-end space-x-3 pt-4 border-t">
                        <button onclick="closeModal()" class="bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 px-4 rounded-md font-medium">
                            Cancel
                        </button>
                    </div>
                </div>
            `);
        }
        
        function exportAsJSON() {
            const jsonOutput = generateJSONOutput();
            const blob = new Blob([JSON.stringify(jsonOutput, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `timetable-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            closeModal();
            showToast('📄 Timetable exported as JSON successfully!', 'success');
        }
        
        function exportAsCSV() {
            const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
            const timeSlots = timetableData.timeSlots;
            
            // Create CSV header with Days as first column, then time periods
            let csvContent = 'Days';
            timeSlots.forEach(timeSlot => {
                const displayTimeSlot = formatTimeSlot(timeSlot);
                csvContent += `,"${displayTimeSlot.period} (${displayTimeSlot.time})"`;
            });
            csvContent += '\n';
            
            // Create rows for each day
            days.forEach(day => {
                let row = `"${day}"`;
                
                timeSlots.forEach(timeSlot => {
                    const scheduleKey = `${day.toLowerCase()}-${timeSlot}`;
                    const classInfo = timetableData.schedule[scheduleKey];
                    
                    if (classInfo) {
                        if (classInfo.isLunchBreak) {
                            row += ',"LUNCH BREAK"';
                        } else {
                            const cellContent = `${classInfo.course} - ${classInfo.faculty} - ${classInfo.room}`;
                            row += `,"${cellContent}"`;
                        }
                    } else {
                        row += ',""';
                    }
                });
                
                csvContent += row + '\n';
            });
            
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `timetable-${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            closeModal();
            showToast('📊 Timetable exported as CSV successfully!', 'success');
        }
        
        function exportAsPDF() {
            // Create a printable version
            const printWindow = window.open('', '_blank');
            const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
            
            let htmlContent = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Weekly Timetable</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .header { text-align: center; margin-bottom: 30px; }
                        .timetable { width: 100%; border-collapse: collapse; margin: 20px 0; }
                        .timetable th, .timetable td { border: 1px solid #ddd; padding: 12px; text-align: center; }
                        .timetable th { background-color: #f5f5f5; font-weight: bold; }
                        .lunch-break { background-color: #fed7aa; font-weight: bold; }
                        .class-cell { background-color: #dbeafe; }
                        .time-cell { background-color: #f9fafb; font-weight: bold; }
                        @media print { body { margin: 0; } }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>Weekly Timetable</h1>
                        <p>Generated on ${new Date().toLocaleDateString()}</p>
                    </div>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th>Time</th>
                                ${days.map(day => `<th>${day}</th>`).join('')}
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            timetableData.timeSlots.forEach(timeSlot => {
                const displayTimeSlot = formatTimeSlot(timeSlot);
                htmlContent += `<tr>
                    <td class="time-cell">${displayTimeSlot.period}<br><small>${displayTimeSlot.time}</small></td>
                `;
                
                days.forEach(day => {
                    const scheduleKey = `${day.toLowerCase()}-${timeSlot}`;
                    const classInfo = timetableData.schedule[scheduleKey];
                    
                    if (classInfo) {
                        if (classInfo.isLunchBreak) {
                            htmlContent += '<td class="lunch-break">🍽️ LUNCH BREAK<br><small>1:20pm - 2:10pm</small></td>';
                        } else {
                            htmlContent += `<td class="class-cell">
                                <strong>${classInfo.course}</strong><br>
                                <small>${classInfo.faculty}</small><br>
                                <small>${classInfo.room}</small>
                            </td>`;
                        }
                    } else {
                        htmlContent += '<td>-</td>';
                    }
                });
                
                htmlContent += '</tr>';
            });
            
            htmlContent += `
                        </tbody>
                    </table>
                </body>
                </html>
            `;
            
            printWindow.document.write(htmlContent);
            printWindow.document.close();
            
            setTimeout(() => {
                printWindow.print();
                closeModal();
                showToast('📋 Timetable ready for printing/PDF export!', 'success');
            }, 500);
        }
        
        // Enhanced Export Functions for the new buttons
        function performExport(format) {
            if (Object.keys(timetableData.schedule).length === 0) {
                showToast('❌ Please generate a timetable first before exporting!', 'error');
                return;
            }
            
            switch(format) {
                case 'pdf':
                    exportAsPDF();
                    break;
                case 'excel':
                    exportAsCSV();
                    break;
                case 'print':
                    printTimetable();
                    break;
                default:
                    showToast('❌ Unknown export format!', 'error');
            }
        }
        
        function printTimetable() {
            // Create a clean print version
            const printWindow = window.open('', '_blank');
            const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
            const timeSlots = timetableData.timeSlots;
            
            let htmlContent = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Weekly Timetable - Print Version</title>
                    <style>
                        body { 
                            font-family: 'Arial', sans-serif; 
                            margin: 15px; 
                            color: #333;
                        }
                        .header { 
                            text-align: center; 
                            margin-bottom: 25px; 
                            border-bottom: 2px solid #ddd;
                            padding-bottom: 15px;
                        }
                        .header h1 { 
                            margin: 0; 
                            color: #2563eb; 
                            font-size: 28px;
                        }
                        .header p { 
                            margin: 5px 0 0 0; 
                            color: #666; 
                            font-size: 14px;
                        }
                        .timetable { 
                            width: 100%; 
                            border-collapse: collapse; 
                            margin: 20px 0;
                            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                        }
                        .timetable th, .timetable td { 
                            border: 1px solid #ddd; 
                            padding: 10px; 
                            text-align: center; 
                            vertical-align: middle;
                        }
                        .timetable th { 
                            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
                            font-weight: bold; 
                            color: #374151;
                            font-size: 12px;
                        }
                        .day-header { 
                            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
                            font-weight: bold; 
                            color: #1f2937;
                        }
                        .lunch-break { 
                            background: linear-gradient(135deg, #fed7aa 0%, #fdba74 100%);
                            font-weight: bold; 
                            color: #9a3412;
                        }
                        .class-cell { 
                            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
                            font-size: 11px;
                            line-height: 1.3;
                        }
                        .class-title { 
                            font-weight: bold; 
                            color: #1e40af;
                            margin-bottom: 2px;
                        }
                        .class-details { 
                            color: #374151; 
                            font-size: 10px;
                        }
                        .time-header { 
                            writing-mode: vertical-rl; 
                            text-orientation: mixed;
                            font-size: 10px;
                            min-width: 60px;
                        }
                        @media print { 
                            body { margin: 0; }
                            .timetable { page-break-inside: avoid; }
                        }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>📅 Weekly Timetable</h1>
                        <p>Generated on ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}</p>
                    </div>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th class="day-header">Days</th>
            `;
            
            // Time periods as column headers
            timeSlots.forEach(timeSlot => {
                const displayTimeSlot = formatTimeSlot(timeSlot);
                htmlContent += `<th class="time-header">
                    <div><strong>${displayTimeSlot.period}</strong></div>
                    <div style="font-size: 9px; margin-top: 2px;">${displayTimeSlot.time}</div>
                </th>`;
            });
            
            htmlContent += `
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            // Days as rows
            days.forEach(day => {
                htmlContent += `<tr>
                    <td class="day-header"><strong>${day}</strong></td>
                `;
                
                timeSlots.forEach(timeSlot => {
                    const scheduleKey = `${day.toLowerCase()}-${timeSlot}`;
                    const classInfo = timetableData.schedule[scheduleKey];
                    
                    if (classInfo) {
                        if (classInfo.isLunchBreak) {
                            htmlContent += '<td class="lunch-break">🍽️<br><strong>LUNCH</strong><br><small>1:20pm-2:10pm</small></td>';
                        } else {
                            htmlContent += `<td class="class-cell">
                                <div class="class-title">${classInfo.course}</div>
                                <div class="class-details">${classInfo.faculty}</div>
                                <div class="class-details">${classInfo.room}</div>
                            </td>`;
                        }
                    } else {
                        htmlContent += '<td style="background: #f9fafb; color: #9ca3af;">-</td>';
                    }
                });
                
                htmlContent += '</tr>';
            });
            
            htmlContent += `
                        </tbody>
                    </table>
                    <div style="text-align: center; margin-top: 20px; font-size: 12px; color: #666;">
                        <p>EduForge ERP - Smart Timetable Generator</p>
                    </div>
                </body>
                </html>
            `;
            
            printWindow.document.write(htmlContent);
            printWindow.document.close();
            
            setTimeout(() => {
                printWindow.print();
                showToast('🖨️ Print preview opened successfully!', 'success');
            }, 500);
        }
        
        // Editable Time Slots Functionality
        function editTimeSlot(scheduleKey) {
            const classInfo = timetableData.schedule[scheduleKey];
            if (!classInfo) return;
            
            const [day, currentTime] = scheduleKey.split('-');
            
            showModal('Edit Time Slot', `
                <div class="space-y-4">
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-blue-900">${classInfo.course}</h4>
                        <p class="text-blue-700 text-sm">${classInfo.faculty} • ${classInfo.room}</p>
                        <p class="text-blue-600 text-sm">Current: ${day.charAt(0).toUpperCase() + day.slice(1)} ${currentTime}</p>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">New Time Slot:</label>
                        <select id="new-time-slot" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            ${timetableData.timeSlots.map(slot => 
                                `<option value="${slot}" ${slot === currentTime ? 'selected' : ''}>${slot}</option>`
                            ).join('')}
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Day:</label>
                        <select id="new-day" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            ${['monday', 'tuesday', 'wednesday', 'thursday', 'friday'].map(d => 
                                `<option value="${d}" ${d === day ? 'selected' : ''}>${d.charAt(0).toUpperCase() + d.slice(1)}</option>`
                            ).join('')}
                        </select>
                    </div>
                    
                    <div class="flex justify-end space-x-3 pt-4">
                        <button onclick="closeModal()" class="bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 px-4 rounded-md font-medium">
                            Cancel
                        </button>
                        <button onclick="applyTimeSlotChange('${scheduleKey}')" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md font-medium">
                            Apply Changes
                        </button>
                    </div>
                </div>
            `);
        }
        
        function applyTimeSlotChange(originalScheduleKey) {
            const newTimeSlot = document.getElementById('new-time-slot').value;
            const newDay = document.getElementById('new-day').value;
            const newScheduleKey = `${newDay}-${newTimeSlot}`;
            
            // Check if the new slot is available
            if (newScheduleKey !== originalScheduleKey && timetableData.schedule[newScheduleKey]) {
                showToast('❌ Target time slot is already occupied!', 'error');
                return;
            }
            
            // Move the class to the new slot
            const classInfo = timetableData.schedule[originalScheduleKey];
            delete timetableData.schedule[originalScheduleKey];
            timetableData.schedule[newScheduleKey] = classInfo;
            
            // Check for new conflicts
            checkConflicts();
            
            // Update UI
            renderTimetableGrid();
            closeModal();
            
            const [originalDay, originalTime] = originalScheduleKey.split('-');
            showToast(`✅ ${classInfo.course} moved from ${originalDay.charAt(0).toUpperCase() + originalDay.slice(1)} ${originalTime} to ${newDay.charAt(0).toUpperCase() + newDay.slice(1)} ${newTimeSlot}`, 'success');
            
            // Add reasoning log
            timetableData.reasoningLog.push(`🔄 Manual edit: ${classInfo.course} moved from ${originalDay} ${originalTime} to ${newDay} ${newTimeSlot}`);
            
            // Auto-resolve conflicts if any
            if (timetableData.conflicts.length > 0) {
                setTimeout(() => {
                    autoResolveConflicts();
                }, 1000);
            }
        }
        
        function autoResolveConflicts() {
            if (timetableData.conflicts.length === 0) return;
            
            showToast(`🔄 Auto-resolving ${timetableData.conflicts.length} conflicts...`, 'info');
            
            // Simple conflict resolution: try to move conflicting classes to available slots
            const conflictingKeys = [...timetableData.conflicts];
            let resolvedCount = 0;
            
            conflictingKeys.forEach(conflictKey => {
                const classInfo = timetableData.schedule[conflictKey];
                if (!classInfo) return;
                
                // Find an alternative slot
                const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];
                const timeSlots = timetableData.timeSlots;
                
                for (const day of days) {
                    for (const timeSlot of timeSlots) {
                        const alternativeKey = `${day}-${timeSlot}`;
                        
                        if (!timetableData.schedule[alternativeKey] && alternativeKey !== conflictKey) {
                            // Check if faculty is available
                            const faculty = timetableData.faculty.find(f => f.name === classInfo.faculty);
                            if (faculty && isFacultyAvailableForSlot(faculty, day, timeSlot)) {
                                // Move the class
                                delete timetableData.schedule[conflictKey];
                                timetableData.schedule[alternativeKey] = classInfo;
                                resolvedCount++;
                                
                                timetableData.reasoningLog.push(`🔧 Auto-resolved conflict: ${classInfo.course} moved from ${conflictKey} to ${alternativeKey}`);
                                return; // Move to next conflict
                            }
                        }
                    }
                }
            });
            
            // Re-check conflicts
            checkConflicts();
            renderTimetableGrid();
            
            if (resolvedCount > 0) {
                showToast(`✅ Auto-resolved ${resolvedCount} conflicts! ${timetableData.conflicts.length} conflicts remaining.`, 'success');
            } else {
                showToast(`⚠️ Could not auto-resolve conflicts. Manual intervention required.`, 'warning');
            }
        }
        
        function isFacultyAvailable(faculty, day, timeSlot) {
            if (!faculty.availability[day]) return false;
            
            const [startTime] = timeSlot.split('-');
            return faculty.availability[day].some(slot => {
                const [slotStart, slotEnd] = slot.split('-');
                return startTime >= slotStart && startTime < slotEnd;
            });
        }
        
        function assignOptimalRoom(course) {
            // Simple room assignment based on course requirements
            if (course.department === 'Computer Science') {
                return timetableData.rooms.find(r => r.type === 'lab') || timetableData.rooms[0];
            } else if (course.department === 'Chemistry') {
                return timetableData.rooms.find(r => r.id === 'LAB-301') || timetableData.rooms[0];
            } else {
                return timetableData.rooms.find(r => r.type === 'lecture' && r.capacity >= course.students) || timetableData.rooms[0];
            }
        }
        
        // Drag and Drop Functionality
        let draggedElement = null;
        
        function handleDragStart(event) {
            draggedElement = event.target;
            event.dataTransfer.effectAllowed = 'move';
            event.target.style.opacity = '0.5';
        }
        
        function handleDragOver(event) {
            event.preventDefault();
            event.dataTransfer.dropEffect = 'move';
        }
        
        function handleDrop(event) {
            event.preventDefault();
            
            if (draggedElement) {
                const targetKey = event.target.closest('[data-schedule-key]')?.getAttribute('data-schedule-key');
                const sourceKey = draggedElement.getAttribute('data-schedule-key');
                
                if (targetKey && sourceKey && targetKey !== sourceKey) {
                    // Swap or move the schedule items
                    const sourceData = timetableData.schedule[sourceKey];
                    const targetData = timetableData.schedule[targetKey];
                    
                    if (targetData) {
                        // Swap
                        timetableData.schedule[sourceKey] = targetData;
                        timetableData.schedule[targetKey] = sourceData;
                    } else {
                        // Move to empty slot
                        timetableData.schedule[targetKey] = sourceData;
                        delete timetableData.schedule[sourceKey];
                    }
                    
                    // Re-render and check for conflicts
                    renderTimetableGrid();
                    checkConflicts();
                    showToast('Schedule updated! Checking for conflicts...', 'info');
                }
                
                draggedElement.style.opacity = '1';
                draggedElement = null;
            }
        }
        
        function checkConflicts() {
            timetableData.conflicts = [];
            
            // Check for faculty conflicts
            Object.keys(timetableData.schedule).forEach(key1 => {
                Object.keys(timetableData.schedule).forEach(key2 => {
                    if (key1 !== key2) {
                        const class1 = timetableData.schedule[key1];
                        const class2 = timetableData.schedule[key2];
                        
                        if (class1.faculty === class2.faculty && getTimeOverlap(key1, key2)) {
                            if (!timetableData.conflicts.includes(key1)) timetableData.conflicts.push(key1);
                            if (!timetableData.conflicts.includes(key2)) timetableData.conflicts.push(key2);
                        }
                    }
                });
            });
            
            document.getElementById('conflict-count').textContent = timetableData.conflicts.length;
        }
        
        function getTimeOverlap(key1, key2) {
            const [day1, time1] = key1.split('-');
            const [day2, time2] = key2.split('-');
            
            return day1 === day2 && time1 === time2;
        }
        
        // Faculty Availability Management
        function showFacultyAvailability() {
            showModal('Faculty Availability Management', `
                <div class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        ${timetableData.faculty.map(faculty => `
                            <div class="border border-gray-200 rounded-lg p-4">
                                <h3 class="font-semibold text-gray-900 mb-3">${faculty.name}</h3>
                                <div class="space-y-2">
                                    ${Object.entries(faculty.availability).map(([day, slots]) => `
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm font-medium text-gray-700 capitalize">${day}:</span>
                                            <span class="text-sm text-gray-600">${slots.join(', ')}</span>
                                        </div>
                                    `).join('')}
                                </div>
                                <button onclick="editFacultyAvailability('${faculty.id}')" class="mt-3 text-blue-600 hover:text-blue-800 text-sm font-medium">
                                    Edit Availability
                                </button>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `);
        }
        
        function showCourseConstraints() {
            showModal('Course Scheduling Constraints', `
                <div class="space-y-6">
                    <div class="grid grid-cols-1 gap-4">
                        ${timetableData.courses.map(course => `
                            <div class="border border-gray-200 rounded-lg p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="font-semibold text-gray-900">${course.name} (${course.id})</h3>
                                        <p class="text-sm text-gray-600">Faculty: ${course.faculty} | Students: ${course.students}</p>
                                        <p class="text-sm text-gray-600">Duration: ${course.duration} minutes | Credits: ${course.credits}</p>
                                    </div>
                                    <button onclick="editCourseConstraints('${course.id}')" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                                        Edit Constraints
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `);
        }
        
        function exportTimetable() {
            const exportOptions = [
                { format: 'pdf', label: 'PDF Document', icon: 'file-text' },
                { format: 'excel', label: 'Excel Spreadsheet', icon: 'file-spreadsheet' },
                { format: 'print', label: 'Print Preview', icon: 'printer' }
            ];
            
            showModal('Export Timetable', `
                <div class="space-y-4">
                    <p class="text-gray-600">Choose your preferred export format:</p>
                    <div class="grid grid-cols-1 gap-3">
                        ${exportOptions.map(option => `
                            <button onclick="performExport('${option.format}')" class="flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
                                <i data-lucide="${option.icon}" class="h-5 w-5 text-gray-600 mr-3"></i>
                                <span class="font-medium text-gray-900">${option.label}</span>
                            </button>
                        `).join('')}
                    </div>
                </div>
            `);
        }
        
        function performExport(format) {
            closeModal();
            showToast(`Exporting timetable as ${format.toUpperCase()}...`, 'info');
            
            setTimeout(() => {
                showToast(`✅ Timetable exported successfully as ${format.toUpperCase()}!`, 'success');
            }, 2000);
        }
        
        function editFacultyAvailability(facultyId) {
            closeModal();
            showToast('Faculty availability editor would open here', 'info');
        }
        
        function editCourseConstraints(courseId) {
            closeModal();
            showToast('Course constraints editor would open here', 'info');
        }
        
        // Modal Functions
        function showModal(title, content) {
            const modal = document.createElement('div');
            modal.id = 'timetable-modal';
            modal.className = 'fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50';
            modal.innerHTML = `
                <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-bold text-gray-900">${title}</h3>
                        <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600">
                            <i data-lucide="x" class="h-6 w-6"></i>
                        </button>
                    </div>
                    <div class="mt-3">
                        ${content}
                    </div>
                    <div class="flex justify-end mt-6">
                        <button onclick="closeModal()" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md font-medium">
                            Close
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            lucide.createIcons();
            
            // Close on outside click
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeModal();
                }
            });
        }
        
        function closeModal() {
            const modal = document.getElementById('timetable-modal');
            if (modal) {
                modal.remove();
            }
        }
        
        // Student Portal Functions
        function showAdmissionForm() {
            const dashboardContent = document.getElementById('dashboard-content');
            dashboardContent.innerHTML = `
                <div class="px-4 py-6 sm:px-0">
                    <div class="flex justify-between items-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-900">Admission Application</h1>
                        <button onclick="showDashboard(currentRole)" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md font-medium">
                            ← Back to Dashboard
                        </button>
                    </div>
                    
                    <div class="bg-white shadow rounded-lg">
                        <form id="admission-form" class="p-6 space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Full Name *</label>
                                    <input type="text" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Email *</label>
                                    <input type="email" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Phone *</label>
                                    <input type="tel" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Date of Birth *</label>
                                    <input type="date" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Course *</label>
                                    <select required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        <option value="">Select Course</option>
                                        <option value="Computer Science">Computer Science</option>
                                        <option value="Electronics">Electronics</option>
                                        <option value="Mechanical">Mechanical</option>
                                        <option value="Civil">Civil Engineering</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Academic Year *</label>
                                    <select required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        <option value="">Select Year</option>
                                        <option value="2024">2024</option>
                                        <option value="2025">2025</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700">Address *</label>
                                <textarea rows="3" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"></textarea>
                            </div>
                            
                            <div class="flex justify-end space-x-4">
                                <button type="button" onclick="showDashboard(currentRole)" class="bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 px-4 rounded-md font-medium">
                                    Cancel
                                </button>
                                <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md font-medium">
                                    Submit Application
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.getElementById('admission-form').addEventListener('submit', function(e) {
                e.preventDefault();
                const admissionId = 'ADM' + Date.now();
                alert(`✅ Application Submitted Successfully!\\n\\nYour Admission ID: ${admissionId}\\n\\nYou will be notified once your application is reviewed.`);
                showDashboard(currentRole);
            });
            
            lucide.createIcons();
        }
        
        function showFeePayment() {
            const dashboardContent = document.getElementById('dashboard-content');
            dashboardContent.innerHTML = `
                <div class="px-4 py-6 sm:px-0">
                    <div class="flex justify-between items-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-900">Fee Payment</h1>
                        <button onclick="showDashboard(currentRole)" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md font-medium">
                            ← Back to Dashboard
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Fee Details -->
                        <div class="bg-white shadow rounded-lg">
                            <div class="p-6">
                                <h3 class="text-lg font-medium text-gray-900 mb-4">Fee Structure</h3>
                                <div class="space-y-3">
                                    <div class="flex justify-between">
                                        <span>Tuition Fee</span>
                                        <span class="font-medium">₹50,000</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Hostel Fee</span>
                                        <span class="font-medium">₹25,000</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Library Fee</span>
                                        <span class="font-medium">₹5,000</span>
                                    </div>
                                    <hr class="my-2">
                                    <div class="flex justify-between text-lg font-bold">
                                        <span>Total Amount</span>
                                        <span>₹80,000</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Payment Form -->
                        <div class="bg-white shadow rounded-lg">
                            <form id="fee-payment-form" class="p-6 space-y-6">
                                <h3 class="text-lg font-medium text-gray-900">Payment Details</h3>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Admission ID</label>
                                    <input type="text" value="ADM2024001" readonly class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Payment Method</label>
                                    <select required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        <option value="">Select Payment Method</option>
                                        <option value="online">Online Payment (UPI/Card)</option>
                                        <option value="bank">Bank Transfer</option>
                                        <option value="cash">Cash Payment</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Amount</label>
                                    <input type="number" value="80000" readonly class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50">
                                </div>
                                
                                <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white py-3 px-4 rounded-md font-medium">
                                    <i data-lucide="credit-card" class="h-4 w-4 inline mr-2"></i>
                                    Pay Now
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('fee-payment-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const transactionId = 'TXN' + Date.now();
                const amount = document.querySelector('select[name="fee-type"]').value === 'semester' ? 80000 : 
                              document.querySelector('select[name="fee-type"]').value === 'hostel' ? 25000 : 5000;
                const paymentMethod = document.querySelector('select[name="payment-method"]').value;
                
                // Add payment to global tracking system
                const newPayment = {
                    id: transactionId,
                    studentId: currentUser?.email?.includes('student') ? 'ADM2024003' : 'ADM2024001',
                    studentName: currentUser?.email?.includes('student') ? 'Current Student' : 'John Smith',
                    amount: amount,
                    date: new Date().toISOString().split('T')[0],
                    time: new Date().toLocaleTimeString('en-US', { hour12: false, hour: '2-digit', minute: '2-digit' }),
                    method: paymentMethod.charAt(0).toUpperCase() + paymentMethod.slice(1).replace('-', ' '),
                    status: 'Completed',
                    semester: 'Fall 2024'
                };
                
                feePayments.unshift(newPayment); // Add to beginning of array
                
                showToast('Payment processed successfully!', 'success');
                setTimeout(() => {
                    alert(`✅ Payment Successful!\\n\\nTransaction ID: ${transactionId}\\nAmount: ₹${amount.toLocaleString()}\\nMethod: ${newPayment.method}\\nDate: ${newPayment.date} ${newPayment.time}\\n\\n📧 Receipt has been sent to your email.\\n💰 Payment is now visible in Fee Management.`);
                    showDashboard(currentRole);
                }, 500);
            });
            
            lucide.createIcons();
        }
        
        function showExamResults() {
            const dashboardContent = document.getElementById('dashboard-content');
            dashboardContent.innerHTML = `
                <div class="px-4 py-6 sm:px-0">
                    <div class="flex justify-between items-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-900">Examination Results</h1>
                        <button onclick="showDashboard(currentRole)" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md font-medium">
                            ← Back to Dashboard
                        </button>
                    </div>
                    
                    <!-- Overall Performance -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="bg-white overflow-hidden shadow rounded-lg">
                            <div class="p-5 text-center">
                                <div class="text-3xl font-bold text-green-600">8.5</div>
                                <div class="text-sm text-gray-500">Current CGPA</div>
                            </div>
                        </div>
                        <div class="bg-white overflow-hidden shadow rounded-lg">
                            <div class="p-5 text-center">
                                <div class="text-3xl font-bold text-blue-600">A</div>
                                <div class="text-sm text-gray-500">Overall Grade</div>
                            </div>
                        </div>
                        <div class="bg-white overflow-hidden shadow rounded-lg">
                            <div class="p-5 text-center">
                                <div class="text-3xl font-bold text-purple-600">5</div>
                                <div class="text-sm text-gray-500">Subjects Completed</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Results Table -->
                    <div class="bg-white shadow rounded-lg">
                        <div class="px-4 py-5 sm:p-6">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-lg leading-6 font-medium text-gray-900">Semester Results</h3>
                                <button onclick="downloadResults()" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md font-medium text-sm">
                                    <i data-lucide="download" class="h-4 w-4 inline mr-1"></i>
                                    Download PDF
                                </button>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Subject</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Marks</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Grade</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-gray-200">
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Data Structures</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">85/100</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">A</td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Pass</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Digital Electronics</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">78/100</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">B+</td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Pass</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Mathematics</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">92/100</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">A+</td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Pass</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Physics</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">88/100</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">A</td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Pass</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">English</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">75/100</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">B</td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Pass</span>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            lucide.createIcons();
        }
        
        function showHostelAllocation() {
            const dashboardContent = document.getElementById('dashboard-content');
            dashboardContent.innerHTML = `
                <div class="px-4 py-6 sm:px-0">
                    <div class="flex justify-between items-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-900">Hostel Allocation</h1>
                        <button onclick="showDashboard(currentRole)" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md font-medium">
                            ← Back to Dashboard
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Current Allocation -->
                        <div class="bg-white shadow rounded-lg">
                            <div class="p-6">
                                <h3 class="text-lg font-medium text-gray-900 mb-4">Current Allocation</h3>
                                <div class="space-y-4">
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Room Number:</span>
                                        <span class="font-medium">A-101</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Block:</span>
                                        <span class="font-medium">Block A (Boys)</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Room Type:</span>
                                        <span class="font-medium">Single Occupancy</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Floor:</span>
                                        <span class="font-medium">Ground Floor</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Allocated Date:</span>
                                        <span class="font-medium">15 Feb 2024</span>
                                    </div>
                                </div>
                                
                                <div class="mt-6 pt-4 border-t">
                                    <button onclick="requestRoomChange()" class="w-full bg-orange-600 hover:bg-orange-700 text-white py-2 px-4 rounded-md font-medium">
                                        Request Room Change
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Room Facilities -->
                        <div class="bg-white shadow rounded-lg">
                            <div class="p-6">
                                <h3 class="text-lg font-medium text-gray-900 mb-4">Room Facilities</h3>
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="flex items-center space-x-2">
                                        <i data-lucide="wifi" class="h-5 w-5 text-green-600"></i>
                                        <span class="text-sm">WiFi</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <i data-lucide="zap" class="h-5 w-5 text-green-600"></i>
                                        <span class="text-sm">24/7 Power</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <i data-lucide="droplets" class="h-5 w-5 text-green-600"></i>
                                        <span class="text-sm">Hot Water</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <i data-lucide="shield" class="h-5 w-5 text-green-600"></i>
                                        <span class="text-sm">Security</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <i data-lucide="car" class="h-5 w-5 text-green-600"></i>
                                        <span class="text-sm">Parking</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <i data-lucide="utensils" class="h-5 w-5 text-green-600"></i>
                                        <span class="text-sm">Mess</span>
                                    </div>
                                </div>
                                
                                <div class="mt-6">
                                    <h4 class="font-medium text-gray-900 mb-2">Hostel Rules</h4>
                                    <ul class="text-sm text-gray-600 space-y-1">
                                        <li>• No visitors after 9 PM</li>
                                        <li>• Maintain cleanliness</li>
                                        <li>• No loud music/noise</li>
                                        <li>• Report any issues to warden</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            lucide.createIcons();
        }
        
        // Utility Functions
        function markAllRead() {
            alert('✅ All notifications marked as read!');
        }
        
        function downloadResults() {
            showPrintDialog('Student Results Report', generateResultsPDF);
        }
        
        // Print/PDF Generation System
        function showPrintDialog(title, generateFunction) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 fade-in';
            modal.innerHTML = `
                <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 scale-in">
                    <div class="text-center mb-6">
                        <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i data-lucide="printer" class="h-8 w-8 text-blue-600"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-2">${title}</h3>
                        <p class="text-gray-600">Choose your preferred format</p>
                    </div>
                    
                    <div class="space-y-3 mb-6">
                        <button onclick="generatePDF('${title}'); closePrintDialog()" class="w-full flex items-center justify-between p-4 border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-all">
                            <div class="flex items-center space-x-3">
                                <i data-lucide="file-text" class="h-6 w-6 text-red-600"></i>
                                <div class="text-left">
                                    <p class="font-medium text-gray-900">Download PDF</p>
                                    <p class="text-sm text-gray-500">Portable document format</p>
                                </div>
                            </div>
                            <i data-lucide="download" class="h-5 w-5 text-gray-400"></i>
                        </button>
                        
                        <button onclick="generatePrint('${title}'); closePrintDialog()" class="w-full flex items-center justify-between p-4 border-2 border-gray-200 rounded-lg hover:border-green-500 hover:bg-green-50 transition-all">
                            <div class="flex items-center space-x-3">
                                <i data-lucide="printer" class="h-6 w-6 text-green-600"></i>
                                <div class="text-left">
                                    <p class="font-medium text-gray-900">Print Document</p>
                                    <p class="text-sm text-gray-500">Send to printer</p>
                                </div>
                            </div>
                            <i data-lucide="chevron-right" class="h-5 w-5 text-gray-400"></i>
                        </button>
                        
                        <button onclick="generateExcel('${title}'); closePrintDialog()" class="w-full flex items-center justify-between p-4 border-2 border-gray-200 rounded-lg hover:border-purple-500 hover:bg-purple-50 transition-all">
                            <div class="flex items-center space-x-3">
                                <i data-lucide="table" class="h-6 w-6 text-purple-600"></i>
                                <div class="text-left">
                                    <p class="font-medium text-gray-900">Export to Excel</p>
                                    <p class="text-sm text-gray-500">Spreadsheet format</p>
                                </div>
                            </div>
                            <i data-lucide="download" class="h-5 w-5 text-gray-400"></i>
                        </button>
                    </div>
                    
                    <button onclick="closePrintDialog()" class="w-full bg-gray-300 hover:bg-gray-400 text-gray-800 py-3 px-4 rounded-lg font-medium transition-colors">
                        Cancel
                    </button>
                </div>
            `;
            
            document.body.appendChild(modal);
            lucide.createIcons();
            
            // Close on outside click
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closePrintDialog();
                }
            });
        }
        
        function closePrintDialog() {
            const modal = document.querySelector('.fixed.inset-0.bg-black');
            if (modal) {
                modal.remove();
            }
        }
        
        // Fix the print dialog generation functions
        function generatePDF(title) {
            showToast('PDF generated successfully!', 'success');
            setTimeout(() => {
                alert(`📄 PDF Generated!\\n\\nDocument: ${title}.pdf\\nSize: ${Math.floor(Math.random() * 500 + 100)} KB\\nGenerated: ${new Date().toLocaleString()}\\n\\n✅ File has been downloaded to your device.`);
            }, 500);
        }
        
        function generatePrint(title) {
            showToast('Sending to printer...', 'info');
            setTimeout(() => {
                alert(`🖨️ Print Job Sent!\\n\\nDocument: ${title}\\nPrinter: Default Printer\\nPages: ${Math.floor(Math.random() * 10 + 1)}\\nTime: ${new Date().toLocaleString()}\\n\\n✅ Document sent to printer successfully.`);
            }, 1000);
        }
        
        function generateExcel(title) {
            showToast('Excel file generated successfully!', 'success');
            setTimeout(() => {
                alert(`📊 Excel Generated!\\n\\nDocument: ${title}.xlsx\\nSize: ${Math.floor(Math.random() * 200 + 50)} KB\\nGenerated: ${new Date().toLocaleString()}\\n\\n✅ File has been downloaded to your device.`);
            }, 500);
        }
        
        // Student Management Functions
        function deleteStudent(studentId) {
            if (confirm(`Are you sure you want to delete student ${studentId}?\\n\\nThis action cannot be undone.`)) {
                showToast(`Student ${studentId} deleted successfully`, 'success');
                // In real app, would remove from database and refresh list
            }
        }
        
        function viewStudent(studentId) {
            showToast(`Opening profile for student ${studentId}`, 'info');
            // In real app, would show detailed student profile modal
        }
        
        // Search and Filter Functions
        function setupStudentFilters() {
            // Search functionality
            const searchInput = document.getElementById('student-search-input');
            if (searchInput) {
                searchInput.addEventListener('input', function(e) {
                    const searchTerm = e.target.value.toLowerCase();
                    filterStudents(searchTerm);
                });
            }
            
            // Course filter
            const courseFilter = document.getElementById('course-filter');
            if (courseFilter) {
                courseFilter.addEventListener('change', function(e) {
                    const selectedCourse = e.target.value;
                    filterStudentsByCourse(selectedCourse);
                });
            }
            
            // Status filter
            const statusFilter = document.getElementById('status-filter');
            if (statusFilter) {
                statusFilter.addEventListener('change', function(e) {
                    const selectedStatus = e.target.value;
                    filterStudentsByStatus(selectedStatus);
                });
            }
        }
        
        function filterStudents(searchTerm) {
            showToast(`Searching for: "${searchTerm}"`, 'info');
            // In real app, would filter the student list based on search term
        }
        
        function filterStudentsByCourse(course) {
            if (course === 'all') {
                showToast('Showing all courses', 'info');
            } else {
                showToast(`Filtering by course: ${course}`, 'info');
            }
            // In real app, would filter students by selected course
        }
        
        function filterStudentsByStatus(status) {
            if (status === 'all') {
                showToast('Showing all statuses', 'info');
            } else {
                showToast(`Filtering by status: ${status}`, 'info');
            }
            // In real app, would filter students by selected status
        }
        
        // PDF Generation Functions
        function generateResultsPDF(format) {
            if (format === 'pdf') {
                showToast('📄 Generating PDF report...', 'info');
                setTimeout(() => {
                    showToast('✅ Results PDF downloaded successfully!', 'success');
                    // In real app, this would generate actual PDF
                }, 2000);
            } else if (format === 'print') {
                showToast('🖨️ Sending to printer...', 'info');
                setTimeout(() => {
                    showToast('✅ Document sent to printer!', 'success');
                    // In real app, this would open print dialog
                }, 1500);
            } else if (format === 'excel') {
                showToast('📊 Generating Excel file...', 'info');
                setTimeout(() => {
                    showToast('✅ Excel file downloaded successfully!', 'success');
                    // In real app, this would generate Excel file
                }, 2000);
            }
        }
        
        function generateStudentReportPDF(format) {
            if (format === 'pdf') {
                showToast('📄 Generating student report PDF...', 'info');
                setTimeout(() => {
                    showToast('✅ Student report PDF downloaded!', 'success');
                }, 2000);
            } else if (format === 'print') {
                showToast('🖨️ Printing student report...', 'info');
                setTimeout(() => {
                    showToast('✅ Student report sent to printer!', 'success');
                }, 1500);
            } else if (format === 'excel') {
                showToast('📊 Exporting student data to Excel...', 'info');
                setTimeout(() => {
                    showToast('✅ Student data exported to Excel!', 'success');
                }, 2000);
            }
        }
        
        function generateFeeReportPDF(format) {
            if (format === 'pdf') {
                showToast('📄 Generating fee collection report...', 'info');
                setTimeout(() => {
                    showToast('✅ Fee report PDF downloaded!', 'success');
                }, 2000);
            } else if (format === 'print') {
                showToast('🖨️ Printing fee report...', 'info');
                setTimeout(() => {
                    showToast('✅ Fee report sent to printer!', 'success');
                }, 1500);
            } else if (format === 'excel') {
                showToast('📊 Exporting fee data to Excel...', 'info');
                setTimeout(() => {
                    showToast('✅ Fee data exported to Excel!', 'success');
                }, 2000);
            }
        }
        
        function requestRoomChange() {
            showToast('Room Change Request Submitted!\\nYour request has been forwarded to the hostel administration.', 'success');
        }
        
        // Dark Mode Functions
        function toggleDarkMode() {
            const html = document.documentElement;
            const themeIcon = document.getElementById('theme-icon');
            
            if (html.getAttribute('data-theme') === 'dark') {
                html.removeAttribute('data-theme');
                themeIcon.setAttribute('data-lucide', 'moon');
                localStorage.setItem('theme', 'light');
            } else {
                html.setAttribute('data-theme', 'dark');
                themeIcon.setAttribute('data-lucide', 'sun');
                localStorage.setItem('theme', 'dark');
            }
            
            lucide.createIcons();
        }
        
        // Initialize theme on page load
        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme');
            const html = document.documentElement;
            const themeIcon = document.getElementById('theme-icon');
            
            if (savedTheme === 'dark') {
                html.setAttribute('data-theme', 'dark');
                themeIcon.setAttribute('data-lucide', 'sun');
            } else {
                themeIcon.setAttribute('data-lucide', 'moon');
            }
            lucide.createIcons();
        }
        
        // Notification Functions
        function toggleNotifications() {
            const notificationCenter = document.getElementById('notification-center');
            const badge = document.getElementById('notification-badge');
            
            if (notificationCenter.classList.contains('hidden')) {
                notificationCenter.classList.remove('hidden');
                badge.classList.add('hidden');
            } else {
                notificationCenter.classList.add('hidden');
            }
        }
        
        function markAllNotificationsRead() {
            const badge = document.getElementById('notification-badge');
            badge.classList.add('hidden');
            showToast('All notifications marked as read', 'success');
            document.getElementById('notification-center').classList.add('hidden');
        }
        
        // Advanced Toast Notification System
        function showToast(message, type = 'info', duration = 4000) {
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.innerHTML = `
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <i data-lucide="${getToastIcon(type)}" class="h-5 w-5 mr-3"></i>
                        <span>${message}</span>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-white hover:text-gray-200">
                        <i data-lucide="x" class="h-4 w-4"></i>
                    </button>
                </div>
            `;
            
            document.body.appendChild(toast);
            lucide.createIcons();
            
            setTimeout(() => {
                if (toast.parentElement) {
                    toast.remove();
                }
            }, duration);
        }
        
        function getToastIcon(type) {
            const icons = {
                success: 'check-circle',
                error: 'x-circle',
                warning: 'alert-triangle',
                info: 'info'
            };
            return icons[type] || 'info';
        }
        
        // Replace all alert() calls with toast notifications
        function alert(message) {
            if (message.includes('✅')) {
                showToast(message.replace('✅ ', ''), 'success');
            } else if (message.includes('❌')) {
                showToast(message.replace('❌ ', ''), 'error');
            } else {
                showToast(message, 'info');
            }
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeTheme();
            lucide.createIcons();
            
            // Check if user came from landing page with a selected role
            const selectedRole = localStorage.getItem('selectedRole');
            if (selectedRole) {
                // Clear the stored role
                localStorage.removeItem('selectedRole');
                // Auto-login with the selected role
                quickLogin(selectedRole);
            }
            
            // Show notification badge after login
            if (currentUser) {
                document.getElementById('notification-badge').classList.remove('hidden');
            }
            
            // Close notification center when clicking outside
            document.addEventListener('click', function(e) {
                const notificationCenter = document.getElementById('notification-center');
                const notificationButton = e.target.closest('[onclick="toggleNotifications()"]');
                
                if (!notificationCenter.contains(e.target) && !notificationButton) {
                    notificationCenter.classList.add('hidden');
                }
            });
        });
    </script>
</body>
</html>
